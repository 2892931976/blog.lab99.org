<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Docker 问答录 · 大桥下的蜗牛</title><meta name="description" content="无善无恶心之体，有善有恶意之动，知善知恶是良知，为善去恶是格物。"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/jekyll.css"><!--[if lt IE 9]>
<script src="js/html5shiv.min.js"></script>
<script src="js/respond.min.js"></script>
<![endif]--></head><body><header class="row-flex-row limit-width vh-center"><a href="/" class="logo"><img src="/favicon.png"></a><nav><ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-link">主页</a></li><li class="nav-list-item"><a href="/archives/" class="nav-link active">   博客</a></li><li class="nav-list-item"><a href="https://github.com/twang2218" target="_blank" class="nav-link">github</a></li><li class="nav-list-item"><a href="https://coding.net/u/twang2218" target="_blank" class="nav-link">coding</a></li><li class="nav-list-item"><a href="/atom.xml" class="nav-link">rss</a></li></ul></nav></header><div class="container limit-width"><section class="row-flex-row"><div class="post"><article class="post-block"><h2 class="post-title"><a href="/post/docker-2016-07-14-faq.html" class="post-title-link">Docker 问答录</a></h2><div class="post-meta"><ul class="post-tag-list"><li class="post-tag-item"><a href="/tags/docker/" class="post-tag-link">docker</a></li><li class="post-tag-item"><a href="/tags/faq/" class="post-tag-link">faq</a></li></ul><div class="post-time">2016年7月14日 星期四</div></div><div class="post-content"><link rel="stylesheet" href="/style/owl.css"><h1 id="qian-yan"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00; <a href="#qian-yan" class="header-anchor">#</a></h1><blockquote>
<p>&#x8FD9;&#x662F;&#x6211;&#x5728;QQ&#x7FA4; <code>325486037</code> &#x91CC;&#xFF0C;&#x78B0;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#x53CA;&#x5176;&#x89E3;&#x7B54;&#xFF0C;&#x5927;&#x591A;&#x662F;&#x521D;&#x5B66; Docker &#x65F6;&#x5E38;&#x89C1;&#x7684;&#x95EE;&#x9898;&#x3002;&#x5176;&#x4E2D;&#x7684;&#x56DE;&#x7B54;&#xFF0C;&#x662F;&#x57FA;&#x4E8E;&#x6211;&#x5B66;&#x4E60;&#x548C;&#x4F7F;&#x7528;Docker&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x4E00;&#x4E9B;&#x8BA4;&#x77E5;&#xFF0C;&#x591A;&#x6570;&#x662F;&#x9075;&#x5FAA; Docker &#x5B98;&#x65B9;&#x7684;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#x7684;&#x539F;&#x5219;&#x800C;&#x8FDB;&#x884C;&#x7684;&#x89E3;&#x7B54;&#x3002;&#x7531;&#x4E8E;&#x4E2A;&#x4EBA;&#x80FD;&#x529B;&#x6240;&#x9650;&#xFF0C;&#x56DE;&#x7B54;&#x53EF;&#x80FD;&#x4F1A;&#x7247;&#x9762;&#x6216;&#x9519;&#x8BEF;&#x3002;&#x5982;&#x53D1;&#x73B0;&#x9519;&#x8BEF;&#x540E;&#xFF0C;&#x6B22;&#x8FCE;&#x544A;&#x8BC9;&#x6211;&#xFF0C;&#x4EE5;&#x65B9;&#x4FBF;&#x4FEE;&#x6B63;&#x8BE5;&#x6587;&#x6863;&#x907F;&#x514D;&#x8BEF;&#x5BFC;&#x4ED6;&#x4EBA;&#xFF0C;&#x6587;&#x6863;&#x4F1A;&#x4E0D;&#x5B9A;&#x671F;&#x8FDB;&#x884C;&#x66F4;&#x65B0;&#x3002;</p>
</blockquote>
<!-- toc -->
<ul>
<li><a href="#docker-pei-zhi-wen-ti">Docker &#x914D;&#x7F6E;&#x95EE;&#x9898;</a><ul>
<li><a href="#zen-me-xiu-gai-liao-etc-default-docker-hou-bu-qi-zuo-yong">&#x600E;&#x4E48;&#x4FEE;&#x6539;&#x4E86; <code>/etc/default/docker</code> &#x540E;&#x4E0D;&#x8D77;&#x4F5C;&#x7528;&#xFF1F;</a></li>
</ul>
</li>
<li><a href="#docker-shi-yong-wen-ti">Docker &#x4F7F;&#x7528;&#x95EE;&#x9898;</a><ul>
<li><a href="#su-zhu-ru-guo-he-rong-qi-xi-tong-bu-tong-de-hua-na-bu-shi-he-xu-ni-ji-yi-yang-yi-ceng-ceng-de-diao-yong-na-me-docker-he-xu-ni-ji-huan-you-shi-me-chai-bie">&#x5BBF;&#x4E3B;&#x5982;&#x679C;&#x548C;&#x5BB9;&#x5668;&#x7CFB;&#x7EDF;&#x4E0D;&#x540C;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E0D;&#x662F;&#x548C;&#x865A;&#x62DF;&#x673A;&#x4E00;&#x6837;&#xFF0C;&#x4E00;&#x5C42;&#x5C42;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x90A3;&#x4E48;Docker&#x548C;&#x865A;&#x62DF;&#x673A;&#x8FD8;&#x6709;&#x4EC0;&#x4E48;&#x5DEE;&#x522B;&#xFF1F;</a></li>
<li><a href="#ru-he-zai-docker-rong-qi-nei-shi-yong-docker-ming-ling-bi-ru-zai-jenkins-rong-qi-zhong">&#x5982;&#x4F55;&#x5728; Docker  &#x5BB9;&#x5668;&#x5185;&#x4F7F;&#x7528; <code>docker</code> &#x547D;&#x4EE4;(&#x6BD4;&#x5982;&#x5728; Jenkins &#x5BB9;&#x5668;&#x4E2D;)&#xFF1F;</a><ul>
<li><a href="#tian-jia-docker-ming-ling-xing">&#x6DFB;&#x52A0; Docker &#x547D;&#x4EE4;&#x884C;</a></li>
</ul>
</li>
<li><a href="#zen-me-gu-ding-rong-qi-ip-di-zhi-mei-ci-chong-qi-rong-qi-du-yao-bian-hua-ip-di-zhi-zen-me-ban">&#x600E;&#x4E48;&#x56FA;&#x5B9A;&#x5BB9;&#x5668; IP &#x5730;&#x5740;&#xFF1F;&#x6BCF;&#x6B21;&#x91CD;&#x542F;&#x5BB9;&#x5668;&#x90FD;&#x8981;&#x53D8;&#x5316;IP&#x5730;&#x5740;&#x600E;&#x4E48;&#x529E;&#xFF1F;</a></li>
<li><a href="#ru-he-xiu-gai-rong-qi-de-etc-hosts-wen-jian">&#x5982;&#x4F55;&#x4FEE;&#x6539;&#x5BB9;&#x5668;&#x7684; <code>/etc/hosts</code> &#x6587;&#x4EF6;&#xFF1F;</a></li>
<li><a href="#docker-rong-qi-ru-he-sui-xi-tong-yi-tong-qi-dong">Docker &#x5BB9;&#x5668;&#x5982;&#x4F55;&#x968F;&#x7CFB;&#x7EDF;&#x4E00;&#x540C;&#x542F;&#x52A8;&#xFF1F;</a></li>
<li><a href="#zen-me-ying-she-su-zhu-duan-kou-dockerfile-zhong-de-expose-he-docker-run-p-you-sha-qu-bie">&#x600E;&#x4E48;&#x6620;&#x5C04;&#x5BBF;&#x4E3B;&#x7AEF;&#x53E3;&#xFF1F;<code>Dockerfile</code> &#x4E2D;&#x7684;<code>EXPOSE</code>&#x548C; <code>docker run -p</code> &#x6709;&#x5565;&#x533A;&#x522B;&#xFF1F;</a></li>
<li><a href="#wo-yao-ying-she-hao-ji-bai-ge-duan-kou-nan-dao-yao-yi-ge-ge-p-me">&#x6211;&#x8981;&#x6620;&#x5C04;&#x597D;&#x51E0;&#x767E;&#x4E2A;&#x7AEF;&#x53E3;&#xFF0C;&#x96BE;&#x9053;&#x8981;&#x4E00;&#x4E2A;&#x4E2A;<code>-p</code>&#x4E48;&#xFF1F;</a></li>
<li><a href="#vethxxxx-zhe-chong-xu-ni-wang-qia-he-rong-qi-de-dui-ying-guan-xi-cong-na-li-kan"><code>vethxxxx</code> &#x8FD9;&#x79CD;&#x865A;&#x62DF;&#x7F51;&#x5361;&#x548C;&#x5BB9;&#x5668;&#x7684;&#x5BF9;&#x5E94;&#x5173;&#x7CFB;&#x4ECE;&#x54EA;&#x91CC;&#x770B;&#xFF1F;</a></li>
<li><a href="#rong-qi-ci-pan-ke-yi-xian-zhi-pei-e-me">&#x5BB9;&#x5668;&#x78C1;&#x76D8;&#x53EF;&#x4EE5;&#x9650;&#x5236;&#x914D;&#x989D;&#x4E48;&#xFF1F;</a></li>
<li><a href="#docker-stats-xian-shi-de-zhi-you-rong-qi-id-zen-me-cai-neng-xian-shi-rong-qi-ming-zi"><code>docker stats</code> &#x663E;&#x793A;&#x7684;&#x53EA;&#x6709;&#x5BB9;&#x5668;ID&#xFF0C;&#x600E;&#x4E48;&#x624D;&#x80FD;&#x663E;&#x793A;&#x5BB9;&#x5668;&#x540D;&#x5B57;&#xFF1F;</a></li>
<li><a href="#rong-qi-nei-de-shu-ju-gai-bao-cun-zai-jing-xiang-li-huan-shi-wu-li-ji-li">&#x5BB9;&#x5668;&#x5185;&#x7684;&#x6570;&#x636E;&#x8BE5;&#x4FDD;&#x5B58;&#x5728;&#x955C;&#x50CF;&#x91CC;&#x8FD8;&#x662F;&#x7269;&#x7406;&#x673A;&#x91CC;&#xFF1F;</a></li>
<li><a href="#kan-dao-zong-shuo-yao-bao-chi-rong-qi-wu-zhuang-tai-na-shi-me-shi-wu-zhuang-tai">&#x770B;&#x5230;&#x603B;&#x8BF4;&#x8981;&#x4FDD;&#x6301;&#x5BB9;&#x5668;&#x65E0;&#x72B6;&#x6001;&#xFF0C;&#x90A3;&#x4EC0;&#x4E48;&#x662F;&#x65E0;&#x72B6;&#x6001;&#xFF1F;</a><ul>
<li><a href="#rong-qi-cun-chu-ceng-de-wu-zhuang-tai">&#x5BB9;&#x5668;&#x5B58;&#x50A8;&#x5C42;&#x7684;&#x65E0;&#x72B6;&#x6001;</a></li>
<li><a href="#fu-wu-ceng-mian-de-wu-zhuang-tai">&#x670D;&#x52A1;&#x5C42;&#x9762;&#x7684;&#x65E0;&#x72B6;&#x6001;</a></li>
</ul>
</li>
<li><a href="#dockerfile-zhong-de-volume-he-docker-run-v-yi-ji-compose-zhong-de-volumes-du-you-shi-me-qu-bie"><code>Dockerfile</code> &#x4E2D;&#x7684;<code>VOLUME</code>&#x548C;<code>docker run -v</code>&#xFF0C;&#x4EE5;&#x53CA;<code>Compose</code>&#x4E2D;&#x7684;<code>volumes</code>&#x90FD;&#x6709;&#x4EC0;&#x4E48;&#x533A;&#x522B;&#xFF1F;</a></li>
<li><a href="#duo-ge-docker-rong-qi-zhi-jian-gong-xiang-shu-ju-zen-me-ban-nfs">&#x591A;&#x4E2A; Docker &#x5BB9;&#x5668;&#x4E4B;&#x95F4;&#x5171;&#x4EAB;&#x6570;&#x636E;&#x600E;&#x4E48;&#x529E;&#xFF1F;NFS&#xFF1F;</a></li>
<li><a href="#ji-ran-yi-ge-rong-qi-yi-ge-ying-yong-na-me-wo-xiang-zai-gai-rong-qi-zhong-yong-ji-hua-ren-wu-cron-zen-me-ban">&#x65E2;&#x7136;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x60F3;&#x5728;&#x8BE5;&#x5BB9;&#x5668;&#x4E2D;&#x7528;&#x8BA1;&#x5212;&#x4EFB;&#x52A1; cron &#x600E;&#x4E48;&#x529E;&#xFF1F;</a></li>
<li><a href="#docker-pull-xia-lai-de-jing-xiang-wen-jian-du-zai-na"><code>docker pull</code> &#x4E0B;&#x6765;&#x7684;&#x955C;&#x50CF;&#x6587;&#x4EF6;&#x90FD;&#x5728;&#x54EA;&#xFF1F;</a></li>
<li><a href="#docker-images-ming-ling-xian-shi-de-jing-xiang-zhan-liao-hao-da-de-kong-jian-zen-me-ban-mei-ci-du-shi-xia-zai-zhe-me-da-de-jing-xiang"><code>docker images</code> &#x547D;&#x4EE4;&#x663E;&#x793A;&#x7684;&#x955C;&#x50CF;&#x5360;&#x4E86;&#x597D;&#x5927;&#x7684;&#x7A7A;&#x95F4;&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F;&#x6BCF;&#x6B21;&#x90FD;&#x662F;&#x4E0B;&#x8F7D;&#x8FD9;&#x4E48;&#x5927;&#x7684;&#x955C;&#x50CF;&#xFF1F;</a></li>
<li><a href="#docker-images-a-hou-xian-shi-liao-hao-duo-none-de-jing-xiang-du-shi-shi-me-ya-neng-shan-me"><code>docker images -a</code> &#x540E;&#x663E;&#x793A;&#x4E86;&#x597D;&#x591A; <code>&lt;none&gt;</code> &#x7684;&#x955C;&#x50CF;&#xFF1F;&#x90FD;&#x662F;&#x4EC0;&#x4E48;&#x5440;&#xFF1F;&#x80FD;&#x5220;&#x4E48;&#xFF1F;</a><ul>
<li><a href="#yi-lai-jing-xiang">&#x4F9D;&#x8D56;&#x955C;&#x50CF;</a></li>
<li><a href="#diu-liao-biao-qian-de-jing-xiang">&#x4E22;&#x4E86;&#x6807;&#x7B7E;&#x7684;&#x955C;&#x50CF;</a></li>
</ul>
</li>
<li><a href="#wei-shi-me-docker-hub-de-jing-xiang-chi-cun-he-docker-images-bu-yi-zhi">&#x4E3A;&#x4EC0;&#x4E48; Docker Hub &#x7684;&#x955C;&#x50CF;&#x5C3A;&#x5BF8;&#x548C; <code>docker images</code> &#x4E0D;&#x4E00;&#x81F4;&#xFF1F;</a></li>
<li><a href="#docker-ri-zhi-du-zai-na-li-zen-me-shou-ji">Docker &#x65E5;&#x5FD7;&#x90FD;&#x5728;&#x54EA;&#x91CC;&#xFF1F;&#x600E;&#x4E48;&#x6536;&#x96C6;&#xFF1F;</a></li>
<li><a href="#wo-yong-de-shi-a-li-yun-ubuntu-14-04-zhu-ji-nei-he-huan-shi-3-13-zen-me-ban">&#x6211;&#x7528;&#x7684;&#x662F;&#x963F;&#x91CC;&#x4E91; <code>Ubuntu 14.04</code> &#x4E3B;&#x673A;&#xFF0C;&#x5185;&#x6838;&#x8FD8;&#x662F;<code>3.13</code>&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F;</a></li>
<li><a href="#ru-he-dong-tai-xiu-gai-nei-cun-xian-zhi">&#x5982;&#x4F55;&#x52A8;&#x6001;&#x4FEE;&#x6539;&#x5185;&#x5B58;&#x9650;&#x5236;&#xFF1F;</a></li>
<li><a href="#jing-chang-zai-ge-chong-docker-ming-ling-li-kan-dao-label-label-shi-shi-me-gan-shi-me-yong-de">&#x7ECF;&#x5E38;&#x5728;&#x5404;&#x79CD; <code>Docker</code> &#x547D;&#x4EE4;&#x91CC;&#x770B;&#x5230; <code>--label</code>&#xFF0C;<code>label</code> &#x662F;&#x4EC0;&#x4E48;&#xFF1F;&#x5E72;&#x4EC0;&#x4E48;&#x7528;&#x7684;&#xFF1F;</a><ul>
<li><a href="#tian-jia-label-yi-ji-guo-lu">&#x6DFB;&#x52A0;<code>label</code>&#x4EE5;&#x53CA;&#x8FC7;&#x6EE4;</a></li>
<li><a href="#ji-qun-diao-du-yue-shu">&#x96C6;&#x7FA4;&#x8C03;&#x5EA6;&#x7EA6;&#x675F;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#dockerfile-xiang-guan-wen-ti"><code>Dockerfile</code> &#x76F8;&#x5173;&#x95EE;&#x9898;</a><ul>
<li><a href="#docker-commit-zen-me-yong-a"><code>docker commit</code> &#x600E;&#x4E48;&#x7528;&#x554A;&#xFF1F;</a></li>
<li><a href="#dockerfile-zen-me-xie"><code>Dockerfile</code> &#x600E;&#x4E48;&#x5199;&#xFF1F;</a></li>
<li><a href="#dockerfile-jiu-shi-shell-jiao-ben-ba-na-wo-dong-yi-xing-xing-ba-xu-yao-zhuang-de-dong-xi-du-xie-jin-qu-bu-jiu-xing-liao"><code>Dockerfile</code> &#x5C31;&#x662F; shell &#x811A;&#x672C;&#x5427;&#xFF1F;&#x90A3;&#x6211;&#x61C2;&#xFF0C;&#x4E00;&#x884C;&#x884C;&#x628A;&#x9700;&#x8981;&#x88C5;&#x7684;&#x4E1C;&#x897F;&#x90FD;&#x5199;&#x8FDB;&#x53BB;&#x4E0D;&#x5C31;&#x884C;&#x4E86;&#x3002;</a></li>
<li><a href="#context-dao-di-shi-yi-ge-shi-me-gai-nian"><code>context</code> &#x5230;&#x5E95;&#x662F;&#x4E00;&#x4E2A;&#x4EC0;&#x4E48;&#x6982;&#x5FF5;&#xFF1F;</a></li>
<li><a href="#entrypoint-he-cmd-dao-di-you-shi-me-bu-tong"><code>ENTRYPOINT</code> &#x548C; <code>CMD</code> &#x5230;&#x5E95;&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x540C;&#xFF1F;</a></li>
<li><a href="#na-dao-yi-ge-jing-xiang-ru-he-huo-de-jing-xiang-de-dockerfile">&#x62FF;&#x5230;&#x4E00;&#x4E2A;&#x955C;&#x50CF;&#xFF0C;&#x5982;&#x4F55;&#x83B7;&#x5F97;&#x955C;&#x50CF;&#x7684; <code>Dockerfile</code> &#xFF1F;</a></li>
<li><a href="#zai-ni-de-lnmp-de-li-zi-zhong-php-de-dockerfile-li-mian-de-gou-jian-yi-lai-he-yun-xing-yi-lai-du-shi-shi-me-yi-si">&#x5728;&#x4F60;&#x7684; LNMP &#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;PHP &#x7684; <code>Dockerfile</code> &#x91CC;&#x9762;&#x7684; &#x201C;&#x6784;&#x5EFA;&#x4F9D;&#x8D56;&#x201D; &#x548C; &#x201C;&#x8FD0;&#x884C;&#x4F9D;&#x8D56;&#x201D; &#x90FD;&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#xFF1F;</a></li>
<li><a href="#ying-yong-dai-ma-shi-ying-gai-gua-zai-su-zhu-mu-lu-huan-shi-fang-ru-jing-xiang-nei">&#x5E94;&#x7528;&#x4EE3;&#x7801;&#x662F;&#x5E94;&#x8BE5;&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;&#x8FD8;&#x662F;&#x653E;&#x5165;&#x955C;&#x50CF;&#x5185;&#xFF1F;</a></li>
</ul>
</li>
<li><a href="#docker-compose-xiang-guan-wen-ti">Docker Compose &#x76F8;&#x5173;&#x95EE;&#x9898;</a><ul>
<li><a href="#ni-na-ge-lnmp-li-zi-zhong-de-docker-compose-yml-zhong-you-hao-duo-networks-du-shi-shi-me-yi-si-a">&#x4F60;&#x90A3;&#x4E2A;<code>LNMP</code>&#x4F8B;&#x5B50;&#x4E2D;&#x7684; <code>docker-compose.yml</code> &#x4E2D;&#x6709;&#x597D;&#x591A; <code>networks</code>&#xFF0C;&#x90FD;&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#x554A;&#xFF1F;</a></li>
<li><a href="#shi-yong-compose-de-shi-hou-peng-dao-an-http-request-took-too-long-to-complete-cuo-wu-zen-me-ban">&#x4F7F;&#x7528; Compose &#x7684;&#x65F6;&#x5019;&#x78B0;&#x5230; &#x201C;An HTTP request took too long to complete&#x2026;.&#x201D; &#x9519;&#x8BEF;&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F;</a></li>
</ul>
</li>
<li><a href="#docker-swarm-xiang-guan-wen-ti">Docker Swarm &#x76F8;&#x5173;&#x95EE;&#x9898;</a><ul>
<li><a href="#docker-duo-su-zhu-wang-luo-zen-me-pei-zhi">Docker &#x591A;&#x5BBF;&#x4E3B;&#x7F51;&#x7EDC;&#x600E;&#x4E48;&#x914D;&#x7F6E;&#xFF1F;</a></li>
<li><a href="#swarm-huan-jing-zhong-zen-me-zhi-ding-mou-ge-rong-qi-zai-zhi-ding-de-su-zhu-shang-yun-xing-ni">Swarm&#x73AF;&#x5883;&#x4E2D;&#x600E;&#x4E48;&#x6307;&#x5B9A;&#x67D0;&#x4E2A;&#x5BB9;&#x5668;&#x5728;&#x6307;&#x5B9A;&#x7684;&#x5BBF;&#x4E3B;&#x4E0A;&#x8FD0;&#x884C;&#x5462;&#xFF1F;</a></li>
<li><a href="#wei-shi-me-swarm-ji-qun-de-overlay-network-kua-su-zhu-wu-fa-hu-fang">&#x4E3A;&#x4EC0;&#x4E48; Swarm &#x96C6;&#x7FA4;&#x7684; overlay network &#x8DE8;&#x5BBF;&#x4E3B;&#x65E0;&#x6CD5;&#x4E92;&#x8BBF;&#xFF1F;</a></li>
<li><a href="#docker-er-dai-swarm-ji-swarm-mode-docker-service-create-bu-ke-yi-shi-yong-v-na-zen-me-shi-yong-juan-volume">Docker &#x4E8C;&#x4EE3;Swarm (&#x65E2; Swarm Mode)&#xFF0C;<code>docker service create</code> &#x4E0D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>-v</code> &#x90A3;&#x600E;&#x4E48;&#x4F7F;&#x7528;&#x5377;(Volume)&#xFF1F;</a></li>
<li><a href="#dui-yu-liang-jie-dian-ji-qun-lai-shuo-replicas-2-he-mode-global-shi-bu-shi-yi-ge-yi-si">&#x5BF9;&#x4E8E;&#x4E24;&#x8282;&#x70B9;&#x96C6;&#x7FA4;&#x6765;&#x8BF4;&#xFF0C;<code>--replicas=2</code> &#x548C; <code>--mode=global</code> &#x662F;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x610F;&#x601D;&#xFF1F;</a></li>
</ul>
</li>
<li><a href="#docker-machine-xiang-guan-wen-ti">Docker Machine &#x76F8;&#x5173;&#x95EE;&#x9898;</a><ul>
<li><a href="#ru-he-zai-docker-toolbox-zhong-chuang-jian-de-default-xu-ni-ji-zhong-tian-jia-docker-opts-zhi-lei-de-pei-zhi">&#x5982;&#x4F55;&#x5728; Docker Toolbox &#x4E2D;&#x521B;&#x5EFA;&#x7684; <code>default</code> &#x865A;&#x62DF;&#x673A;&#x4E2D;&#x6DFB;&#x52A0;<code>DOCKER_OPTS</code>&#x4E4B;&#x7C7B;&#x7684;&#x914D;&#x7F6E;&#xFF1F;</a></li>
<li><a href="#docker-machine-chuang-jian-de-zhu-ji-zen-me-zhi-jie-ssh-jin-qu-gai-liao-root-mi-ma-hao-xiang-ye-mei-yong"><code>docker-machine</code> &#x521B;&#x5EFA;&#x7684;&#x4E3B;&#x673A;&#x600E;&#x4E48;&#x76F4;&#x63A5; <code>ssh</code> &#x8FDB;&#x53BB;&#xFF1F;&#x6539;&#x4E86; <code>root</code> &#x5BC6;&#x7801;&#x597D;&#x50CF;&#x4E5F;&#x6CA1;&#x7528;&#xFF1F;</a></li>
<li><a href="#docker-machine-shi-yong-d-generic-shi-zhi-ding-yong-hu-generic-ssh-user-hou-fa-xian-yao-sudo-mi-ma-jie-guo-bao-cuo-tui-chu-zhe-shi-zen-me-hui-shi"><code>docker-machine</code> &#x4F7F;&#x7528; <code>-d generic</code> &#x65F6;&#xFF0C;&#x6307;&#x5B9A;&#x7528;&#x6237; <code>--generic-ssh-user</code> &#x540E;&#x53D1;&#x73B0;&#x8981; <code>sudo</code> &#x5BC6;&#x7801;&#xFF0C;&#x7ED3;&#x679C;&#x62A5;&#x9519;&#x9000;&#x51FA;&#xFF0C;&#x8FD9;&#x662F;&#x600E;&#x4E48;&#x56DE;&#x4E8B;&#xFF1F;</a></li>
</ul>
</li>
<li><a href="#docker-registry-xiang-guan-wen-ti">Docker Registry &#x76F8;&#x5173;&#x95EE;&#x9898;</a><ul>
<li><a href="#wo-docker-push-de-shi-hou-zen-me-bao-authentication-required-cuo-wu">&#x6211; <code>docker push</code> &#x7684;&#x65F6;&#x5019;&#x600E;&#x4E48;&#x62A5; <code>authentication required</code> &#x9519;&#x8BEF;&#xFF1F;</a></li>
<li><a href="#wo-zhu-ce-yong-hu-aaa-liao-zen-me-huan-shi-wu-fa-docker-push-bbb-xxx-a">&#x6211;&#x6CE8;&#x518C;&#x7528;&#x6237; <code>aaa</code> &#x4E86;&#xFF0C;&#x600E;&#x4E48;&#x8FD8;&#x662F;&#x65E0;&#x6CD5; <code>docker push bbb/xxx</code> &#x554A;&#xFF1F;</a></li>
<li><a href="#bu-guan-yong-a-wo-zhe-hui-docker-push-aaa-xxx-liao-zen-me-gao-su-wo-bu-cun-zai-a">&#x4E0D;&#x7BA1;&#x7528;&#x554A;&#xFF0C;&#x6211;&#x8FD9;&#x56DE; <code>docker push aaa/xxx</code> &#x4E86;&#xFF0C;&#x600E;&#x4E48;&#x544A;&#x8BC9;&#x6211;&#x4E0D;&#x5B58;&#x5728;&#x554A;&#xFF1F;</a></li>
<li><a href="#docker-push-dao-si-you-registry-zong-shi-bu-cheng-gong-zen-me-ban"><code>docker push</code> &#x5230;&#x79C1;&#x6709; registry &#x603B;&#x662F;&#x4E0D;&#x6210;&#x529F;&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F;</a></li>
<li><a href="#wo-docker-push-liao-hen-duo-jing-xiang-dao-si-you-de-registry-shang-zen-me-cai-neng-cha-kan-shang-mian-du-you-sha-huo-zhe-sou-suo">&#x6211; <code>docker push</code> &#x4E86;&#x5F88;&#x591A;&#x955C;&#x50CF;&#x5230;&#x79C1;&#x6709;&#x7684; registry &#x4E0A;&#xFF0C;&#x600E;&#x4E48;&#x624D;&#x80FD;&#x67E5;&#x770B;&#x4E0A;&#x9762;&#x90FD;&#x6709;&#x5565;&#xFF1F;&#x6216;&#x8005;&#x641C;&#x7D22;&#xFF1F;</a></li>
<li><a href="#ru-he-shan-chu-si-you-registry-zhong-de-jing-xiang">&#x5982;&#x4F55;&#x5220;&#x9664;&#x79C1;&#x6709; registry &#x4E2D;&#x7684;&#x955C;&#x50CF;&#xFF1F;</a></li>
<li><a href="#shi-yong-guo-nei-jing-xiang-huan-shi-man-gong-si-nei-hao-duo-docker-zhu-ji-du-xu-yao-qu-chong-fu-xia-zai-jing-xiang-zha-ban">&#x4F7F;&#x7528;&#x56FD;&#x5185;&#x955C;&#x50CF;&#x8FD8;&#x662F;&#x6162;&#xFF0C;&#x516C;&#x53F8;&#x5185;&#x597D;&#x591A; docker &#x4E3B;&#x673A;&#xFF0C;&#x90FD;&#x9700;&#x8981;&#x53BB;&#x91CD;&#x590D;&#x4E0B;&#x8F7D;&#x955C;&#x50CF;&#xFF0C;&#x548B;&#x529E;&#xFF1F;</a></li>
<li><a href="#zi-ji-jia-de-registry-zen-me-ren-he-yong-hu-du-ke-yi-qu-dao-jing-xiang-zhe-bu-an-quan-a">&#x81EA;&#x5DF1;&#x67B6;&#x7684; <code>registry</code> &#x600E;&#x4E48;&#x4EFB;&#x4F55;&#x7528;&#x6237;&#x90FD;&#x53EF;&#x4EE5;&#x53D6;&#x5230;&#x955C;&#x50CF;&#xFF1F;&#x8FD9;&#x4E0D;&#x5B89;&#x5168;&#x554A;&#xFF1F;</a></li>
</ul>
</li>
<li><a href="#centos-rhel-hong-mao-xi-tong-te-you-wen-ti">CentOS/RHEL &#x7EA2;&#x5E3D;&#x7CFB;&#x7EDF;&#x7279;&#x6709;&#x95EE;&#x9898;</a><ul>
<li><a href="#zai-centos-6-shang-an-zhuang-hou-zen-me-zui-gao-zhi-you-docker-1-7-zhe-ge-ban-ben">&#x5728; CentOS 6 &#x4E0A;&#x5B89;&#x88C5;&#x540E;&#x600E;&#x4E48;&#x6700;&#x9AD8;&#x53EA;&#x6709; Docker 1.7 &#x8FD9;&#x4E2A;&#x7248;&#x672C;&#xFF1F;</a></li>
<li><a href="#gua-zai-su-zhu-mu-lu-jie-guo-permission-denied-mei-quan-xian">&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;&#xFF0C;&#x7ED3;&#x679C; Permission denied&#xFF0C;&#x6CA1;&#x6743;&#x9650;</a></li>
<li><a href="#docker-de-var-lib-docker-devicemapper-zhan-yong-kong-jian-bu-duan-zeng-chang-zen-me-po">Docker&#x7684; <code>/var/lib/docker/devicemapper</code> &#x5360;&#x7528;&#x7A7A;&#x95F4;&#x4E0D;&#x65AD;&#x589E;&#x957F;, &#x600E;&#x4E48;&#x7834;&#xFF1F;</a></li>
<li><a href="#centos-7-de-nei-he-tai-lao-liao-3-10-shi-bu-shi-hen-duo-docker-gong-neng-bu-zhi-chi">CentOS 7 &#x7684;&#x5185;&#x6838;&#x592A;&#x8001;&#x4E86; 3.10&#xFF0C;&#x662F;&#x4E0D;&#x662F;&#x5F88;&#x591A;Docker&#x529F;&#x80FD;&#x4E0D;&#x652F;&#x6301;&#xFF1F;</a></li>
<li><a href="#centos-7-rhel-7-sheng-ji-1-12-hou-wu-fa-qi-dong-bao-cuo-unit-docker-socket-failed-to-load-no-such-file-or-directory">CentOS 7/RHEL 7 &#x5347;&#x7EA7; 1.12 &#x540E;&#xFF0C;&#x65E0;&#x6CD5;&#x542F;&#x52A8;&#xFF0C;&#x62A5;&#x9519; <code>Unit docker.socket failed to load: No such file or directory.</code></a></li>
</ul>
</li>
<li><a href="#mac-windows-xiang-guan-wen-ti">Mac / Windows &#x76F8;&#x5173;&#x95EE;&#x9898;</a><ul>
<li><a href="#wei-shi-me-zai-mac-xia-gua-zai-su-zhu-mu-lu-usr-local-nginx-bu-cheng-gong">&#x4E3A;&#x4EC0;&#x4E48;&#x5728;<code>Mac</code>&#x4E0B;&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;<code>/usr/local/nginx</code>&#x4E0D;&#x6210;&#x529F;&#xFF1F;</a></li>
</ul>
</li>
<li><a href="#wei-da-de-qiang-xiang-guan-wen-ti">&#x4F1F;&#x5927;&#x7684;&#x5899;&#x76F8;&#x5173;&#x95EE;&#x9898;</a><ul>
<li><a href="#docker-toolbox-compose-machine-zong-shi-xia-zai-bu-lai-zen-me-ban">Docker Toolbox/Compose/Machine &#x603B;&#x662F;&#x4E0B;&#x8F7D;&#x4E0D;&#x6765;&#x600E;&#x4E48;&#x529E;&#xFF1F;</a></li>
<li><a href="#shi-zhi-jie-yong-yum-apt-get-an-zhuang-docker-ma">&#x662F;&#x76F4;&#x63A5;&#x7528; yum / apt-get &#x5B89;&#x88C5; Docker &#x5417;&#xFF1F;</a></li>
<li><a href="#docker-pull-hao-man-a-zen-me-ban">docker pull &#x597D;&#x6162;&#x554A;&#x600E;&#x4E48;&#x529E;&#xFF1F;</a><ul>
<li><a href="#ubuntu-14-04-pei-zhi">Ubuntu 14.04 &#x914D;&#x7F6E;</a></li>
<li><a href="#ubuntu-16-04-pei-zhi">Ubuntu 16.04 &#x914D;&#x7F6E;</a></li>
</ul>
</li>
<li><a href="#zhuang-wan-docker-toolbox-hou-fa-xian-xia-zai-jing-xiang-su-du-tai-man-shi-bu-shi-xu-yao-xiu-gai-shi-me-pei-zhi-wen-jian">&#x88C5;&#x5B8C; Docker Toolbox &#x540E;&#x53D1;&#x73B0;&#x4E0B;&#x8F7D;&#x955C;&#x50CF;&#x901F;&#x5EA6;&#x592A;&#x6162;&#xFF0C;&#x662F;&#x4E0D;&#x662F;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x4EC0;&#x4E48;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF1F;</a></li>
</ul>
</li>
<li><a href="#qi-ta-wen-ti">&#x5176;&#x5B83;&#x95EE;&#x9898;</a><ul>
<li><a href="#docker-zi-liao-hao-shao-a-wang-shang-de-ming-ling-zen-me-bu-neng-yong">Docker &#x8D44;&#x6599;&#x597D;&#x5C11;&#x554A;&#xFF1F;&#x7F51;&#x4E0A;&#x7684;&#x547D;&#x4EE4;&#x600E;&#x4E48;&#x4E0D;&#x80FD;&#x7528;&#xFF1F;</a></li>
<li><a href="#docker-1-8-yi-hou-ban-ben-du-you-shi-me-gai-jin-me">Docker 1.8&#x4EE5;&#x540E;&#x7248;&#x672C;&#x90FD;&#x6709;&#x4EC0;&#x4E48;&#x6539;&#x8FDB;&#x4E48;&#xFF1F;</a></li>
<li><a href="#kubernetes-zhe-ci-zha-nian-a">Kubernetes &#x8FD9;&#x8BCD;&#x548B;&#x5FF5;&#x554A;&#xFF1F;</a></li>
<li><a href="#wen-yi-ju-kubernetes-wei-sha-jiao-k8s">&#x95EE;&#x4E00;&#x53E5; Kubernetes &#x4E3A;&#x5565;&#x53EB; &#x201C;k8s&#x201D;&#xFF1F;</a></li>
<li><a href="#wo-de-pei-zhi-wen-jian-chuan-qun-wen-jian-liao-bang-mang-kan-kan-zhe-shi-wo-de-pei-zhi-sheng-lue-ji-qian-zi">&#x6211;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4F20;&#x7FA4;&#x6587;&#x4EF6;&#x4E86;&#xFF0C;&#x5E2E;&#x5FD9;&#x770B;&#x770B;&#xFF1F;&#x8FD9;&#x662F;&#x6211;&#x7684;&#x914D;&#x7F6E;&#x2026;(&#x7701;&#x7565;&#x51E0;&#x5343;&#x5B57;)</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<h1 id="docker-pei-zhi-wen-ti"><a href="#Docker-&#x914D;&#x7F6E;&#x95EE;&#x9898;" class="headerlink" title="Docker &#x914D;&#x7F6E;&#x95EE;&#x9898;"></a>Docker &#x914D;&#x7F6E;&#x95EE;&#x9898; <a href="#docker-pei-zhi-wen-ti" class="header-anchor">#</a></h1><h2 id="zen-me-xiu-gai-liao-etc-default-docker-hou-bu-qi-zuo-yong"><a href="#&#x600E;&#x4E48;&#x4FEE;&#x6539;&#x4E86;-etc-default-docker-&#x540E;&#x4E0D;&#x8D77;&#x4F5C;&#x7528;&#xFF1F;" class="headerlink" title="&#x600E;&#x4E48;&#x4FEE;&#x6539;&#x4E86; /etc/default/docker &#x540E;&#x4E0D;&#x8D77;&#x4F5C;&#x7528;&#xFF1F;"></a>&#x600E;&#x4E48;&#x4FEE;&#x6539;&#x4E86; <code>/etc/default/docker</code> &#x540E;&#x4E0D;&#x8D77;&#x4F5C;&#x7528;&#xFF1F; <a href="#zen-me-xiu-gai-liao-etc-default-docker-hou-bu-qi-zuo-yong" class="header-anchor">#</a></h2><p>&#x6539;&#x52A8;&#x771F;&#x7684;&#x751F;&#x6548;&#x4E86;&#x4E48;&#xFF1F;&#x5728;&#x5BBF;&#x4E3B;&#x4E0A;&#x8FD0;&#x884C;&#x4E00;&#x4E0B; <code>ps -ef | grep docker</code> &#x770B;&#x770B;&#xFF0C;&#x81EA;&#x5DF1;&#x505A;&#x7684;&#x90A3;&#x4E9B;&#x914D;&#x7F6E;&#x6709;&#x4E48;&#xFF1F;&#x6CA1;&#x6709;&#x7684;&#x8BDD;&#x5C31;&#x8BF4;&#x660E;&#x6CA1;&#x6709;&#x751F;&#x6548;&#x3002;&#x90A3;&#x4E48;&#x5C31;&#x8981;&#x68C0;&#x67E5;&#x539F;&#x56E0;&#x4E86;&#xFF0C;&#x9664;&#x4E86;&#x7B80;&#x5355;&#x7684;&#x5FD8;&#x8BB0;&#x4E86;&#x91CD;&#x542F; Docker &#x670D;&#x52A1;&#x5916;&#xFF0C;&#x8FD8;&#x6709;&#x53EF;&#x80FD;&#x4FEE;&#x6539;&#x9519;&#x4E86;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x6700;&#x8FD1;&#x4E24;&#x5E74;&#x5904;&#x4E8E; Upstart/SysinitV &#x5230; systemd &#x7684;&#x8FC7;&#x6E21;&#x671F;&#xFF0C;&#x6240;&#x4EE5;&#x914D;&#x7F6E;&#x670D;&#x52A1;&#x7684;&#x65B9;&#x5F0F;&#x5BF9;&#x4E8E;&#x4E0D;&#x540C;&#x7684;&#x7CFB;&#x7EDF;&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x8981;&#x770B;&#x81EA;&#x5DF1;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x4EC0;&#x4E48;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#xFF0C;&#x4EE5;&#x53CA;&#x4EC0;&#x4E48;&#x7248;&#x672C;&#x3002;</p>
<p>&#x5BF9;&#x4E8E; Upstart &#x7684;&#x7CFB;&#x7EDF;&#xFF08;Ubuntu 14.10&#x6216;&#x4EE5;&#x524D;&#x7684;&#x7248;&#x672C;&#xFF0C;Debian 7&#x6216;&#x4EE5;&#x524D;&#x7684;&#x7248;&#x672C;&#xFF09;&#xFF0C;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x53EF;&#x80FD;&#x5728;</p>
<ul>
<li>Ubuntu/Debian: <code>/etc/default/docker</code></li>
</ul>
<p>&#x800C;&#x5BF9;&#x4E8E; systemd &#x7684;&#x7CFB;&#x7EDF;(Ubuntu 15.04&#x53CA;&#x4EE5;&#x540E;&#x7684;&#x7248;&#x672C;&#xFF0C;Debian 8&#x53CA;&#x4EE5;&#x540E;&#x7684;&#x7248;&#x672C;&#xFF0C;CentOS/RHEL 7)&#xFF0C;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5219;&#x4E00;&#x822C;&#x5728; <code>/etc/systemd/system/</code> &#x4E0B;&#x7684; <code>docker.service</code> &#x4E2D;&#x3002;&#x5982;&#x679C;&#x5DF2;&#x7ECF;&#x7528;&#x547D;&#x4EE4; <code>systemctl enable docker</code> &#x542F;&#x7528;&#x4E86; Docker &#x670D;&#x52A1;&#xFF0C;&#x90A3;&#x4E48;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5E94;&#x8BE5;&#x5728;&#xFF1A;</p>
<ul>
<li><code>/etc/systemd/system/multi-user.target.wants/docker.service</code></li>
</ul>
<p>&#x5177;&#x4F53;&#x4F4D;&#x7F6E;&#x4E0D;&#x540C;&#x7CFB;&#x7EDF;&#x4E0D;&#x540C;&#xFF0C;&#x800C;&#x4E14;&#x8981;&#x6CE8;&#x610F; Upstart &#x7684;&#x670D;&#x52A1;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x548C; systemd &#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x7684;&#x683C;&#x5F0F;&#x4E5F;&#x4E0D;&#x540C;&#xFF0C;&#x4E0D;&#x8981;&#x6DF7;&#x6DC6;&#x4E71;&#x914D;&#xFF1A;</p>
<p>&#x53C2;&#x8003;&#x5B98;&#x7F51;&#x6587;&#x6863;&#xFF1A;<br><a href="https://docs.docker.com/engine/admin/configuring/#ubuntu" target="_blank" rel="external">https://docs.docker.com/engine/admin/configuring/#ubuntu</a><br><a href="https://docs.docker.com/engine/admin/systemd/" target="_blank" rel="external">https://docs.docker.com/engine/admin/systemd/</a></p>
<h1 id="docker-shi-yong-wen-ti"><a href="#Docker-&#x4F7F;&#x7528;&#x95EE;&#x9898;" class="headerlink" title="Docker &#x4F7F;&#x7528;&#x95EE;&#x9898;"></a>Docker &#x4F7F;&#x7528;&#x95EE;&#x9898; <a href="#docker-shi-yong-wen-ti" class="header-anchor">#</a></h1><h2 id="su-zhu-ru-guo-he-rong-qi-xi-tong-bu-tong-de-hua-na-bu-shi-he-xu-ni-ji-yi-yang-yi-ceng-ceng-de-diao-yong-na-me-docker-he-xu-ni-ji-huan-you-shi-me-chai-bie"><a href="#&#x5BBF;&#x4E3B;&#x5982;&#x679C;&#x548C;&#x5BB9;&#x5668;&#x7CFB;&#x7EDF;&#x4E0D;&#x540C;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E0D;&#x662F;&#x548C;&#x865A;&#x62DF;&#x673A;&#x4E00;&#x6837;&#xFF0C;&#x4E00;&#x5C42;&#x5C42;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x90A3;&#x4E48;Docker&#x548C;&#x865A;&#x62DF;&#x673A;&#x8FD8;&#x6709;&#x4EC0;&#x4E48;&#x5DEE;&#x522B;&#xFF1F;" class="headerlink" title="&#x5BBF;&#x4E3B;&#x5982;&#x679C;&#x548C;&#x5BB9;&#x5668;&#x7CFB;&#x7EDF;&#x4E0D;&#x540C;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E0D;&#x662F;&#x548C;&#x865A;&#x62DF;&#x673A;&#x4E00;&#x6837;&#xFF0C;&#x4E00;&#x5C42;&#x5C42;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x90A3;&#x4E48;Docker&#x548C;&#x865A;&#x62DF;&#x673A;&#x8FD8;&#x6709;&#x4EC0;&#x4E48;&#x5DEE;&#x522B;&#xFF1F;"></a>&#x5BBF;&#x4E3B;&#x5982;&#x679C;&#x548C;&#x5BB9;&#x5668;&#x7CFB;&#x7EDF;&#x4E0D;&#x540C;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E0D;&#x662F;&#x548C;&#x865A;&#x62DF;&#x673A;&#x4E00;&#x6837;&#xFF0C;&#x4E00;&#x5C42;&#x5C42;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x90A3;&#x4E48;Docker&#x548C;&#x865A;&#x62DF;&#x673A;&#x8FD8;&#x6709;&#x4EC0;&#x4E48;&#x5DEE;&#x522B;&#xFF1F; <a href="#su-zhu-ru-guo-he-rong-qi-xi-tong-bu-tong-de-hua-na-bu-shi-he-xu-ni-ji-yi-yang-yi-ceng-ceng-de-diao-yong-na-me-docker-he-xu-ni-ji-huan-you-shi-me-chai-bie" class="header-anchor">#</a></h2><p>&#x8981;&#x628A; Windows &#x548C; Linux &#x5206;&#x6E05;&#x695A;&#xFF0C;&#x66F4;&#x8981;&#x628A;&#x5185;&#x6838;(<code>kernel</code>)&#x548C;&#x7528;&#x6237;&#x7A7A;&#x95F4;(<code>userland</code>)&#x5206;&#x6E05;&#x695A;&#x3002;</p>
<p>&#x5BB9;&#x5668;&#x5185;&#x7684;&#x8FDB;&#x7A0B;&#x662F;&#x76F4;&#x63A5;&#x8FD0;&#x884C;&#x4E8E;<code>&#x5BBF;&#x4E3B;&#x5185;&#x6838;</code>&#x7684;&#xFF0C;&#x8FD9;&#x70B9;&#x548C;&#x5BBF;&#x4E3B;&#x8FDB;&#x7A0B;&#x4E00;&#x81F4;&#xFF0C;&#x53EA;&#x662F;&#x5BB9;&#x5668;&#x7684;<code>userland</code>&#x4E0D;&#x540C;&#xFF0C;&#x5BB9;&#x5668;&#x7684;<code>userland</code>&#x7531;&#x5BB9;&#x5668;&#x955C;&#x50CF;&#x63D0;&#x4F9B;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x955C;&#x50CF;&#x63D0;&#x4F9B;&#x4E86; <code>rootfs</code>&#x3002;</p>
<p>&#x5047;&#x8BBE;&#x5BBF;&#x4E3B;&#x662F; <code>Ubuntu</code>&#xFF0C;&#x5BB9;&#x5668;&#x662F; <code>CentOS</code>&#x3002;<code>CentOS</code> &#x5BB9;&#x5668;&#x4E2D;&#x7684;&#x8FDB;&#x7A0B;&#x4F1A;&#x76F4;&#x63A5;&#x5411; <code>Ubuntu</code> &#x5BBF;&#x4E3B;&#x5185;&#x6838;&#x53D1;&#x9001; <code>syscall</code>&#xFF0C;&#x800C;&#x4E0D;&#x4F1A;&#x76F4;&#x63A5;&#x6216;&#x95F4;&#x63A5;&#x7684;&#x4F7F;&#x7528;&#x4EFB;&#x4F55; <code>Ubuntu</code> &#x7684;<code>userland</code>&#x7684;&#x5E93;&#x3002;</p>
<p>&#x8FD9;&#x70B9;&#x548C;&#x865A;&#x62DF;&#x673A;&#x6709;&#x672C;&#x8D28;&#x7684;&#x4E0D;&#x540C;&#xFF0C;&#x865A;&#x62DF;&#x673A;&#x662F;&#x865A;&#x62DF;&#x73AF;&#x5883;&#xFF0C;&#x5728;&#x73B0;&#x6709;&#x7CFB;&#x7EDF;&#x4E0A;&#x865A;&#x62DF;&#x4E00;&#x5957;&#x7269;&#x7406;&#x8BBE;&#x5907;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x865A;&#x62DF;&#x73AF;&#x5883;&#x5185;&#x8FD0;&#x884C;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x73AF;&#x5883;&#x7684;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5185;&#x6838;&#xFF0C;&#x5728;&#x5185;&#x6838;&#x4E4B;&#x4E0A;&#x518D;&#x8DD1;&#x5B8C;&#x6574;&#x7CFB;&#x7EDF;&#xFF0C;&#x5E76;&#x5728;&#x91CC;&#x9762;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x3002;</p>
<p>&#x8FD8;&#x4EE5;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x53BB;&#x8003;&#x8651;&#xFF0C;&#x865A;&#x62DF;&#x673A;&#x4E2D;&#xFF0C;<code>CentOS</code> &#x7684;&#x8FDB;&#x7A0B;&#x53D1;&#x9001; <code>syscall</code> &#x5185;&#x6838;&#x8C03;&#x7528;&#xFF0C;&#x8BE5;&#x8BF7;&#x6C42;&#x4F1A;&#x88AB;&#x865A;&#x62DF;&#x673A;&#x5185;&#x7684; <code>CentOS</code> &#x7684;&#x5185;&#x6838;&#x63A5;&#x5230;&#xFF0C;&#x7136;&#x540E; <code>CentOS</code> &#x5185;&#x6838;&#x8BBF;&#x95EE;&#x865A;&#x62DF;&#x786C;&#x4EF6;&#x65F6;&#xFF0C;&#x7531;&#x865A;&#x62DF;&#x673A;&#x7684;&#x670D;&#x52A1;&#x8F6F;&#x4EF6;&#x622A;&#x83B7;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x5BBF;&#x4E3B;&#x7CFB;&#x7EDF;&#xFF0C;&#x4E5F;&#x5C31;&#x662F; <code>Ubuntu</code> &#x7684;&#x5185;&#x6838;&#x53CA;<code>userland</code>&#x7684;&#x5E93;&#x53BB;&#x6267;&#x884C;&#x3002;</p>
<p>&#x800C;&#x4E14;&#xFF0C;Linux &#x548C; Windows &#x5728;&#x8FD9;&#x70B9;&#x4E0A;&#x975E;&#x5E38;&#x4E0D;&#x540C;&#x3002;Linux &#x7684;&#x8FDB;&#x7A0B;&#x662F;&#x76F4;&#x63A5;&#x53D1; <code>syscall</code> &#x7684;&#xFF0C;&#x800C; Windows &#x5219;&#x628A; <code>syscall</code> &#x9690;&#x85CF;&#x4E8E;&#x4E00;&#x5C42;&#x5C42;&#x7684; <code>DLL</code> &#x670D;&#x52A1;&#x4E4B;&#x540E;&#xFF0C;&#x56E0;&#x6B64; Windows &#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5982;&#x679C;&#x8981;&#x6267;&#x884C;&#xFF0C;&#x4E0D;&#x4EC5;&#x4EC5;&#x9700;&#x8981; Windows &#x5185;&#x6838;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x4E00;&#x7FA4;&#x670D;&#x52A1;&#x6765;&#x652F;&#x6491;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C; Windows &#x8981;&#x5B9E;&#x73B0;&#x7C7B;&#x4F3C;&#x7684;&#x673A;&#x5236;&#xFF0C;&#x5BB9;&#x5668;&#x5185;&#x5C06;&#x4E0D;&#x4F1A;&#x50CF; Linux &#x8FD9;&#x6837;&#x8F7B;&#x91CF;&#x7EA7;&#xFF0C;&#x800C;&#x662F;&#x975E;&#x5E38;&#x81C3;&#x80BF;&#x3002;&#x770B;&#x4E00;&#x4E0B;&#x5FAE;&#x8F6F;&#x79FB;&#x690D;&#x7684; Docker &#x5C31;&#x975E;&#x5E38;&#x6E05;&#x695A;&#x4E86;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x4E0D;&#x8981;&#x628A; Docker &#x548C;&#x865A;&#x62DF;&#x673A;&#x5F04;&#x6DF7;&#xFF0C;Docker&#x5BB9;&#x5668;&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x800C;&#x5DF2;&#xFF0C;&#x53EA;&#x4E0D;&#x8FC7;&#x5229;&#x7528;&#x955C;&#x50CF;&#x63D0;&#x4F9B;&#x7684;<code>rootfs</code>&#x63D0;&#x4F9B;&#x4E86;&#x8C03;&#x7528;&#x6240;&#x9700;&#x7684;<code>userland</code>&#x5E93;&#x652F;&#x6301;&#xFF0C;&#x4F7F;&#x5F97;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x5728;&#x53D7;&#x63A7;&#x73AF;&#x5883;&#x4E0B;&#x8FD0;&#x884C;&#x800C;&#x5DF2;&#xFF0C;&#x5B83;&#x5E76;&#x6CA1;&#x6709;&#x865A;&#x62DF;&#x51FA;&#x4E00;&#x4E2A;&#x673A;&#x5668;&#x51FA;&#x6765;&#x3002;</p>
<p>&#x53C2;&#x8003;&#xFF1A;</p>
<p><a href="https://www.docker.com/what-docker" target="_blank" rel="external">https://www.docker.com/what-docker</a></p>
<p><a href="/post/docker-2016-08-12-video-windows-server-and-docker.html">&#x89C6;&#x9891;&#x7B14;&#x8BB0;&#xFF1A; Windows Server &#x548C; Docker - John Starks</a></p>
<h2 id="ru-he-zai-docker-rong-qi-nei-shi-yong-docker-ming-ling-bi-ru-zai-jenkins-rong-qi-zhong"><a href="#&#x5982;&#x4F55;&#x5728;-Docker-&#x5BB9;&#x5668;&#x5185;&#x4F7F;&#x7528;-docker-&#x547D;&#x4EE4;-&#x6BD4;&#x5982;&#x5728;-Jenkins-&#x5BB9;&#x5668;&#x4E2D;-&#xFF1F;" class="headerlink" title="&#x5982;&#x4F55;&#x5728; Docker  &#x5BB9;&#x5668;&#x5185;&#x4F7F;&#x7528; docker &#x547D;&#x4EE4;(&#x6BD4;&#x5982;&#x5728; Jenkins &#x5BB9;&#x5668;&#x4E2D;)&#xFF1F;"></a>&#x5982;&#x4F55;&#x5728; Docker  &#x5BB9;&#x5668;&#x5185;&#x4F7F;&#x7528; <code>docker</code> &#x547D;&#x4EE4;(&#x6BD4;&#x5982;&#x5728; Jenkins &#x5BB9;&#x5668;&#x4E2D;)&#xFF1F; <a href="#ru-he-zai-docker-rong-qi-nei-shi-yong-docker-ming-ling-bi-ru-zai-jenkins-rong-qi-zhong" class="header-anchor">#</a></h2><p>&#x9996;&#x5148;&#xFF0C;&#x4E0D;&#x8981;&#x5728; Docker &#x5BB9;&#x5668;&#x4E2D;&#x5B89;&#x88C5;&#x3001;&#x8FD0;&#x884C; Docker &#x5F15;&#x64CE;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6240;&#x8C13;&#x7684; Docker In Docker (DIND)&#xFF0C;&#x53C2;&#x8003;&#x6587;&#x7AE0;&#xFF1A;</p>
<p><a href="https://jpetazzo.github.io/2015/09/03/do-not-use-docker-in-docker-for-ci/" target="_blank" rel="external">https://jpetazzo.github.io/2015/09/03/do-not-use-docker-in-docker-for-ci/</a></p>
<p>&#x4E3A;&#x4E86;&#x8BA9;&#x5BB9;&#x5668;&#x5185;&#x53EF;&#x4EE5;&#x6784;&#x5EFA;&#x955C;&#x50CF;&#xFF0C;&#x5E94;&#x8BE5;&#x4F7F;&#x7528; <code>Docker Remote API</code> &#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x6765;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x5BBF;&#x4E3B;&#x7684; Docker Engine&#x3002;&#x53EF;&#x4EE5;&#x662F;&#x539F;&#x751F;&#x7684; Docker CLI &#xFF08;<code>docker</code> &#x547D;&#x4EE4;&#xFF09;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;<a href="https://docs.docker.com/engine/reference/api/remote_api_client_libraries/" target="_blank" rel="external">&#x5176;&#x5B83;&#x8BED;&#x8A00;&#x7684;&#x5E93;</a>&#x3002;</p>
<h3 id="tian-jia-docker-ming-ling-xing"><a href="#&#x6DFB;&#x52A0;-Docker-&#x547D;&#x4EE4;&#x884C;" class="headerlink" title="&#x6DFB;&#x52A0; Docker &#x547D;&#x4EE4;&#x884C;"></a>&#x6DFB;&#x52A0; Docker &#x547D;&#x4EE4;&#x884C; <a href="#tian-jia-docker-ming-ling-xing" class="header-anchor">#</a></h3><p>&#x4E0B;&#x9762;&#x4EE5;&#x5B9A;&#x5236; <code>jenkins</code> &#x955C;&#x50CF;&#x4E3A;&#x4F8B;&#xFF0C;&#x4F7F;&#x7528; <code>Dockerfile</code> &#x6DFB;&#x52A0; <code>docker</code> &#x547D;&#x4EE4;&#x884C;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x8C03;&#x6574;&#x6743;&#x9650;&#x3002;</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">FROM</span> jenkins:alpine</div><div class="line"></div><div class="line"><span class="comment"># &#x4E0B;&#x8F7D;&#x5B89;&#x88C5;Docker CLI</span></div><div class="line"><span class="keyword">USER</span> root</div><div class="line"><span class="keyword">RUN</span><span class="bash"> curl -O https://get.docker.com/builds/Linux/x86_64/docker-latest.tgz \</span></div><div class="line">    &amp;&amp; tar zxvf docker-latest.tgz \</div><div class="line">    &amp;&amp; cp docker/docker /usr/<span class="built_in">local</span>/bin/ \</div><div class="line">    &amp;&amp; rm -rf docker docker-latest.tgz</div><div class="line"></div><div class="line"><span class="comment"># &#x5C06; `jenkins` &#x7528;&#x6237;&#x7684;&#x7EC4; ID &#x6539;&#x4E3A;&#x5BBF;&#x4E3B; `docker` &#x7EC4;&#x7684;&#x7EC4;ID&#xFF0C;&#x4ECE;&#x800C;&#x5177;&#x6709;&#x6267;&#x884C; `docker` &#x547D;&#x4EE4;&#x7684;&#x6743;&#x9650;&#x3002;</span></div><div class="line">ARG DOCKER_GID=<span class="number">999</span></div><div class="line"><span class="keyword">USER</span> jenkins:${DOCKER_GID}</div></pre></td></tr></table></figure>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x4E0B;&#x8F7D;&#x4E86;&#x9759;&#x6001;&#x7F16;&#x8BD1;&#x7684; <code>docker</code> &#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x63D0;&#x53D6;&#x547D;&#x4EE4;&#x884C;&#x5B89;&#x88C5;&#x5230;&#x7CFB;&#x7EDF;&#x76EE;&#x5F55;&#x4E0B;&#x3002;&#x7136;&#x540E;&#x8C03;&#x6574;&#x4E86; <code>jenkins</code> &#x7528;&#x6237;&#x7684;&#x7EC4; ID&#xFF0C;&#x8C03;&#x6574;&#x4E3A;&#x5BBF;&#x4E3B; <code>docker</code> &#x7EC4;ID&#xFF0C;&#x4ECE;&#x800C;&#x4F7F;&#x5176;&#x5177;&#x6709;&#x6267;&#x884C; <code>docker</code> &#x547D;&#x4EE4;&#x7684;&#x6743;&#x9650;&#x3002;</p>
<p>&#x7EC4; ID &#x4F7F;&#x7528;&#x4E86; <code>DOCKER_GID</code> &#x53C2;&#x6570;&#x6765;&#x5B9A;&#x4E49;&#xFF0C;&#x4EE5;&#x65B9;&#x4FBF;&#x8FDB;&#x4E00;&#x6B65;&#x5B9A;&#x5236;&#x3002;&#x6784;&#x5EFA;&#x65F6;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <code>--build-arg</code> &#x6765;&#x6539;&#x53D8; <code>DOCKER_GID</code> &#x7684;&#x9ED8;&#x8BA4;&#x503C;&#xFF0C;&#x8FD0;&#x884C;&#x65F6;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <code>--user jenkins:1234</code> &#x6765;&#x6539;&#x53D8;&#x8FD0;&#x884C;&#x7528;&#x6237;&#x7684;&#x8EAB;&#x4EFD;&#x3002;</p>
<p><em>&#x8FD9;&#x91CC;&#x7684;&#x57FA;&#x7840;&#x955C;&#x50CF;&#x4F7F;&#x7528;&#x7684;&#x662F; <code>jenkins:alpine</code>&#xFF0C;&#x6362;&#x4E3A;&#x975E; <code>alpine</code> &#x7684;&#x955C;&#x50CF; <code>jenkins:latest</code> &#x4E5F;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;</em></p>
<p>&#x7528;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x6765;&#x6784;&#x5EFA;&#x955C;&#x50CF;&#xFF08;&#x5047;&#x8BBE;&#x955C;&#x50CF;&#x540D;&#x4E3A; <code>jenkins-docker</code>&#xFF09;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ docker build -t jenkins-docker .</div></pre></td></tr></table></figure>
<p>&#x5982;&#x679C;&#x9700;&#x8981;&#x6784;&#x5EFA;&#x65F6;&#x8C03;&#x6574; <code>docker</code> &#x7EC4; ID&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>--build-arg</code> &#x6765;&#x8986;&#x76D6;&#x53C2;&#x6570;&#x9ED8;&#x8BA4;&#x503C;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ docker build -t jenkins-docker --build-arg DOCKER_GID=1234 .</div></pre></td></tr></table></figure>
<p>&#x5728;&#x542F;&#x52A8;&#x5BB9;&#x5668;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C06;&#x5BBF;&#x4E3B;&#x7684; <code>/var/run/docker.sock</code> &#x6587;&#x4EF6;&#x6302;&#x8F7D;&#x5230;&#x5BB9;&#x5668;&#x5185;&#x7684;&#x540C;&#x6837;&#x4F4D;&#x7F6E;&#xFF0C;&#x4ECE;&#x800C;&#x8BA9;&#x5BB9;&#x5668;&#x5185;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <a href="https://en.wikipedia.org/wiki/Unix_domain_socket" target="_blank" rel="external">unix socket</a> &#x8C03;&#x7528;&#x5BBF;&#x4E3B;&#x7684; Docker &#x5F15;&#x64CE;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x542F;&#x52A8; <code>jenkins</code>&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ docker run --name jenkins \</div><div class="line">    <span class="_">-d</span> \</div><div class="line">    -p 8080:8080 \</div><div class="line">    -v /var/run/docker.sock:/var/run/docker.sock \</div><div class="line">    jenkins-docker</div></pre></td></tr></table></figure>
<p>&#x5728; <code>jenkins</code> &#x5BB9;&#x5668;&#x4E2D;&#xFF0C;&#x5C31;&#x5DF2;&#x7ECF;&#x53EF;&#x4EE5;&#x6267;&#x884C; <code>docker</code> &#x547D;&#x4EE4;&#x4E86;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <code>docker exec</code> &#x6765;&#x9A8C;&#x8BC1;&#x8FD9;&#x4E2A;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">$ docker <span class="built_in">exec</span> -it jenkins sh</div><div class="line">/ $ id</div><div class="line">uid=1000(jenkins) gid=999(ping) groups=999(ping)</div><div class="line">/ $ docker version</div><div class="line">Client:</div><div class="line"> Version:      1.12.3</div><div class="line"> API version:  1.24</div><div class="line"> Go version:   go1.6.3</div><div class="line"> Git commit:   6b644ec</div><div class="line"> Built:        Wed Oct 26 23:26:11 2016</div><div class="line"> OS/Arch:      linux/amd64</div><div class="line"></div><div class="line">Server:</div><div class="line"> Version:      1.13.0-rc2</div><div class="line"> API version:  1.25</div><div class="line"> Go version:   go1.7.3</div><div class="line"> Git commit:   1f9b3ef</div><div class="line"> Built:        Wed Nov 23 06:32:39 2016</div><div class="line"> OS/Arch:      linux/amd64</div><div class="line">/ $</div></pre></td></tr></table></figure>
<h2 id="zen-me-gu-ding-rong-qi-ip-di-zhi-mei-ci-chong-qi-rong-qi-du-yao-bian-hua-ip-di-zhi-zen-me-ban"><a href="#&#x600E;&#x4E48;&#x56FA;&#x5B9A;&#x5BB9;&#x5668;-IP-&#x5730;&#x5740;&#xFF1F;&#x6BCF;&#x6B21;&#x91CD;&#x542F;&#x5BB9;&#x5668;&#x90FD;&#x8981;&#x53D8;&#x5316;IP&#x5730;&#x5740;&#x600E;&#x4E48;&#x529E;&#xFF1F;" class="headerlink" title="&#x600E;&#x4E48;&#x56FA;&#x5B9A;&#x5BB9;&#x5668; IP &#x5730;&#x5740;&#xFF1F;&#x6BCF;&#x6B21;&#x91CD;&#x542F;&#x5BB9;&#x5668;&#x90FD;&#x8981;&#x53D8;&#x5316;IP&#x5730;&#x5740;&#x600E;&#x4E48;&#x529E;&#xFF1F;"></a>&#x600E;&#x4E48;&#x56FA;&#x5B9A;&#x5BB9;&#x5668; IP &#x5730;&#x5740;&#xFF1F;&#x6BCF;&#x6B21;&#x91CD;&#x542F;&#x5BB9;&#x5668;&#x90FD;&#x8981;&#x53D8;&#x5316;IP&#x5730;&#x5740;&#x600E;&#x4E48;&#x529E;&#xFF1F; <a href="#zen-me-gu-ding-rong-qi-ip-di-zhi-mei-ci-chong-qi-rong-qi-du-yao-bian-hua-ip-di-zhi-zen-me-ban" class="header-anchor">#</a></h2><p>&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x662F;&#x4E0D;&#x9700;&#x8981;&#x6307;&#x5B9A;&#x5BB9;&#x5668;IP&#x5730;&#x5740;&#x7684;&#x3002;&#x8FD9;&#x4E0D;&#x662F;&#x865A;&#x62DF;&#x4E3B;&#x673A;&#xFF0C;&#x800C;&#x662F;&#x5BB9;&#x5668;&#x3002;&#x5176;&#x5730;&#x5740;&#x662F;&#x4F9B;&#x5BB9;&#x5668;&#x95F4;&#x901A;&#x8BAF;&#x7684;&#xFF0C;&#x5BB9;&#x5668;&#x95F4;&#x5219;&#x4E0D;&#x7528;ip&#x76F4;&#x63A5;&#x901A;&#x8BAF;&#xFF0C;&#x800C;&#x4F7F;&#x7528;&#x4E3B;&#x673A;&#x540D;&#x3001;&#x670D;&#x52A1;&#x540D;&#x3001;&#x7F51;&#x7EDC;&#x522B;&#x540D;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x4FDD;&#x6301;&#x5411;&#x540E;&#x517C;&#x5BB9;&#xFF0C;<code>docker run</code> &#x5728;&#x4E0D;&#x6307;&#x5B9A;<code>--net</code>&#x65F6;&#x6240;&#x5728;&#x7684;&#x7F51;&#x7EDC;&#x662F;<code>default bridge</code>&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x7F51;&#x7EDC;&#x4E0B;&#xFF0C;&#x9700;&#x8981;&#x4F7F;&#x7528; <code>--link</code> &#x53C2;&#x6570;&#x624D;&#x53EF;&#x4EE5;&#x8BA9;&#x4E24;&#x4E2A;&#x5BB9;&#x5668;&#x627E;&#x5230;&#x5BF9;&#x65B9;&#x3002;</p>
<p>&#x8FD9;&#x662F;&#x6709;&#x5C40;&#x9650;&#x6027;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x4F7F;&#x7528;&#x7684;&#x662F; <code>/etc/hosts</code> &#x9759;&#x6001;&#x6587;&#x4EF6;&#x6765;&#x8FDB;&#x884C;&#x7684;&#x89E3;&#x6790;&#xFF0C;&#x6BD4;&#x5982;&#x4E00;&#x4E2A;&#x4E3B;&#x673A;&#x6302;&#x4E86;&#x540E;&#xFF0C;&#x91CD;&#x65B0;&#x542F;&#x52A8;IP&#x53EF;&#x80FD;&#x4F1A;&#x6539;&#x53D8;&#x3002;&#x867D;&#x7136;&#x8BF4;&#x8FD9;&#x79CD;&#x6539;&#x53D8;Docker&#x662F;&#x53EF;&#x80FD;&#x66F4;&#x65B0;<code>/etc/hosts</code>&#x6587;&#x4EF6;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x6709;&#x8BF8;&#x591A;&#x95EE;&#x9898;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x56E0;&#x4E3A;&#x7ADE;&#x4E89;&#x5192;&#x9669;&#x5BFC;&#x81F4; <code>/etc/hosts</code> &#x6587;&#x4EF6;&#x635F;&#x6BC1;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x8FD8;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x5BB9;&#x5668;&#x5728;&#x53D6;&#x5F97; <code>/etc/hosts</code> &#x7684;&#x89E3;&#x6790;&#x7ED3;&#x679C;&#x540E;&#xFF0C;&#x4E0D;&#x518D;&#x53BB;&#x76D1;&#x89C6;&#x8BE5;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x53D8;&#x52A8;&#x3002;&#x79CD;&#x79CD;&#x539F;&#x56E0;&#x90FD;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x65E7;&#x7684;&#x4E3B;&#x673A;&#x65E0;&#x6CD5;&#x901A;&#x8FC7;&#x5BB9;&#x5668;&#x540D;&#x8BBF;&#x95EE;&#x5230;&#x65B0;&#x7684;&#x4E3B;&#x673A;&#x3002;</p>
<p>&#x53C2;&#x8003;&#x5B98;&#x7F51;&#x6587;&#x6863;&#xFF1A;<a href="https://docs.docker.com/engine/userguide/networking/default_network/dockerlinks/" target="_blank" rel="external">https://docs.docker.com/engine/userguide/networking/default_network/dockerlinks/</a></p>
<p>&#x5982;&#x679C;&#x53EF;&#x80FD;&#x4E0D;&#x8981;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x8FC7;&#x65F6;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x800C;&#x662F;&#x7528;&#x4E0B;&#x9762;&#x8BF4;&#x7684;&#x81EA;&#x5B9A;&#x4E49;&#x7F51;&#x7EDC;&#x7684;&#x65B9;&#x5F0F;&#x3002;</p>
<p>&#x800C;&#x5BF9;&#x4E8E;&#x65B0;&#x7684;&#x73AF;&#x5883;&#xFF08;Docker 1.10&#x4EE5;&#x4E0A;&#xFF09;&#xFF0C;&#x5E94;&#x8BE5;&#x7ED9;&#x5BB9;&#x5668;&#x5EFA;&#x7ACB;&#x81EA;&#x5B9A;&#x4E49;&#x7F51;&#x7EDC;&#xFF0C;&#x540C;&#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x7F51;&#x7EDC;&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5BF9;&#x65B9;&#x5BB9;&#x5668;&#x7684;&#x5BB9;&#x5668;&#x540D;&#x3001;&#x670D;&#x52A1;&#x540D;&#x3001;&#x7F51;&#x7EDC;&#x522B;&#x540D;&#x6765;&#x627E;&#x5230;&#x5BF9;&#x65B9;&#x3002;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5E2E;&#x52A9;&#x8FDB;&#x884C;&#x670D;&#x52A1;&#x53D1;&#x73B0;&#x7684;&#x662F;Docker &#x5185;&#x7F6E;&#x7684;DNS&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x65E0;&#x8BBA;&#x5BB9;&#x5668;&#x662F;&#x5426;&#x91CD;&#x542F;&#x3001;&#x66F4;&#x6362;IP&#xFF0C;&#x5185;&#x7F6E;&#x7684;DNS&#x90FD;&#x80FD;&#x6B63;&#x786E;&#x6307;&#x5B9A;&#x5230;&#x5BF9;&#x65B9;&#x7684;&#x4F4D;&#x7F6E;&#x3002;</p>
<p>&#x53C2;&#x8003;&#x5B98;&#x7F51;&#x6587;&#x6863;&#xFF1A;<a href="https://docs.docker.com/engine/userguide/networking/work-with-networks/#linking-containers-in-user-defined-networks" target="_blank" rel="external">https://docs.docker.com/engine/userguide/networking/work-with-networks/#linking-containers-in-user-defined-networks</a></p>
<p>&#x5EFA;&#x8BAE;&#x53C2;&#x8003;&#x4E00;&#x4E0B;&#x6211;&#x5199;&#x7684; LNMP &#x7684;&#x4F8B;&#x5B50;&#xFF1A;<br><a href="https://coding.net/u/twang2218/p/docker-lnmp/git" target="_blank" rel="external">https://coding.net/u/twang2218/p/docker-lnmp/git</a></p>
<h2 id="ru-he-xiu-gai-rong-qi-de-etc-hosts-wen-jian"><a href="#&#x5982;&#x4F55;&#x4FEE;&#x6539;&#x5BB9;&#x5668;&#x7684;-etc-hosts-&#x6587;&#x4EF6;&#xFF1F;" class="headerlink" title="&#x5982;&#x4F55;&#x4FEE;&#x6539;&#x5BB9;&#x5668;&#x7684; /etc/hosts &#x6587;&#x4EF6;&#xFF1F;"></a>&#x5982;&#x4F55;&#x4FEE;&#x6539;&#x5BB9;&#x5668;&#x7684; <code>/etc/hosts</code> &#x6587;&#x4EF6;&#xFF1F; <a href="#ru-he-xiu-gai-rong-qi-de-etc-hosts-wen-jian" class="header-anchor">#</a></h2><p>&#x5BB9;&#x5668;&#x5185;&#x7684; <code>/etc/hosts</code> &#x6587;&#x4EF6;&#x4E0D;&#x5E94;&#x8BE5;&#x88AB;&#x968F;&#x610F;&#x4FEE;&#x6539;&#xFF0C;&#x5982;&#x679C;&#x5FC5;&#x987B;&#x6307;&#x5B9A; host&#xFF0C;&#x5E94;&#x8BE5;&#x5728; <code>docker run</code> &#x65F6;&#x4F7F;&#x7528; <code>--add-host</code> &#x53C2;&#x6570;&#xFF0C;&#x6216;&#x8005;&#x5728; <code>docker-compose.yml</code> &#x4E2D;&#x6DFB;&#x52A0; <code>extra_hosts</code> &#x9879;&#x3002;</p>
<p>&#x4E0D;&#x8FC7;&#x5728;&#x7528;&#x4E4B;&#x524D;&#xFF0C;&#x5E94;&#x8BE5;&#x518D;&#x8003;&#x8651;&#x4E00;&#x4E0B;&#x771F;&#x7684;&#x9700;&#x8981;&#x4FEE;&#x6539; <code>/etc/hosts</code> &#x4E48;&#xFF1F;&#x5982;&#x679C;&#x53EA;&#x662F;&#x4E3A;&#x4E86;&#x5BB9;&#x5668;&#x95F4;&#x4E92;&#x76F8;&#x8BBF;&#x95EE;&#xFF0C;&#x5E94;&#x8BE5;&#x5EFA;&#x7ACB;&#x81EA;&#x5B9A;&#x4E49;&#x7F51;&#x7EDC;&#xFF0C;&#x5E76;&#x4F7F;&#x7528; Docker &#x5185;&#x7F6E;&#x7684; DNS &#x670D;&#x52A1;&#x3002;</p>
<p>&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x4E00;&#x4E0B;&#x6211;&#x5199;&#x7684;&#x8FD9;&#x4E2A; LNMP &#x591A;&#x5BB9;&#x5668;&#x4E92;&#x8FDE;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;<a href="https://coding.net/u/twang2218/p/docker-lnmp/git" target="_blank" rel="external">https://coding.net/u/twang2218/p/docker-lnmp/git</a></p>
<h2 id="docker-rong-qi-ru-he-sui-xi-tong-yi-tong-qi-dong"><a href="#Docker-&#x5BB9;&#x5668;&#x5982;&#x4F55;&#x968F;&#x7CFB;&#x7EDF;&#x4E00;&#x540C;&#x542F;&#x52A8;&#xFF1F;" class="headerlink" title="Docker &#x5BB9;&#x5668;&#x5982;&#x4F55;&#x968F;&#x7CFB;&#x7EDF;&#x4E00;&#x540C;&#x542F;&#x52A8;&#xFF1F;"></a>Docker &#x5BB9;&#x5668;&#x5982;&#x4F55;&#x968F;&#x7CFB;&#x7EDF;&#x4E00;&#x540C;&#x542F;&#x52A8;&#xFF1F; <a href="#docker-rong-qi-ru-he-sui-xi-tong-yi-tong-qi-dong" class="header-anchor">#</a></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">--restart=always</div></pre></td></tr></table></figure>
<p>&#x53C2;&#x8003;&#x5B98;&#x7F51;&#x6587;&#x6863;&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/run/#restart-policies-restart" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/run/#restart-policies-restart</a></p>
<h2 id="zen-me-ying-she-su-zhu-duan-kou-dockerfile-zhong-de-expose-he-docker-run-p-you-sha-qu-bie"><a href="#&#x600E;&#x4E48;&#x6620;&#x5C04;&#x5BBF;&#x4E3B;&#x7AEF;&#x53E3;&#xFF1F;Dockerfile-&#x4E2D;&#x7684;EXPOSE&#x548C;-docker-run-p-&#x6709;&#x5565;&#x533A;&#x522B;&#xFF1F;" class="headerlink" title="&#x600E;&#x4E48;&#x6620;&#x5C04;&#x5BBF;&#x4E3B;&#x7AEF;&#x53E3;&#xFF1F;Dockerfile &#x4E2D;&#x7684;EXPOSE&#x548C; docker run -p &#x6709;&#x5565;&#x533A;&#x522B;&#xFF1F;"></a>&#x600E;&#x4E48;&#x6620;&#x5C04;&#x5BBF;&#x4E3B;&#x7AEF;&#x53E3;&#xFF1F;<code>Dockerfile</code> &#x4E2D;&#x7684;<code>EXPOSE</code>&#x548C; <code>docker run -p</code> &#x6709;&#x5565;&#x533A;&#x522B;&#xFF1F; <a href="#zen-me-ying-she-su-zhu-duan-kou-dockerfile-zhong-de-expose-he-docker-run-p-you-sha-qu-bie" class="header-anchor">#</a></h2><p>Docker&#x4E2D;&#x6709;&#x4E24;&#x4E2A;&#x6982;&#x5FF5;&#xFF0C;&#x4E00;&#x4E2A;&#x53EB;&#x505A; <code>EXPOSE</code> &#xFF0C;&#x4E00;&#x4E2A;&#x53EB;&#x505A; <code>PUBLISH</code> &#x3002;</p>
<ul>
<li><code>EXPOSE</code> &#x662F;&#x955C;&#x50CF;/&#x5BB9;&#x5668;&#x58F0;&#x660E;&#x8981;&#x66B4;&#x9732;&#x8BE5;&#x7AEF;&#x53E3;&#xFF0C;&#x53EF;&#x4EE5;&#x4F9B;&#x5176;&#x4ED6;&#x5BB9;&#x5668;&#x4F7F;&#x7528;&#x3002;&#x8FD9;&#x79CD;&#x58F0;&#x660E;&#xFF0C;&#x5728;&#x6CA1;&#x6709;&#x8BBE;&#x5B9A; <code>--icc=false</code>&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x53EA;&#x662F;&#x4E00;&#x79CD;&#x6807;&#x6CE8;&#xFF0C;&#x5E76;&#x4E0D;&#x5F3A;&#x5236;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x6CA1;&#x6709;&#x58F0;&#x660E; <code>EXPOSE</code> &#x7684;&#x7AEF;&#x53E3;&#xFF0C;&#x5176;&#x5B83;&#x5BB9;&#x5668;&#x4E5F;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x3002;&#x4F46;&#x662F;&#x5F53;&#x5F3A;&#x5236; <code>--icc=false</code> &#x7684;&#x65F6;&#x5019;&#xFF0C;&#x90A3;&#x4E48;&#x53EA;&#x6709; <code>EXPOSE</code> &#x7684;&#x7AEF;&#x53E3;&#xFF0C;&#x5176;&#x5B83;&#x5BB9;&#x5668;&#x624D;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x3002;</li>
<li><code>PUBLISH</code> &#x5219;&#x662F;&#x901A;&#x8FC7;&#x6620;&#x5C04;&#x5BBF;&#x4E3B;&#x7AEF;&#x53E3;&#xFF0C;&#x5C06;&#x5BB9;&#x5668;&#x7684;&#x7AEF;&#x53E3;&#x516C;&#x5F00;&#x4E8E;&#x5916;&#x754C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5BBF;&#x4E3B;&#x4E4B;&#x5916;&#x7684;&#x673A;&#x5668;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8BBF;&#x95EE;&#x5BBF;&#x4E3B;IP&#x53CA;&#x5BF9;&#x5E94;&#x7684;&#x8BE5;&#x6620;&#x5C04;&#x7AEF;&#x53E3;&#xFF0C;&#x8BBF;&#x95EE;&#x5230;&#x5BB9;&#x5668;&#x5BF9;&#x5E94;&#x7AEF;&#x53E3;&#xFF0C;&#x4ECE;&#x800C;&#x4F7F;&#x7528;&#x5BB9;&#x5668;&#x670D;&#x52A1;&#x3002;</li>
</ul>
<p><code>EXPOSE</code> &#x7684;&#x7AEF;&#x53E3;&#x53EF;&#x4EE5;&#x4E0D; <code>PUBLISH</code>&#xFF0C;&#x8FD9;&#x6837;&#x53EA;&#x6709;&#x5BB9;&#x5668;&#x95F4;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#xFF0C;&#x5BBF;&#x4E3B;&#x4E4B;&#x5916;&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;&#x3002;&#x800C; <code>PUBLISH</code> &#x7684;&#x7AEF;&#x53E3;&#xFF0C;&#x53EF;&#x4EE5;&#x4E0D;&#x4E8B;&#x5148; <code>EXPOSE</code>&#xFF0C;&#x6362;&#x53E5;&#x8BDD;&#x8BF4; <code>PUBLISH</code> &#x7B49;&#x4E8E;&#x540C;&#x65F6;&#x9690;&#x5F0F;&#x5B9A;&#x4E49;&#x4E86;&#x8BE5;&#x7AEF;&#x53E3;&#x8981; <code>EXPOSE</code>&#x3002;</p>
<p><code>docker run</code> &#x547D;&#x4EE4;&#x4E2D;&#x7684; <code>-p</code>, <code>-P</code> &#x53C2;&#x6570;&#xFF0C;&#x4EE5;&#x53CA; <code>docker-compose.yml</code> &#x4E2D;&#x7684;  <code>ports</code> &#x90E8;&#x5206;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x5747;&#x662F;&#x6307; <code>PUBLISH</code>&#x3002;</p>
<p>&#x5C0F;&#x5199; <code>-p</code> &#x662F;&#x7AEF;&#x53E3;&#x6620;&#x5C04;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A; <code>[&#x5BBF;&#x4E3B;IP:]&lt;&#x5BBF;&#x4E3B;&#x7AEF;&#x53E3;&gt;:&lt;&#x5BB9;&#x5668;&#x7AEF;&#x53E3;&gt;</code>&#xFF0C;&#x5176;&#x4E2D;&#x5BBF;&#x4E3B;&#x7AEF;&#x53E3;&#x548C;&#x5BB9;&#x5668;&#x7AEF;&#x53E3;&#xFF0C;&#x65E2;&#x53EF;&#x4EE5;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x4E00;&#x4E2A;&#x8303;&#x56F4;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;<code>1000-2000:1000-2000</code>&#x3002;&#x5BF9;&#x4E8E;&#x591A;&#x5BBF;&#x4E3B;&#x7684;&#x673A;&#x5668;&#xFF0C;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x5BBF;&#x4E3B;IP&#xFF0C;&#x4E0D;&#x6307;&#x5B9A;&#x5BBF;&#x4E3B;IP&#x65F6;&#xFF0C;&#x5B88;&#x62A4;&#x6240;&#x6709;&#x63A5;&#x53E3;&#x3002;</p>
<p>&#x5927;&#x5199; <code>-P</code> &#x5219;&#x662F;&#x81EA;&#x52A8;&#x6620;&#x5C04;&#xFF0C;&#x5C06;&#x6240;&#x6709;&#x5B9A;&#x4E49; <code>EXPOSE</code> &#x7684;&#x7AEF;&#x53E3;&#xFF0C;&#x968F;&#x673A;&#x6620;&#x5C04;&#x5230;&#x5BBF;&#x4E3B;&#x7684;&#x67D0;&#x4E2A;&#x7AEF;&#x53E3;&#x3002;</p>
<h2 id="wo-yao-ying-she-hao-ji-bai-ge-duan-kou-nan-dao-yao-yi-ge-ge-p-me"><a href="#&#x6211;&#x8981;&#x6620;&#x5C04;&#x597D;&#x51E0;&#x767E;&#x4E2A;&#x7AEF;&#x53E3;&#xFF0C;&#x96BE;&#x9053;&#x8981;&#x4E00;&#x4E2A;&#x4E2A;-p&#x4E48;&#xFF1F;" class="headerlink" title="&#x6211;&#x8981;&#x6620;&#x5C04;&#x597D;&#x51E0;&#x767E;&#x4E2A;&#x7AEF;&#x53E3;&#xFF0C;&#x96BE;&#x9053;&#x8981;&#x4E00;&#x4E2A;&#x4E2A;-p&#x4E48;&#xFF1F;"></a>&#x6211;&#x8981;&#x6620;&#x5C04;&#x597D;&#x51E0;&#x767E;&#x4E2A;&#x7AEF;&#x53E3;&#xFF0C;&#x96BE;&#x9053;&#x8981;&#x4E00;&#x4E2A;&#x4E2A;<code>-p</code>&#x4E48;&#xFF1F; <a href="#wo-yao-ying-she-hao-ji-bai-ge-duan-kou-nan-dao-yao-yi-ge-ge-p-me" class="header-anchor">#</a></h2><p>-p &#x662F;&#x53EF;&#x4EE5;&#x7528;&#x8303;&#x56F4;&#x7684;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">-p 8001-8010:8001-8010</div></pre></td></tr></table></figure>
<h2 id="vethxxxx-zhe-chong-xu-ni-wang-qia-he-rong-qi-de-dui-ying-guan-xi-cong-na-li-kan"><a href="#vethxxxx-&#x8FD9;&#x79CD;&#x865A;&#x62DF;&#x7F51;&#x5361;&#x548C;&#x5BB9;&#x5668;&#x7684;&#x5BF9;&#x5E94;&#x5173;&#x7CFB;&#x4ECE;&#x54EA;&#x91CC;&#x770B;&#xFF1F;" class="headerlink" title="vethxxxx &#x8FD9;&#x79CD;&#x865A;&#x62DF;&#x7F51;&#x5361;&#x548C;&#x5BB9;&#x5668;&#x7684;&#x5BF9;&#x5E94;&#x5173;&#x7CFB;&#x4ECE;&#x54EA;&#x91CC;&#x770B;&#xFF1F;"></a><code>vethxxxx</code> &#x8FD9;&#x79CD;&#x865A;&#x62DF;&#x7F51;&#x5361;&#x548C;&#x5BB9;&#x5668;&#x7684;&#x5BF9;&#x5E94;&#x5173;&#x7CFB;&#x4ECE;&#x54EA;&#x91CC;&#x770B;&#xFF1F; <a href="#vethxxxx-zhe-chong-xu-ni-wang-qia-he-rong-qi-de-dui-ying-guan-xi-cong-na-li-kan" class="header-anchor">#</a></h2><p><code>&#x5317;&#x4EAC;-ZZ-&#x867E;&#x7C73;</code>&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x597D;&#x529E;&#x6CD5;&#x3002;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ docker network ls</div><div class="line">NETWORK ID          NAME                       DRIVER</div><div class="line">56f04389b8f0        dockerlnmp_backend         bridge</div><div class="line">094fcb269385        dockerlnmp_frontend        bridge</div></pre></td></tr></table></figure>
<p>&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x7684; <code>NETWORK ID</code>&#xFF0C;&#x7136;&#x540E;&#x8FD0;&#x884C; <code>ip a | grep veth</code>&#x3002;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ ip a | grep veth</div><div class="line">12: veth22996d2@<span class="keyword">if</span>11: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master br-56f04389b8f0 state UP group default</div><div class="line">14: veth34ace9a@<span class="keyword">if</span>13: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master br-56f04389b8f0 state UP group default</div><div class="line">16: veth0bb3771@<span class="keyword">if</span>15: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master br-56f04389b8f0 state UP group default</div><div class="line">22: veth399b874@<span class="keyword">if</span>21: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master br-094fcb269385 state UP group default</div><div class="line">24: vethf24a0a9@<span class="keyword">if</span>23: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master br-094fcb269385 state UP group default</div></pre></td></tr></table></figure>
<p>&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x7684; <code>br-56f04389b8f0</code> &#x4EE5;&#x53CA; <code>br-094fcb269385</code>&#xFF0C;<code>br-</code>&#x540E;&#x9762;&#x7684;&#x662F;&#x4E0A;&#x9762;&#x7684;<code>&#x7F51;&#x7EDC;id</code>&#xFF0C;&#x7531;&#x6B64;&#x53EF;&#x4EE5;&#x770B;&#x51FA; <code>veth</code> &#x548C; Docker &#x7F51;&#x7EDC;&#x7684;&#x5BF9;&#x5E94;&#x5173;&#x7CFB;&#xFF0C;&#x800C;&#x5BB9;&#x5668;&#x90FD;&#x662F;&#x8FDE;&#x63A5;&#x5230;&#x4E86;&#x67D0;&#x4E2A;Docker&#x7F51;&#x7EDC;&#x4E0A;&#x7684;&#xFF0C;&#x4ECE;&#x800C;&#x5C31;&#x6709;&#x4E86;&#x5BB9;&#x5668;&#x548C;<code>veth</code>&#x7684;&#x5BF9;&#x5E94;&#x5173;&#x7CFB;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x67D0;&#x4E2A;&#x7F51;&#x7EDC;&#x51FA;&#x73B0;&#x4E86;&#x591A;&#x4E2A; <code>veth</code> &#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x53EF;&#x4EE5;&#x89C2;&#x5BDF; <code>veth22996d2@if11</code> &#x540E;&#x9762;&#x7684; <code>if11</code> &#x8FD9;&#x90E8;&#x5206;&#xFF0C;&#x548C;&#x5BB9;&#x5668;&#x5185;&#x7684; <code>ip addr</code> &#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x4E00;&#x822C; <code>&#x5947;-&#x5076;</code>&#x662F;&#x4E00;&#x5BF9;&#x3002;</p>
<h2 id="rong-qi-ci-pan-ke-yi-xian-zhi-pei-e-me"><a href="#&#x5BB9;&#x5668;&#x78C1;&#x76D8;&#x53EF;&#x4EE5;&#x9650;&#x5236;&#x914D;&#x989D;&#x4E48;&#xFF1F;" class="headerlink" title="&#x5BB9;&#x5668;&#x78C1;&#x76D8;&#x53EF;&#x4EE5;&#x9650;&#x5236;&#x914D;&#x989D;&#x4E48;&#xFF1F;"></a>&#x5BB9;&#x5668;&#x78C1;&#x76D8;&#x53EF;&#x4EE5;&#x9650;&#x5236;&#x914D;&#x989D;&#x4E48;&#xFF1F; <a href="#rong-qi-ci-pan-ke-yi-xian-zhi-pei-e-me" class="header-anchor">#</a></h2><p>&#x5BF9;&#x4E8E; <code>devicemapper</code>, <code>btrfs</code>, <code>zfs</code> &#x6765;&#x8BF4;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <code>--storage-opt size=100G</code> &#x8FD9;&#x79CD;&#x5F62;&#x5F0F;&#x9650;&#x5236; <code>rootfs</code> &#x7684;&#x5927;&#x5C0F;&#x3002;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker create -it --storage-opt size=120G fedora /bin/bash</div></pre></td></tr></table></figure>
<p>&#x53C2;&#x8003;&#x5B98;&#x7F51;&#x6587;&#x6863;&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/run/#/set-storage-driver-options-per-container" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/run/#/set-storage-driver-options-per-container</a></p>
<h2 id="docker-stats-xian-shi-de-zhi-you-rong-qi-id-zen-me-cai-neng-xian-shi-rong-qi-ming-zi"><a href="#docker-stats-&#x663E;&#x793A;&#x7684;&#x53EA;&#x6709;&#x5BB9;&#x5668;ID&#xFF0C;&#x600E;&#x4E48;&#x624D;&#x80FD;&#x663E;&#x793A;&#x5BB9;&#x5668;&#x540D;&#x5B57;&#xFF1F;" class="headerlink" title="docker stats &#x663E;&#x793A;&#x7684;&#x53EA;&#x6709;&#x5BB9;&#x5668;ID&#xFF0C;&#x600E;&#x4E48;&#x624D;&#x80FD;&#x663E;&#x793A;&#x5BB9;&#x5668;&#x540D;&#x5B57;&#xFF1F;"></a><code>docker stats</code> &#x663E;&#x793A;&#x7684;&#x53EA;&#x6709;&#x5BB9;&#x5668;ID&#xFF0C;&#x600E;&#x4E48;&#x624D;&#x80FD;&#x663E;&#x793A;&#x5BB9;&#x5668;&#x540D;&#x5B57;&#xFF1F; <a href="#docker-stats-xian-shi-de-zhi-you-rong-qi-id-zen-me-cai-neng-xian-shi-rong-qi-ming-zi" class="header-anchor">#</a></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker stats $(docker ps --format=<span class="string">&apos;{{.Names}}&apos;</span>)</div></pre></td></tr></table></figure>
<h2 id="rong-qi-nei-de-shu-ju-gai-bao-cun-zai-jing-xiang-li-huan-shi-wu-li-ji-li"><a href="#&#x5BB9;&#x5668;&#x5185;&#x7684;&#x6570;&#x636E;&#x8BE5;&#x4FDD;&#x5B58;&#x5728;&#x955C;&#x50CF;&#x91CC;&#x8FD8;&#x662F;&#x7269;&#x7406;&#x673A;&#x91CC;&#xFF1F;" class="headerlink" title="&#x5BB9;&#x5668;&#x5185;&#x7684;&#x6570;&#x636E;&#x8BE5;&#x4FDD;&#x5B58;&#x5728;&#x955C;&#x50CF;&#x91CC;&#x8FD8;&#x662F;&#x7269;&#x7406;&#x673A;&#x91CC;&#xFF1F;"></a>&#x5BB9;&#x5668;&#x5185;&#x7684;&#x6570;&#x636E;&#x8BE5;&#x4FDD;&#x5B58;&#x5728;&#x955C;&#x50CF;&#x91CC;&#x8FD8;&#x662F;&#x7269;&#x7406;&#x673A;&#x91CC;&#xFF1F; <a href="#rong-qi-nei-de-shu-ju-gai-bao-cun-zai-jing-xiang-li-huan-shi-wu-li-ji-li" class="header-anchor">#</a></h2><p>&#x5982;&#x679C;&#x6240;&#x8C13;&#x6570;&#x636E;&#x662F;&#x6307;&#x8FD0;&#x884C;&#x65F6;&#x52A8;&#x6001;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x90E8;&#x5206;&#x6570;&#x636E;&#x6587;&#x4EF6;&#x4E0D;&#x5E94;&#x8BE5;&#x4FDD;&#x5B58;&#x4E8E;&#x955C;&#x50CF;&#x5185;&#x3002;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x8981;&#x4FDD;&#x6301;&#x5BB9;&#x5668;&#x57FA;&#x7840;&#x6587;&#x4EF6;&#x4E0D;&#x53EF;&#x53D8;&#x7684;&#x7279;&#x6027;&#xFF0C;&#x800C;&#x53D8;&#x5316;&#x90E8;&#x5206;&#x4F7F;&#x7528;&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;&#xFF0C;&#x6216;&#x8005;&#x6570;&#x636E;&#x5377;&#x6765;&#x89E3;&#x51B3;&#x3002;</p>
<p>&#x5EFA;&#x8BAE;&#x770B;&#x4E00;&#x4E0B;&#x5B98;&#x7F51; <code>docker volume</code> &#x7684;&#x6587;&#x6863;&#xFF1A;<a href="https://docs.docker.com/engine/tutorials/dockervolumes/" target="_blank" rel="external">https://docs.docker.com/engine/tutorials/dockervolumes/</a></p>
<h2 id="kan-dao-zong-shuo-yao-bao-chi-rong-qi-wu-zhuang-tai-na-shi-me-shi-wu-zhuang-tai"><a href="#&#x770B;&#x5230;&#x603B;&#x8BF4;&#x8981;&#x4FDD;&#x6301;&#x5BB9;&#x5668;&#x65E0;&#x72B6;&#x6001;&#xFF0C;&#x90A3;&#x4EC0;&#x4E48;&#x662F;&#x65E0;&#x72B6;&#x6001;&#xFF1F;" class="headerlink" title="&#x770B;&#x5230;&#x603B;&#x8BF4;&#x8981;&#x4FDD;&#x6301;&#x5BB9;&#x5668;&#x65E0;&#x72B6;&#x6001;&#xFF0C;&#x90A3;&#x4EC0;&#x4E48;&#x662F;&#x65E0;&#x72B6;&#x6001;&#xFF1F;"></a>&#x770B;&#x5230;&#x603B;&#x8BF4;&#x8981;&#x4FDD;&#x6301;&#x5BB9;&#x5668;&#x65E0;&#x72B6;&#x6001;&#xFF0C;&#x90A3;&#x4EC0;&#x4E48;&#x662F;&#x65E0;&#x72B6;&#x6001;&#xFF1F; <a href="#kan-dao-zong-shuo-yao-bao-chi-rong-qi-wu-zhuang-tai-na-shi-me-shi-wu-zhuang-tai" class="header-anchor">#</a></h2><p>&#x8FD9;&#x91CC;&#x8BF4;&#x5230;&#x7684;&#x6709;&#x4E24;&#x4E2A;&#x5C42;&#x9762;&#x7684;&#x65E0;&#x72B6;&#x6001;&#xFF1A;</p>
<h3 id="rong-qi-cun-chu-ceng-de-wu-zhuang-tai"><a href="#&#x5BB9;&#x5668;&#x5B58;&#x50A8;&#x5C42;&#x7684;&#x65E0;&#x72B6;&#x6001;" class="headerlink" title="&#x5BB9;&#x5668;&#x5B58;&#x50A8;&#x5C42;&#x7684;&#x65E0;&#x72B6;&#x6001;"></a>&#x5BB9;&#x5668;&#x5B58;&#x50A8;&#x5C42;&#x7684;&#x65E0;&#x72B6;&#x6001; <a href="#rong-qi-cun-chu-ceng-de-wu-zhuang-tai" class="header-anchor">#</a></h3><p>&#x8FD9;&#x91CC;&#x63D0;&#x5230;&#x7684;&#x5B58;&#x50A8;&#x5C42;&#x662F;&#x6307;&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x955C;&#x50CF;&#x3001;&#x5BB9;&#x5668;&#x5404;&#x4E2A;&#x5C42;&#x7684;&#x5B58;&#x50A8;&#xFF0C;&#x4E00;&#x822C;&#x662F;<code>Union FS</code>&#xFF0C;&#x5982; <code>AUFS</code>&#xFF0C;&#x6216;&#x8005;&#x662F;&#x4F7F;&#x7528;&#x5757;&#x8BBE;&#x5907;&#x7684;&#x4E00;&#x4E9B;&#x673A;&#x5236;&#xFF08;&#x5982;<code>snapshot</code>&#xFF09;&#x8FDB;&#x884C;&#x6A21;&#x62DF;&#xFF0C;&#x5982; <code>devicemapper</code>&#x3002;</p>
<p>&#x5B58;&#x50A8;&#x5C42;&#x4E0D;&#x5E94;&#x8BE5;&#x6709;&#x4EFB;&#x4F55;&#x6587;&#x4EF6;&#x53D8;&#x5316;&#xFF0C;&#x6240;&#x6709;&#x53D8;&#x5316;&#x90E8;&#x5206;&#x7528;<code>&#x5377;</code>&#x8FDB;&#x884C;&#x6301;&#x4E45;&#x5316;&#x3002;&#x7531;&#x4E8E;&#x5377;&#x7684;&#x751F;&#x5B58;&#x5468;&#x671F;&#x548C;&#x5BB9;&#x5668;&#x4E0D;&#x540C;&#xFF0C;&#x5BB9;&#x5668;&#x6D88;&#x4EA1;&#x91CD;&#x5EFA;&#xFF0C;&#x5377;&#x4E0D;&#x4F1A;&#x8DDF;&#x968F;&#x6D88;&#x4EA1;&#x3002;&#x6240;&#x4EE5;&#x5BB9;&#x5668;&#x53EF;&#x4EE5;&#x968F;&#x4FBF;&#x5220;&#x4E86;&#x91CD;&#x65B0;<code>run</code>&#xFF0C;&#x800C;&#x5176;&#x6302;&#x8F7D;&#x7684;<code>&#x5377;</code>&#x5219;&#x4F1A;&#x4FDD;&#x6301;&#x4E4B;&#x524D;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<h3 id="fu-wu-ceng-mian-de-wu-zhuang-tai"><a href="#&#x670D;&#x52A1;&#x5C42;&#x9762;&#x7684;&#x65E0;&#x72B6;&#x6001;" class="headerlink" title="&#x670D;&#x52A1;&#x5C42;&#x9762;&#x7684;&#x65E0;&#x72B6;&#x6001;"></a>&#x670D;&#x52A1;&#x5C42;&#x9762;&#x7684;&#x65E0;&#x72B6;&#x6001; <a href="#fu-wu-ceng-mian-de-wu-zhuang-tai" class="header-anchor">#</a></h3><p>&#x4F7F;&#x7528;&#x5377;&#x6301;&#x4E45;&#x5316;&#x5BB9;&#x5668;&#x72B6;&#x6001;&#xFF0C;&#x867D;&#x7136;&#x4ECE;&#x5B58;&#x50A8;&#x5C42;&#x7684;&#x89D2;&#x5EA6;&#x770B;&#xFF0C;&#x662F;&#x65E0;&#x72B6;&#x6001;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x4ECE;&#x670D;&#x52A1;&#x5C42;&#x9762;&#x770B;&#xFF0C;&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#x662F;&#x6709;&#x72B6;&#x6001;&#x7684;&#x3002;</p>
<p>&#x4ECE;&#x670D;&#x52A1;&#x5C42;&#x9762;&#x4E0A;&#x8BF4;&#xFF0C;&#x4E5F;&#x5B58;&#x5728;&#x65E0;&#x72B6;&#x6001;&#x670D;&#x52A1;&#x3002;&#x5C31;&#x662F;&#x8BF4;&#x670D;&#x52A1;&#x672C;&#x8EAB;&#x4E0D;&#x9700;&#x8981;&#x5199;&#x5165;&#x4EFB;&#x4F55;&#x6587;&#x4EF6;&#x3002;&#x6BD4;&#x5982;&#x524D;&#x7AEF; <code>nginx</code>&#xFF0C;&#x5B83;&#x4E0D;&#x9700;&#x8981;&#x5199;&#x5165;&#x4EFB;&#x4F55;&#x6587;&#x4EF6;&#xFF08;&#x65E5;&#x5FD7;&#x8D70;Docker&#x65E5;&#x5FD7;&#x9A71;&#x52A8;&#xFF09;&#xFF0C;&#x4E2D;&#x95F4;&#x7684; <code>php</code>, <code>node.js</code> &#x7B49;&#x670D;&#x52A1;&#xFF0C;&#x53EF;&#x80FD;&#x4E5F;&#x4E0D;&#x9700;&#x8981;&#x672C;&#x5730;&#x5B58;&#x50A8;&#xFF0C;&#x5B83;&#x4EEC;&#x6240;&#x9700;&#x7684;&#x6570;&#x636E;&#x90FD;&#x5728; <code>redis</code>, <code>mysql</code>, <code>mongodb</code> &#x4E2D;&#x4E86;&#x3002;&#x8FD9;&#x7C7B;&#x670D;&#x52A1;&#xFF0C;&#x7531;&#x4E8E;&#x4E0D;&#x9700;&#x8981;&#x5377;&#xFF0C;&#x4E5F;&#x4E0D;&#x53D1;&#x751F;&#x672C;&#x5730;&#x5199;&#x64CD;&#x4F5C;&#xFF0C;&#x5220;&#x9664;&#x3001;&#x91CD;&#x542F;&#x3001;&#x4E0D;&#x4FDD;&#x5B58;&#x81EA;&#x8EAB;&#x72B6;&#x6001;&#xFF0C;&#x5E76;&#x4E0D;&#x5F71;&#x54CD;&#x670D;&#x52A1;&#x8FD0;&#x884C;&#xFF0C;&#x5B83;&#x4EEC;&#x90FD;&#x662F;<code>&#x65E0;&#x72B6;&#x6001;&#x670D;&#x52A1;</code>&#x3002;&#x8FD9;&#x7C7B;&#x670D;&#x52A1;&#x7531;&#x4E8E;&#x4E0D;&#x9700;&#x8981;&#x72B6;&#x6001;&#x8FC1;&#x79FB;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x5206;&#x5E03;&#x5F0F;&#x5B58;&#x50A8;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x4EEC;&#x7684;&#x96C6;&#x7FA4;&#x8C03;&#x5EA6;&#x66F4;&#x65B9;&#x4FBF;&#x3002;</p>
<p>&#x4E4B;&#x524D;&#x6CA1;&#x6709; <code>docker volume</code> &#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6709;&#x4E9B;&#x4EBA;&#x8BF4; Docker &#x53EA;&#x53EF;&#x4EE5;&#x652F;&#x6301;&#x65E0;&#x72B6;&#x6001;&#x670D;&#x52A1;&#xFF0C;&#x539F;&#x56E0;&#x5C31;&#x662F;&#x53EA;&#x770B;&#x5230;&#x4E86;&#x5B58;&#x50A8;&#x5C42;&#x9700;&#x6C42;&#x65E0;&#x72B6;&#x6001;&#xFF0C;&#x800C;&#x6CA1;&#x6709; <code>docker volume</code> &#x7684;&#x6301;&#x4E45;&#x5316;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x8FD9;&#x4E2A;&#x8BF4;&#x6CD5;&#x5DF2;&#x7ECF;&#x4E0D;&#x6210;&#x7ACB;&#xFF0C;&#x670D;&#x52A1;&#x53EF;&#x4EE5;&#x6709;&#x72B6;&#x6001;&#xFF0C;&#x72B6;&#x6001;&#x6301;&#x4E45;&#x5316;&#x7528; <code>docker volume</code>&#x3002;</p>
<p>&#x5F53;&#x670D;&#x52A1;&#x53EF;&#x4EE5;&#x6709;&#x72B6;&#x6001;&#x540E;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x7684;<code>local</code>&#x5377;&#x9A71;&#x52A8;&#xFF0C;&#x5E76;&#x4E14;&#x4F7F;&#x7528;<code>&#x672C;&#x5730;&#x5B58;&#x50A8;</code>&#x8FDB;&#x884C;&#x72B6;&#x6001;&#x6301;&#x4E45;&#x5316;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x5355;&#x673A;&#x670D;&#x52A1;&#x3001;&#x5BB9;&#x5668;&#x7684;&#x518D;&#x8C03;&#x5EA6;&#x8FD0;&#x884C;&#x6CA1;&#x6709;&#x95EE;&#x9898;&#x3002;&#x4F46;&#x662F;&#x987E;&#x540D;&#x601D;&#x4E49;&#xFF0C;&#x4F7F;&#x7528;<code>&#x672C;&#x5730;&#x5B58;&#x50A8;</code>&#x7684;&#x5377;&#xFF0C;&#x53EA;&#x53EF;&#x4EE5;&#x4E3A;&#x5F53;&#x524D;&#x4E3B;&#x673A;&#x63D0;&#x4F9B;&#x6301;&#x4E45;&#x5316;&#x7684;&#x5B58;&#x50A8;&#xFF0C;&#x800C;&#x65E0;&#x6CD5;&#x8DE8;&#x4E3B;&#x673A;&#x3002;</p>
<p>&#x4F46;&#x8FD9;&#x53EA;&#x662F;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x7684; <code>local</code> &#x9A71;&#x52A8;&#xFF0C;&#x5E76;&#x4E14;&#x4F7F;&#x7528; <code>&#x672C;&#x5730;&#x5B58;&#x50A8;</code> &#x800C;&#x5DF2;&#x3002;&#x4F7F;&#x7528;&#x5206;&#x5E03;&#x5F0F;/&#x5171;&#x4EAB;&#x5B58;&#x50A8;&#x5C31;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x8DE8;&#x4E3B;&#x673A;&#x7684;&#x95EE;&#x9898;&#x3002;<code>docker volume</code> &#x81EA;&#x7136;&#x652F;&#x6301;&#x5F88;&#x591A;&#x5206;&#x5E03;&#x5F0F;&#x5B58;&#x50A8;&#x7684;&#x9A71;&#x52A8;&#xFF0C;&#x6BD4;&#x5982; <code>flocker</code>&#x3001;<code>glusterfs</code>&#x3001;<code>ceph</code>&#x3001;<code>ipfs</code> &#x7B49;&#x7B49;&#x3002;&#x5E38;&#x7528;&#x7684;&#x63D2;&#x4EF6;&#x5217;&#x8868;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x5B98;&#x65B9;&#x6587;&#x6863;&#xFF1A;<a href="https://docs.docker.com/engine/extend/legacy_plugins/#/volume-plugins" target="_blank" rel="external">https://docs.docker.com/engine/extend/legacy_plugins/#/volume-plugins</a></p>
<h2 id="dockerfile-zhong-de-volume-he-docker-run-v-yi-ji-compose-zhong-de-volumes-du-you-shi-me-qu-bie"><a href="#Dockerfile-&#x4E2D;&#x7684;VOLUME&#x548C;docker-run-v&#xFF0C;&#x4EE5;&#x53CA;Compose&#x4E2D;&#x7684;volumes&#x90FD;&#x6709;&#x4EC0;&#x4E48;&#x533A;&#x522B;&#xFF1F;" class="headerlink" title="Dockerfile &#x4E2D;&#x7684;VOLUME&#x548C;docker run -v&#xFF0C;&#x4EE5;&#x53CA;Compose&#x4E2D;&#x7684;volumes&#x90FD;&#x6709;&#x4EC0;&#x4E48;&#x533A;&#x522B;&#xFF1F;"></a><code>Dockerfile</code> &#x4E2D;&#x7684;<code>VOLUME</code>&#x548C;<code>docker run -v</code>&#xFF0C;&#x4EE5;&#x53CA;<code>Compose</code>&#x4E2D;&#x7684;<code>volumes</code>&#x90FD;&#x6709;&#x4EC0;&#x4E48;&#x533A;&#x522B;&#xFF1F; <a href="#dockerfile-zhong-de-volume-he-docker-run-v-yi-ji-compose-zhong-de-volumes-du-you-shi-me-qu-bie" class="header-anchor">#</a></h2><p>&#x5148;&#x660E;&#x767D;&#x51E0;&#x4E2A;&#x6982;&#x5FF5;&#xFF0C;&#x6302;&#x8F7D;&#x5206;&#x4E3A;<code>&#x6302;&#x8F7D;&#x672C;&#x5730;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;</code>&#xFF0C;&#x6216;&#x8005;<code>&#x6302;&#x8F7D;&#x6570;&#x636E;&#x5377;</code>&#xFF0C;&#x800C;<code>&#x6570;&#x636E;&#x5377;</code>&#x53C8;&#x5206;&#x4E3A;<code>&#x533F;&#x540D;&#x6570;&#x636E;&#x5377;</code>&#x548C;<code>&#x547D;&#x540D;&#x6570;&#x636E;&#x5377;</code>&#x3002;</p>
<p>&#x90A3;&#x4E48;&#xFF0C;&#x5728;<code>Dockerfile</code>&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x662F;&#x6302;&#x8F7D;&#x662F;&#x6307;<code>&#x533F;&#x540D;&#x6570;&#x636E;&#x5377;</code>&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x8BBE;&#x7F6E;&#x53EF;&#x4EE5;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x8986;&#x76D6;&#x3002;&#x901A;&#x8FC7; <code>docker run</code> &#x7684; <code>-v</code> &#x53C2;&#x6570;&#x6216;&#x8005; <code>docker-compose.yml</code> &#x7684; <code>volumes</code> &#x6307;&#x5B9A;&#x3002;&#x4F7F;&#x7528;<code>&#x547D;&#x540D;&#x5377;</code>&#x7684;&#x597D;&#x5904;&#x662F;&#x53EF;&#x4EE5;&#x590D;&#x7528;&#xFF0C;&#x5176;&#x5B83;&#x5BB9;&#x5668;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;<code>&#x547D;&#x540D;&#x6570;&#x636E;&#x5377;</code>&#x7684;&#x540D;&#x5B57;&#x6765;&#x6307;&#x5B9A;&#x6302;&#x8F7D;&#xFF0C;&#x5171;&#x4EAB;&#x5176;&#x5185;&#x5BB9;&#xFF08;&#x4E0D;&#x8FC7;&#x8981;&#x6CE8;&#x610F;&#x5E76;&#x53D1;&#x8BBF;&#x95EE;&#x7684;&#x7ADE;&#x4E89;&#x95EE;&#x9898;&#xFF09;&#x3002;</p>
<p>&#x6570;&#x636E;&#x5377;&#x9ED8;&#x8BA4;&#x53EF;&#x80FD;&#x4F1A;&#x4FDD;&#x5B58;&#x4E8E; <code>/var/lib/docker/volumes</code>&#xFF0C;&#x4E0D;&#x8FC7;&#x4E00;&#x822C;&#x4E0D;&#x9700;&#x8981;&#x3001;&#x4E5F;&#x4E0D;&#x5E94;&#x8BE5;&#x8BBF;&#x95EE;&#x8FD9;&#x4E2A;&#x4F4D;&#x7F6E;&#x3002;</p>
<h2 id="duo-ge-docker-rong-qi-zhi-jian-gong-xiang-shu-ju-zen-me-ban-nfs"><a href="#&#x591A;&#x4E2A;-Docker-&#x5BB9;&#x5668;&#x4E4B;&#x95F4;&#x5171;&#x4EAB;&#x6570;&#x636E;&#x600E;&#x4E48;&#x529E;&#xFF1F;NFS&#xFF1F;" class="headerlink" title="&#x591A;&#x4E2A; Docker &#x5BB9;&#x5668;&#x4E4B;&#x95F4;&#x5171;&#x4EAB;&#x6570;&#x636E;&#x600E;&#x4E48;&#x529E;&#xFF1F;NFS&#xFF1F;"></a>&#x591A;&#x4E2A; Docker &#x5BB9;&#x5668;&#x4E4B;&#x95F4;&#x5171;&#x4EAB;&#x6570;&#x636E;&#x600E;&#x4E48;&#x529E;&#xFF1F;NFS&#xFF1F; <a href="#duo-ge-docker-rong-qi-zhi-jian-gong-xiang-shu-ju-zen-me-ban-nfs" class="header-anchor">#</a></h2><p>&#x5982;&#x679C;&#x662F;&#x540C;&#x4E00;&#x4E2A;&#x5BBF;&#x4E3B;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x7ED1;&#x5B9A;&#x540C;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5377;&#xFF0C;&#x5F53;&#x7136;&#xFF0C;&#x7A0B;&#x5E8F;&#x4E0A;&#x8981;&#x5904;&#x7406;&#x597D;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x5982;&#x679C;&#x662F;&#x4E0D;&#x540C;&#x5BBF;&#x4E3B;&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5206;&#x5E03;&#x5F0F;&#x6570;&#x636E;&#x5377;&#x9A71;&#x52A8;&#xFF0C;&#x8BA9;&#x5206;&#x5E03;&#x5728;&#x4E0D;&#x540C;&#x5BBF;&#x4E3B;&#x7684;&#x5BB9;&#x5668;&#x90FD;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x5230;&#x7684;&#x5206;&#x5E03;&#x5F0F;&#x5B58;&#x50A8;&#x7684;&#x4F4D;&#x7F6E;&#x3002;&#x5982;S3&#x4E4B;&#x7C7B;&#xFF1A;</p>
<p><a href="https://docs.docker.com/engine/extend/plugins/#volume-plugins" target="_blank" rel="external">https://docs.docker.com/engine/extend/plugins/#volume-plugins</a></p>
<h2 id="ji-ran-yi-ge-rong-qi-yi-ge-ying-yong-na-me-wo-xiang-zai-gai-rong-qi-zhong-yong-ji-hua-ren-wu-cron-zen-me-ban"><a href="#&#x65E2;&#x7136;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x60F3;&#x5728;&#x8BE5;&#x5BB9;&#x5668;&#x4E2D;&#x7528;&#x8BA1;&#x5212;&#x4EFB;&#x52A1;-cron-&#x600E;&#x4E48;&#x529E;&#xFF1F;" class="headerlink" title="&#x65E2;&#x7136;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x60F3;&#x5728;&#x8BE5;&#x5BB9;&#x5668;&#x4E2D;&#x7528;&#x8BA1;&#x5212;&#x4EFB;&#x52A1; cron &#x600E;&#x4E48;&#x529E;&#xFF1F;"></a>&#x65E2;&#x7136;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x60F3;&#x5728;&#x8BE5;&#x5BB9;&#x5668;&#x4E2D;&#x7528;&#x8BA1;&#x5212;&#x4EFB;&#x52A1; cron &#x600E;&#x4E48;&#x529E;&#xFF1F; <a href="#ji-ran-yi-ge-rong-qi-yi-ge-ying-yong-na-me-wo-xiang-zai-gai-rong-qi-zhong-yong-ji-hua-ren-wu-cron-zen-me-ban" class="header-anchor">#</a></h2><p><code>cron</code> &#x5176;&#x5B9E;&#x662F;&#x53E6;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x5E94;&#x8BE5;&#x53E6;&#x8D77;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#x6765;&#x8FDB;&#x884C;&#xFF0C;&#x5982;&#x9700;&#x8BBF;&#x95EE;&#x8BE5;&#x5E94;&#x7528;&#x7684;&#x6570;&#x636E;&#x6587;&#x4EF6;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x5171;&#x4EAB;&#x8BE5;&#x5E94;&#x7528;&#x7684;&#x6570;&#x636E;&#x5377;&#x5373;&#x53EF;&#x3002;&#x800C; cron &#x7684;&#x5BB9;&#x5668;&#x4E2D;&#xFF0C;cron &#x4EE5;&#x524D;&#x53F0;&#x8FD0;&#x884C;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#xFF0C;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x6709;&#x4E2A; python &#x811A;&#x672C;&#x53EF;&#x4EE5;&#x5B9A;&#x65F6;&#x6267;&#x884C;&#x3002;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x6784;&#x5EFA;&#x8FD9;&#x4E2A;&#x5BB9;&#x5668;&#x3002;</p>
<p>&#x9996;&#x5148;&#x57FA;&#x4E8E; python &#x7684;&#x955C;&#x50CF;&#x5B9A;&#x5236;&#xFF1A;</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">FROM</span> python:<span class="number">3.5</span>.<span class="number">2</span></div><div class="line"></div><div class="line"><span class="keyword">ENV</span> TZ=Asia/Shanghai</div><div class="line"></div><div class="line"><span class="keyword">RUN</span><span class="bash"> apt-get update \</span></div><div class="line">    &amp;&amp; apt-get install -y cron \</div><div class="line">    &amp;&amp; apt-get autoremove -y</div><div class="line"></div><div class="line"><span class="keyword">COPY</span><span class="bash"> ./cronpy /etc/cron.d/cronpy</span></div><div class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">&quot;cron&quot;</span>, <span class="string">&quot;-f&quot;</span>]</span></div></pre></td></tr></table></figure>
<p>&#x5176;&#x4E2D;&#x6240;&#x63D0;&#x53CA;&#x7684; <code>cronpy</code> &#x5C31;&#x662F;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x8BA1;&#x5212;&#x6267;&#x884C;&#x7684;cron&#x811A;&#x672C;&#x3002;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">* * * * * root /app/task.py &gt;&gt; /var/<span class="built_in">log</span>/task.log 2&gt;&amp;1</div></pre></td></tr></table></figure>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x8BA1;&#x5212;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x5B9A;&#x65F6;&#x6267;&#x884C; <code>/app/task.py</code> &#x6587;&#x4EF6;&#xFF0C;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x5728; <code>/var/log/task.log</code> &#x4E2D;&#x3002;&#x8FD9;&#x4E2A; <code>task.py</code> &#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x7B80;&#x5355;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x5176;&#x5185;&#x5BB9;&#x53EA;&#x662F;&#x8F93;&#x51FA;&#x4E2A;&#x65F6;&#x95F4;&#x800C;&#x5DF2;&#x3002;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/local/bin/python</span></div><div class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</div><div class="line">print(<span class="string">&quot;Cron job has run at {0} with environment variable &quot;</span>.format(str(datetime.now())))</div></pre></td></tr></table></figure>
<p>&#x8FD9; <code>task.py</code> &#x53EF;&#x4EE5;&#x5728;&#x6784;&#x5EFA;&#x955C;&#x50CF;&#x65F6;&#x653E;&#x8FDB;&#x53BB;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;&#x3002;&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EE5;&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;&#x4E3E;&#x4F8B;&#x3002;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># &#x6784;&#x5EFA;&#x955C;&#x50CF;</span></div><div class="line">docker build -t cronjob:latest .</div><div class="line"></div><div class="line"><span class="comment"># &#x8FD0;&#x884C;&#x955C;&#x50CF;</span></div><div class="line">docker run \</div><div class="line">    --name cronjob \</div><div class="line">    <span class="_">-d</span> \</div><div class="line">    -v $(<span class="built_in">pwd</span>)/task.py:/app/task.py \</div><div class="line">    -v $(<span class="built_in">pwd</span>)/<span class="built_in">log</span>/:/var/<span class="built_in">log</span>/ \</div><div class="line">    cronjob:latest</div></pre></td></tr></table></figure>
<p>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x5E94;&#x8BE5;&#x5728;&#x6784;&#x5EFA;&#x4E3B;&#x673A;&#x4E0A;&#x8D4B;&#x4E88; <code>task.py</code> &#x6587;&#x4EF6;&#x53EF;&#x6267;&#x884C;&#x6743;&#x9650;&#x3002;</p>
<h2 id="docker-pull-xia-lai-de-jing-xiang-wen-jian-du-zai-na"><a href="#docker-pull-&#x4E0B;&#x6765;&#x7684;&#x955C;&#x50CF;&#x6587;&#x4EF6;&#x90FD;&#x5728;&#x54EA;&#xFF1F;" class="headerlink" title="docker pull &#x4E0B;&#x6765;&#x7684;&#x955C;&#x50CF;&#x6587;&#x4EF6;&#x90FD;&#x5728;&#x54EA;&#xFF1F;"></a><code>docker pull</code> &#x4E0B;&#x6765;&#x7684;&#x955C;&#x50CF;&#x6587;&#x4EF6;&#x90FD;&#x5728;&#x54EA;&#xFF1F; <a href="#docker-pull-xia-lai-de-jing-xiang-wen-jian-du-zai-na" class="header-anchor">#</a></h2><p>&#x521D;&#x5B66; Docker &#x8981;&#x53CD;&#x590D;&#x544A;&#x8BEB;&#x81EA;&#x5DF1;&#xFF0C;Docker &#x4E0D;&#x662F;&#x865A;&#x62DF;&#x673A;&#x3002;</p>
<p>Docker&#x4E0D;&#x662F;&#x865A;&#x62DF;&#x673A;&#xFF0C;Docker &#x955C;&#x50CF;&#x4E5F;&#x4E0D;&#x662F;&#x865A;&#x62DF;&#x673A;&#x7684; ISO &#x6587;&#x4EF6;&#x3002;Docker &#x7684;&#x955C;&#x50CF;&#x662F;&#x5206;&#x5C42;&#x5B58;&#x50A8;&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A;&#x955C;&#x50CF;&#x90FD;&#x662F;&#x7531;&#x5F88;&#x591A;&#x5C42;&#xFF0C;&#x5F88;&#x591A;&#x4E2A;&#x6587;&#x4EF6;&#x7EC4;&#x6210;&#x3002;&#x800C;&#x4E0D;&#x540C;&#x7684;&#x955C;&#x50CF;&#x662F;&#x5171;&#x4EAB;&#x76F8;&#x540C;&#x7684;&#x5C42;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x6811;&#x5F62;&#x7ED3;&#x6784;&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#x5177;&#x4F53;&#x54EA;&#x4E2A;&#x6587;&#x4EF6;&#x662F; <code>pull</code> &#x4E0B;&#x6765;&#x7684;&#x955C;&#x50CF;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x5177;&#x4F53;&#x955C;&#x50CF;&#x4FDD;&#x5B58;&#x4F4D;&#x7F6E;&#x53D6;&#x51B3;&#x4E8E;&#x7CFB;&#x7EDF;&#xFF0C;&#x4E00;&#x822C;<code>Linux</code>&#x7CFB;&#x7EDF;&#x4E0B;&#xFF0C;&#x5728; <code>/var/lib/docker</code> &#x91CC;&#x3002;&#x5BF9;&#x4E8E;&#x4F7F;&#x7528; <code>Union FS</code> &#x7684;&#x7CFB;&#x7EDF;(<code>Ubuntu</code>)&#xFF0C;&#x5982; <code>aufs</code>, <code>overlay2</code> &#x7B49;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5728; <code>/var/lib/docker/{aufs,overlay2}</code> &#x4E0B;&#x770B;&#x5230;&#x627E;&#x5230;&#x5404;&#x4E2A;&#x955C;&#x50CF;&#x7684;&#x5C42;&#x3001;&#x5BB9;&#x5668;&#x7684;&#x5C42;&#xFF0C;&#x4EE5;&#x53CA;&#x5176;&#x4E2D;&#x7684;&#x5185;&#x5BB9;&#x3002;</p>
<p>&#x4F46;&#x662F;&#xFF0C;&#x5BF9;&#x4E8E;<code>CentOS</code>&#x8FD9;&#x7C7B;&#x6CA1;&#x6709;<code>Union FS</code>&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x4F1A;&#x4F7F;&#x7528;&#x5982;<code>devicemapper</code>&#x8FD9;&#x7C7B;&#x4E1C;&#x897F;&#x7684;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x529F;&#x80FD;(&#x5982;<code>snapshot</code>)&#x6A21;&#x62DF;&#xFF0C;&#x955C;&#x50CF;&#x4F1A;&#x5B58;&#x50A8;&#x4E8E;&#x5757;&#x8BBE;&#x5907;&#x91CC;&#xFF0C;&#x56E0;&#x6B64;&#x65E0;&#x6CD5;&#x770B;&#x5230;&#x5177;&#x4F53;&#x6BCF;&#x5C42;&#x4FE1;&#x606F;&#x4EE5;&#x53CA;&#x6BCF;&#x5C42;&#x91CC;&#x9762;&#x7684;&#x5185;&#x5BB9;&#x3002;</p>
<p>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;<code>CentOS/RHEL</code> &#x4F7F;&#x7528; <code>lvm-loop</code>&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x672C;&#x5730;&#x7A00;&#x758F;&#x6587;&#x4EF6;&#x6A21;&#x62DF;&#x5757;&#x8BBE;&#x5907;&#xFF0C;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x4F1A;&#x4F4D;&#x4E8E; <code>/var/lib/docker/devicemapper/devicemapper/data</code> &#x7684;&#x4F4D;&#x7F6E;&#x3002;&#x8FD9;&#x662F;&#x975E;&#x5E38;&#x4E0D;&#x63A8;&#x8350;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x53D1;&#x73B0;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5F88;&#x5927;&#xFF0C;&#x90A3;&#x5C31;&#x8BF4;&#x660E;&#x4F60;&#x5728;&#x7528; <code>devicemapper + loop</code> &#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x4E0D;&#x8981;&#x8FD9;&#x4E48;&#x505A;&#xFF0C;&#x53BB;&#x53C2;&#x7167;&#x5B98;&#x65B9;&#x6587;&#x6863;&#xFF0C;&#x6362; <code>direct-lvm</code>&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5206;&#x914D;&#x771F;&#x6B63;&#x7684;&#x5757;&#x8BBE;&#x5907;&#x7ED9; <code>devicemapper</code> &#x53BB;&#x7528;&#x3002;</p>
<h2 id="docker-images-ming-ling-xian-shi-de-jing-xiang-zhan-liao-hao-da-de-kong-jian-zen-me-ban-mei-ci-du-shi-xia-zai-zhe-me-da-de-jing-xiang"><a href="#docker-images-&#x547D;&#x4EE4;&#x663E;&#x793A;&#x7684;&#x955C;&#x50CF;&#x5360;&#x4E86;&#x597D;&#x5927;&#x7684;&#x7A7A;&#x95F4;&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F;&#x6BCF;&#x6B21;&#x90FD;&#x662F;&#x4E0B;&#x8F7D;&#x8FD9;&#x4E48;&#x5927;&#x7684;&#x955C;&#x50CF;&#xFF1F;" class="headerlink" title="docker images &#x547D;&#x4EE4;&#x663E;&#x793A;&#x7684;&#x955C;&#x50CF;&#x5360;&#x4E86;&#x597D;&#x5927;&#x7684;&#x7A7A;&#x95F4;&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F;&#x6BCF;&#x6B21;&#x90FD;&#x662F;&#x4E0B;&#x8F7D;&#x8FD9;&#x4E48;&#x5927;&#x7684;&#x955C;&#x50CF;&#xFF1F;"></a><code>docker images</code> &#x547D;&#x4EE4;&#x663E;&#x793A;&#x7684;&#x955C;&#x50CF;&#x5360;&#x4E86;&#x597D;&#x5927;&#x7684;&#x7A7A;&#x95F4;&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F;&#x6BCF;&#x6B21;&#x90FD;&#x662F;&#x4E0B;&#x8F7D;&#x8FD9;&#x4E48;&#x5927;&#x7684;&#x955C;&#x50CF;&#xFF1F; <a href="#docker-images-ming-ling-xian-shi-de-jing-xiang-zhan-liao-hao-da-de-kong-jian-zen-me-ban-mei-ci-du-shi-xia-zai-zhe-me-da-de-jing-xiang" class="header-anchor">#</a></h2><p>&#x8FD9;&#x4E2A;&#x663E;&#x793A;&#x7684;&#x5927;&#x5C0F;&#x662F;&#x8BA1;&#x7B97;&#x540E;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x8981;&#x77E5;&#x9053; docker image &#x662F;&#x5206;&#x5C42;&#x5B58;&#x50A8;&#x7684;&#xFF0C;&#x5728;<code>1.10</code>&#x4E4B;&#x524D;&#xFF0C;&#x4E0D;&#x540C;&#x955C;&#x50CF;&#x65E0;&#x6CD5;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x5C42;&#xFF0C;&#x6240;&#x4EE5;&#x57FA;&#x672C;&#x4E0A;&#x786E;&#x5B9E;&#x662F;&#x4E0B;&#x8F7D;&#x5927;&#x5C0F;&#x3002;&#x4F46;&#x662F;&#x4ECE;<code>1.10</code>&#x4E4B;&#x540E;&#xFF0C;&#x5DF2;&#x6709;&#x7684;&#x5C42;&#xFF08;&#x901A;&#x8FC7;<code>SHA256</code>&#x6765;&#x5224;&#x65AD;&#xFF09;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x518D;&#x4E0B;&#x8F7D;&#x3002;&#x53EA;&#x9700;&#x8981;&#x4E0B;&#x8F7D;&#x53D8;&#x5316;&#x7684;&#x5C42;&#x3002;&#x6240;&#x4EE5;&#x5B9E;&#x9645;&#x4E0B;&#x8F7D;&#x5927;&#x5C0F;&#x6BD4;&#x8FD9;&#x4E2A;&#x6570;&#x503C;&#x8981;&#x5C0F;&#x3002;&#x800C;&#x4E14;&#x672C;&#x5730;&#x786C;&#x76D8;&#x7A7A;&#x95F4;&#x5360;&#x7528;&#xFF0C;&#x4E5F;&#x6BD4;<code>docker images</code>&#x5217;&#x51FA;&#x6765;&#x7684;&#x4E1C;&#x897F;&#x52A0;&#x8D77;&#x6765;&#x5C0F;&#x5F88;&#x591A;&#xFF0C;&#x5F88;&#x591A;&#x91CD;&#x590D;&#x7684;&#x90E8;&#x5206;&#x5171;&#x4EAB;&#x4E86;&#x3002;</p>
<h2 id="docker-images-a-hou-xian-shi-liao-hao-duo-none-de-jing-xiang-du-shi-shi-me-ya-neng-shan-me"><a href="#docker-images-a-&#x540E;&#x663E;&#x793A;&#x4E86;&#x597D;&#x591A;-lt-none-gt-&#x7684;&#x955C;&#x50CF;&#xFF1F;&#x90FD;&#x662F;&#x4EC0;&#x4E48;&#x5440;&#xFF1F;&#x80FD;&#x5220;&#x4E48;&#xFF1F;" class="headerlink" title="docker images -a &#x540E;&#x663E;&#x793A;&#x4E86;&#x597D;&#x591A; &lt;none&gt; &#x7684;&#x955C;&#x50CF;&#xFF1F;&#x90FD;&#x662F;&#x4EC0;&#x4E48;&#x5440;&#xFF1F;&#x80FD;&#x5220;&#x4E48;&#xFF1F;"></a><code>docker images -a</code> &#x540E;&#x663E;&#x793A;&#x4E86;&#x597D;&#x591A; <code>&lt;none&gt;</code> &#x7684;&#x955C;&#x50CF;&#xFF1F;&#x90FD;&#x662F;&#x4EC0;&#x4E48;&#x5440;&#xFF1F;&#x80FD;&#x5220;&#x4E48;&#xFF1F; <a href="#docker-images-a-hou-xian-shi-liao-hao-duo-none-de-jing-xiang-du-shi-shi-me-ya-neng-shan-me" class="header-anchor">#</a></h2><p>&#x7B80;&#x5355;&#x6765;&#x8BF4;&#xFF0C;<code>&lt;none&gt;</code> &#x5C31;&#x662F;&#x8BF4;&#x8BE5;&#x955C;&#x50CF;&#x6CA1;&#x6709;&#x6253;&#x6807;&#x7B7E;&#x3002;&#x800C;&#x6CA1;&#x6709;&#x6253;&#x6807;&#x7B7E;&#x955C;&#x50CF;&#x4E00;&#x822C;&#x5206;&#x4E3A;&#x4E24;&#x7C7B;&#xFF0C;&#x4E00;&#x7C7B;&#x662F;<strong>&#x4F9D;&#x8D56;&#x955C;&#x50CF;</strong>&#xFF0C;&#x4E00;&#x7C7B;&#x662F;<strong>&#x4E22;&#x4E86;&#x6807;&#x7B7E;&#x7684;&#x955C;&#x50CF;</strong>&#x3002;</p>
<h3 id="yi-lai-jing-xiang"><a href="#&#x4F9D;&#x8D56;&#x955C;&#x50CF;" class="headerlink" title="&#x4F9D;&#x8D56;&#x955C;&#x50CF;"></a>&#x4F9D;&#x8D56;&#x955C;&#x50CF; <a href="#yi-lai-jing-xiang" class="header-anchor">#</a></h3><p>Docker&#x7684;&#x955C;&#x50CF;&#x3001;&#x5BB9;&#x5668;&#x7684;&#x5B58;&#x50A8;&#x5C42;&#x662F;Union FS&#xFF0C;&#x5206;&#x5C42;&#x5B58;&#x50A8;&#x7ED3;&#x6784;&#x3002;&#x6240;&#x4EE5;&#x4EFB;&#x4F55;&#x955C;&#x50CF;&#x9664;&#x4E86;&#x6700;&#x4E0A;&#x9762;&#x4E00;&#x5C42;&#x6253;&#x4E0A;&#x6807;&#x7B7E;(tag)&#x5916;&#xFF0C;&#x5176;&#x5B83;&#x4E0B;&#x9762;&#x4F9D;&#x8D56;&#x7684;&#x4E00;&#x5C42;&#x5C42;&#x5B58;&#x50A8;&#x4E5F;&#x662F;&#x5B58;&#x5728;&#x7684;&#x3002;&#x8FD9;&#x4E9B;&#x955C;&#x50CF;&#x6CA1;&#x6709;&#x6253;&#x4E0A;&#x4EFB;&#x4F55;&#x6807;&#x7B7E;&#xFF0C;&#x6240;&#x4EE5;&#x5728; <code>docker images -a</code> &#x7684;&#x65F6;&#x5019;&#x4F1A;&#x4EE5; <code>&lt;none&gt;</code> &#x7684;&#x5F62;&#x5F0F;&#x663E;&#x793A;&#x3002;&#x6CE8;&#x610F;&#x89C2;&#x5BDF;&#x4E00;&#x4E0B; <code>docker pull</code> &#x7684;&#x6BCF;&#x4E00;&#x5C42;&#x7684;<code>sha256</code>&#x7684;&#x6821;&#x9A8C;&#x503C;&#xFF0C;&#x7136;&#x540E;&#x5BF9;&#x6BD4;&#x4E00;&#x4E0B; <code>&lt;none&gt;</code> &#x4E2D;&#x7684;&#x76F8;&#x540C;&#x6821;&#x9A8C;&#x503C;&#x7684;&#x955C;&#x50CF;&#xFF0C;&#x5B83;&#x4EEC;&#x5C31;&#x662F;&#x4F9D;&#x8D56;&#x955C;&#x50CF;&#x3002;&#x8FD9;&#x4E9B;&#x955C;&#x50CF;<strong>&#x4E0D;&#x5E94;&#x5F53;&#x88AB;&#x5220;&#x9664;</strong>&#xFF0C;&#x56E0;&#x4E3A;&#x6709;&#x6807;&#x7B7E;&#x955C;&#x50CF;&#x5728;&#x4F9D;&#x8D56;&#x5B83;&#x4EEC;&#x3002;</p>
<h3 id="diu-liao-biao-qian-de-jing-xiang"><a href="#&#x4E22;&#x4E86;&#x6807;&#x7B7E;&#x7684;&#x955C;&#x50CF;" class="headerlink" title="&#x4E22;&#x4E86;&#x6807;&#x7B7E;&#x7684;&#x955C;&#x50CF;"></a>&#x4E22;&#x4E86;&#x6807;&#x7B7E;&#x7684;&#x955C;&#x50CF; <a href="#diu-liao-biao-qian-de-jing-xiang" class="header-anchor">#</a></h3><p>&#x8FD9;&#x7C7B;&#x955C;&#x50CF;&#x53EF;&#x80FD;&#x672C;&#x6765;&#x6709;&#x6807;&#x7B7E;&#xFF0C;&#x540E;&#x6765;&#x4E22;&#x4E86;&#x3002;&#x539F;&#x56E0;&#x53EF;&#x80FD;&#x5F88;&#x591A;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;</p>
<ul>
<li><code>docker pull</code> &#x4E86;&#x4E00;&#x4E2A;&#x540C;&#x6837;&#x6807;&#x7B7E;&#x4F46;&#x662F;&#x65B0;&#x7248;&#x672C;&#x7684;&#x955C;&#x50CF;&#xFF0C;&#x4E8E;&#x662F;&#x8BE5;&#x6807;&#x7B7E;&#x4ECE;&#x65E7;&#x7248;&#x672C;&#x7684;&#x955C;&#x50CF;&#x8F6C;&#x79FB;&#x5230;&#x4E86;&#x65B0;&#x7248;&#x672C;&#x955C;&#x50CF;&#x4E0A;&#xFF0C;&#x90A3;&#x4E48;&#x65E7;&#x7248;&#x672C;&#x7684;&#x955C;&#x50CF;&#x4E0A;&#x7684;&#x6807;&#x7B7E;&#x5C31;&#x4E22;&#x4E86;&#xFF1B;</li>
<li><code>docker build</code> &#x65F6;&#x6307;&#x5B9A;&#x7684;&#x6807;&#x7B7E;&#x90FD;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x65B0;&#x6784;&#x5EFA;&#x7684;&#x955C;&#x50CF;&#x62E5;&#x6709;&#x8BE5;&#x6807;&#x7B7E;&#xFF0C;&#x800C;&#x4E4B;&#x524D;&#x6784;&#x5EFA;&#x7684;&#x955C;&#x50CF;&#x5C31;&#x4E22;&#x5931;&#x4E86;&#x6807;&#x7B7E;&#x3002;</li>
</ul>
<p>&#x8FD9;&#x7C7B;&#x955C;&#x50CF;&#x88AB;&#x79F0;&#x4E3A; <code>dangling</code> &#xFF08;&#x6643;&#x8361;&#x7740;&#x7684;&#xFF09;&#x955C;&#x50CF;&#xFF0C;&#x8FD9;&#x4E9B;&#x955C;&#x50CF;&#x53EF;&#x4EE5;&#x5220;&#x9664;&#xFF0C;&#x4F7F;&#x7528; <code>dangling=true</code> &#x8FC7;&#x6EE4;&#x6761;&#x4EF6;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x624B;&#x52A8;&#x5220;&#x9664; dangling &#x955C;&#x50CF;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker rmi $(docker images -aq <span class="_">-f</span> <span class="string">&quot;dangling=true&quot;</span>)</div></pre></td></tr></table></figure>
<p>&#x5BF9;&#x4E8E;&#x9891;&#x7E41;&#x6784;&#x5EFA;&#x7684;&#x673A;&#x5668;&#xFF0C;&#x6BD4;&#x5982; Jenkins &#x4E4B;&#x7C7B;&#x7684;&#x73AF;&#x5883;&#x3002;&#x624B;&#x52A8;&#x6E05;&#x7406;&#x663E;&#x7136;&#x4E0D;&#x662F;&#x597D;&#x7684;&#x529E;&#x6CD5;&#xFF0C;&#x5E94;&#x8BE5;&#x5B9A;&#x671F;&#x6267;&#x884C;&#x56FA;&#x5B9A;&#x811A;&#x672C;&#x6765;&#x6E05;&#x7406;&#x8FD9;&#x4E9B;&#x65E0;&#x7528;&#x7684;&#x955C;&#x50CF;&#x3002;&#x5F88;&#x5E78;&#x8FD0;&#xFF0C;Spotify &#x4E5F;&#x9762;&#x4E34;&#x4E86;&#x540C;&#x6837;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4ED6;&#x4EEC;&#x5DF2;&#x7ECF;&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x5F00;&#x6E90;&#x5DE5;&#x5177;&#x6765;&#x505A;&#x8FD9;&#x4EF6;&#x4E8B;&#x60C5;&#xFF1A;<a href="https://github.com/spotify/docker-gc" target="_blank" rel="external">https://github.com/spotify/docker-gc</a></p>
<h2 id="wei-shi-me-docker-hub-de-jing-xiang-chi-cun-he-docker-images-bu-yi-zhi"><a href="#&#x4E3A;&#x4EC0;&#x4E48;-Docker-Hub-&#x7684;&#x955C;&#x50CF;&#x5C3A;&#x5BF8;&#x548C;-docker-images-&#x4E0D;&#x4E00;&#x81F4;&#xFF1F;" class="headerlink" title="&#x4E3A;&#x4EC0;&#x4E48; Docker Hub &#x7684;&#x955C;&#x50CF;&#x5C3A;&#x5BF8;&#x548C; docker images &#x4E0D;&#x4E00;&#x81F4;&#xFF1F;"></a>&#x4E3A;&#x4EC0;&#x4E48; Docker Hub &#x7684;&#x955C;&#x50CF;&#x5C3A;&#x5BF8;&#x548C; <code>docker images</code> &#x4E0D;&#x4E00;&#x81F4;&#xFF1F; <a href="#wei-shi-me-docker-hub-de-jing-xiang-chi-cun-he-docker-images-bu-yi-zhi" class="header-anchor">#</a></h2><p>Docker Hub&#x4E0A;&#x663E;&#x793A;&#x7684;&#x662F;&#x7ECF;&#x8FC7; <code>gzip</code> &#x538B;&#x7F29;&#x540E;&#x7684;&#x955C;&#x50CF;&#x5927;&#x5C0F;&#xFF0C;&#x8FD9;&#x4E2A;&#x5927;&#x5C0F;&#x4E5F;&#x662F;&#x4F60;&#x5C06;&#x4E0B;&#x8F7D;&#x7684;&#x955C;&#x50CF;&#x5927;&#x5C0F;&#xFF0C;&#x4E00;&#x822C;&#x6765;&#x8BF4;&#x4E5F;&#x662F; Docker Hub &#x7528;&#x6237;&#x6700;&#x5173;&#x5FC3;&#x7684;&#x5927;&#x5C0F;&#x3002;</p>
<p>&#x800C; <code>docker images</code> &#x663E;&#x793A;&#x7684;&#x662F;<code>pull</code>&#x4E0B;&#x6765;&#x5E76;&#x89E3;&#x538B;&#x7F29;&#x540E;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x56E0;&#x4E3A;&#x4F7F;&#x7528;<code>docker images</code>&#x7684;&#x65F6;&#x5019;&#x66F4;&#x5173;&#x5FC3;&#x7684;&#x662F;&#x672C;&#x5730;&#x78C1;&#x76D8;&#x7A7A;&#x95F4;&#x5360;&#x7528;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x663E;&#x793A;&#x7684;&#x662F;&#x672A;&#x538B;&#x7F29;&#x955C;&#x50CF;&#x7684;&#x5927;&#x5C0F;&#x3002;</p>
<h2 id="docker-ri-zhi-du-zai-na-li-zen-me-shou-ji"><a href="#Docker-&#x65E5;&#x5FD7;&#x90FD;&#x5728;&#x54EA;&#x91CC;&#xFF1F;&#x600E;&#x4E48;&#x6536;&#x96C6;&#xFF1F;" class="headerlink" title="Docker &#x65E5;&#x5FD7;&#x90FD;&#x5728;&#x54EA;&#x91CC;&#xFF1F;&#x600E;&#x4E48;&#x6536;&#x96C6;&#xFF1F;"></a>Docker &#x65E5;&#x5FD7;&#x90FD;&#x5728;&#x54EA;&#x91CC;&#xFF1F;&#x600E;&#x4E48;&#x6536;&#x96C6;&#xFF1F; <a href="#docker-ri-zhi-du-zai-na-li-zen-me-shou-ji" class="header-anchor">#</a></h2><p>&#x65E5;&#x5FD7;&#x5206;&#x4E24;&#x7C7B;&#xFF0C;&#x4E00;&#x7C7B;&#x662F; <code>docker daemon &#x65E5;&#x5FD7;</code>&#xFF0C;&#x65E2; Docker &#x5F15;&#x64CE;&#x670D;&#x52A1;&#x65E5;&#x5FD7;&#xFF1B;&#x53E6;&#x4E00;&#x7C7B;&#x662F; <code>&#x5BB9;&#x5668;&#x65E5;&#x5FD7;</code>&#x3002;</p>
<p><code>docker daemon &#x65E5;&#x5FD7;</code> &#x4E00;&#x822C;&#x662F;&#x4EA4;&#x7ED9;&#x4E86; <code>Upstart</code>(Ubuntu 14.04) &#x6216;&#x8005; <code>systemd</code> (CentOS 7, Ubuntu 16.04)&#x3002;&#x524D;&#x8005;&#x4E00;&#x822C;&#x4F4D;&#x4E8E; <code>/var/log/upstart/docker.log</code> &#x4E0B;&#xFF0C;&#x540E;&#x8005;&#x4E00;&#x822C;&#x901A;&#x8FC7; <code>jounarlctl -u docker</code> &#x6765;&#x8BFB;&#x53D6;&#x3002;&#x4E0D;&#x540C;&#x7CFB;&#x7EDF;&#x7684;&#x4F4D;&#x7F6E;&#x90FD;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;SO&#x4E0A;&#x6709;&#x4EBA;&#x603B;&#x7ED3;&#x4E86;&#x4E00;&#x4EFD;&#x5217;&#x8868;&#xFF0C;&#x6211;&#x7A0D;&#x5FAE;&#x4FEE;&#x6B63;&#x4E86;&#x4E00;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#xFF1A;</p>
<table>
<thead>
<tr>
<th>&#x7CFB;&#x7EDF;</th>
<th>&#x65E5;&#x5FD7;&#x4F4D;&#x7F6E;</th>
</tr>
</thead>
<tbody>
<tr>
<td> Ubuntu(14.04)</td>
<td>/var/log/upstart/docker.log</td>
</tr>
<tr>
<td> Ubuntu(16.04)</td>
<td>journalctl -u docker.service</td>
</tr>
<tr>
<td> CentOS 7/RHEL 7/Fedora</td>
<td>journalctl -u docker.service</td>
</tr>
<tr>
<td> CoreOS</td>
<td>journalctl -u docker.service</td>
</tr>
<tr>
<td> OpenSuSE</td>
<td>journalctl -u docker.service</td>
</tr>
<tr>
<td> OSX</td>
<td>~/Library/Containers/com.docker.docker/Data/com.docker.driver.amd64-linux/log/d&#x200C;&#x200B;ocker.log</td>
</tr>
<tr>
<td> Debian GNU/Linux 7</td>
<td>/var/log/daemon.log</td>
</tr>
<tr>
<td> Debian GNU/Linux 8</td>
<td>journalctl -u docker.service</td>
</tr>
<tr>
<td> Boot2Docker</td>
<td>/var/log/docker.log</td>
</tr>
</tbody>
</table>
<p><code>&#x5BB9;&#x5668;&#x7684;&#x65E5;&#x5FD7;</code>&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <code>docker logs</code> &#x547D;&#x4EE4;&#x6765;&#x8BBF;&#x95EE;&#xFF0C;&#x800C;&#x4E14;&#x53EF;&#x4EE5;&#x50CF; <code>tail -f</code> &#x4E00;&#x6837;&#xFF0C;&#x4F7F;&#x7528; <code>docker logs -f</code> &#x6765;&#x5B9E;&#x65F6;&#x67E5;&#x770B;&#x3002;&#x5982;&#x679C;&#x4F7F;&#x7528; Docker Compose&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <code>docker-compose logs &lt;&#x670D;&#x52A1;&#x540D;&gt;</code> &#x6765;&#x67E5;&#x770B;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6DF1;&#x7A76;&#x5176;&#x65E5;&#x5FD7;&#x4F4D;&#x7F6E;&#xFF0C;&#x6BCF;&#x4E2A;&#x5BB9;&#x5668;&#x7684;&#x65E5;&#x5FD7;&#x9ED8;&#x8BA4;&#x90FD;&#x4F1A;&#x4EE5; <code>json-file</code> &#x7684;&#x683C;&#x5F0F;&#x5B58;&#x50A8;&#x4E8E; <code>/var/lib/docker/containers/&lt;&#x5BB9;&#x5668;id&gt;/&lt;&#x5BB9;&#x5668;id&gt;-json.log</code> &#x4E0B;&#xFF0C;&#x4E0D;&#x8FC7;&#x5E76;&#x4E0D;&#x5EFA;&#x8BAE;&#x53BB;&#x8FD9;&#x91CC;&#x76F4;&#x63A5;&#x8BFB;&#x53D6;&#x5185;&#x5BB9;&#xFF0C;&#x56E0;&#x4E3A;Docker&#x63D0;&#x4F9B;&#x4E86;&#x66F4;&#x5B8C;&#x5584;&#x5730;&#x65E5;&#x5FD7;&#x6536;&#x96C6;&#x65B9;&#x5F0F; - <code>Docker &#x65E5;&#x5FD7;&#x6536;&#x96C6;&#x9A71;&#x52A8;</code>&#x3002;</p>
<p>&#x5173;&#x4E8E;&#x65E5;&#x5FD7;&#x6536;&#x96C6;&#xFF0C;<code>Docker</code> &#x5185;&#x7F6E;&#x4E86;&#x5F88;&#x591A;&#x65E5;&#x5FD7;&#x9A71;&#x52A8;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7C7B;&#x4F3C;&#x4E8E; <code>fluentd</code>, <code>syslog</code> &#x8FD9;&#x7C7B;&#x670D;&#x52A1;&#x6536;&#x96C6;&#x65E5;&#x5FD7;&#x3002;&#x65E0;&#x8BBA;&#x662F; <code>docker daemon</code>&#xFF0C;&#x8FD8;&#x662F;&#x5BB9;&#x5668;&#xFF0C;&#x90FD;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x65E5;&#x5FD7;&#x9A71;&#x52A8;&#x3002;&#x6BD4;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x6253;&#x7B97;&#x7528; <code>fluentd</code> &#x6536;&#x96C6;&#x67D0;&#x4E2A;&#x5BB9;&#x5668;&#x65E5;&#x5FD7;&#xFF0C;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x542F;&#x52A8;&#x5BB9;&#x5668;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ docker run <span class="_">-d</span> \</div><div class="line">    --log-driver=fluentd \</div><div class="line">    --log-opt fluentd-address=10.2.3.4:24224 \</div><div class="line">    --log-opt tag=<span class="string">&quot;docker.{{.Name}}&quot;</span> \</div><div class="line">    nginx</div></pre></td></tr></table></figure>
<p>&#x5176;&#x4E2D; <code>10.2.3.4:24224</code> &#x662F; <code>fluentd</code> &#x670D;&#x52A1;&#x5730;&#x5740;&#xFF0C;&#x5B9E;&#x9645;&#x73AF;&#x5883;&#x4E2D;&#x5E94;&#x8BE5;&#x6362;&#x6210;&#x771F;&#x5B9E;&#x7684;&#x5730;&#x5740;&#x3002;</p>
<h2 id="wo-yong-de-shi-a-li-yun-ubuntu-14-04-zhu-ji-nei-he-huan-shi-3-13-zen-me-ban"><a href="#&#x6211;&#x7528;&#x7684;&#x662F;&#x963F;&#x91CC;&#x4E91;-Ubuntu-14-04-&#x4E3B;&#x673A;&#xFF0C;&#x5185;&#x6838;&#x8FD8;&#x662F;3-13&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F;" class="headerlink" title="&#x6211;&#x7528;&#x7684;&#x662F;&#x963F;&#x91CC;&#x4E91; Ubuntu 14.04 &#x4E3B;&#x673A;&#xFF0C;&#x5185;&#x6838;&#x8FD8;&#x662F;3.13&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F;"></a>&#x6211;&#x7528;&#x7684;&#x662F;&#x963F;&#x91CC;&#x4E91; <code>Ubuntu 14.04</code> &#x4E3B;&#x673A;&#xFF0C;&#x5185;&#x6838;&#x8FD8;&#x662F;<code>3.13</code>&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F; <a href="#wo-yong-de-shi-a-li-yun-ubuntu-14-04-zhu-ji-nei-he-huan-shi-3-13-zen-me-ban" class="header-anchor">#</a></h2><p>&#x5176;&#x5B9E; <code>Ubuntu 14.04</code> &#x5B98;&#x65B9;&#x7EF4;&#x62A4;&#x7684;&#x5185;&#x6838;&#x5DF2;&#x7ECF;&#x5230; <code>4.4</code> &#x4E86;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x5347;&#x7EA7;&#x5185;&#x6838;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install -y --install-recommends linux-generic-lts-xenial</div></pre></td></tr></table></figure>
<h2 id="ru-he-dong-tai-xiu-gai-nei-cun-xian-zhi"><a href="#&#x5982;&#x4F55;&#x52A8;&#x6001;&#x4FEE;&#x6539;&#x5185;&#x5B58;&#x9650;&#x5236;&#xFF1F;" class="headerlink" title="&#x5982;&#x4F55;&#x52A8;&#x6001;&#x4FEE;&#x6539;&#x5185;&#x5B58;&#x9650;&#x5236;&#xFF1F;"></a>&#x5982;&#x4F55;&#x52A8;&#x6001;&#x4FEE;&#x6539;&#x5185;&#x5B58;&#x9650;&#x5236;&#xFF1F; <a href="#ru-he-dong-tai-xiu-gai-nei-cun-xian-zhi" class="header-anchor">#</a></h2><p><code>Docker 1.10</code> &#x4E4B;&#x540E;&#x652F;&#x6301;&#x52A8;&#x6001;&#x4FEE;&#x6539;&#xFF0C;&#x4F7F;&#x7528; <code>docker update</code> &#x547D;&#x4EE4;&#xFF0C;&#x5982;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker update -m 300m</div></pre></td></tr></table></figure>
<h2 id="jing-chang-zai-ge-chong-docker-ming-ling-li-kan-dao-label-label-shi-shi-me-gan-shi-me-yong-de"><a href="#&#x7ECF;&#x5E38;&#x5728;&#x5404;&#x79CD;-Docker-&#x547D;&#x4EE4;&#x91CC;&#x770B;&#x5230;-label&#xFF0C;label-&#x662F;&#x4EC0;&#x4E48;&#xFF1F;&#x5E72;&#x4EC0;&#x4E48;&#x7528;&#x7684;&#xFF1F;" class="headerlink" title="&#x7ECF;&#x5E38;&#x5728;&#x5404;&#x79CD; Docker &#x547D;&#x4EE4;&#x91CC;&#x770B;&#x5230; --label&#xFF0C;label &#x662F;&#x4EC0;&#x4E48;&#xFF1F;&#x5E72;&#x4EC0;&#x4E48;&#x7528;&#x7684;&#xFF1F;"></a>&#x7ECF;&#x5E38;&#x5728;&#x5404;&#x79CD; <code>Docker</code> &#x547D;&#x4EE4;&#x91CC;&#x770B;&#x5230; <code>--label</code>&#xFF0C;<code>label</code> &#x662F;&#x4EC0;&#x4E48;&#xFF1F;&#x5E72;&#x4EC0;&#x4E48;&#x7528;&#x7684;&#xFF1F; <a href="#jing-chang-zai-ge-chong-docker-ming-ling-li-kan-dao-label-label-shi-shi-me-gan-shi-me-yong-de" class="header-anchor">#</a></h2><p><code>Label</code> &#x662F;<code>&#x952E;&#x503C;&#x5BF9;</code>&#xFF0C;&#x662F; <code>metadata</code>&#xFF0C;&#x662F;&#x8D2F;&#x7A7F;&#x4E8E; <code>Docker</code> &#x5404;&#x4E2A;&#x8D44;&#x6E90;&#x7684;&#xFF0C;&#x5305;&#x62EC;&#x5F15;&#x64CE;&#x3001;&#x955C;&#x50CF;&#x3001;&#x5BB9;&#x5668;&#x3001;&#x5377;&#x3001;&#x7F51;&#x7EDC;&#x3001;Swarm &#x8282;&#x70B9;&#x3001;&#x670D;&#x52A1;&#x7B49;&#x3002;</p>
<ul>
<li>&#x952E; <code>key</code>&#xFF1A;&#x683C;&#x5F0F;&#x8981;&#x6C42;&#x53EA;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x5B57;&#x6BCD;&#x548C;&#x6570;&#x5B57;&#xFF0C;&#x4EE5;&#x53CA;<code>.</code>&#xFF0C;<code>-</code>&#x3002;&#x63A8;&#x8350;&#x4F7F;&#x7528;&#x7C7B;&#x4F3C;&#x4E8E; <code>Java</code> &#x90A3;&#x79CD;&#x53CD;&#x5411;&#x57DF;&#x540D;&#x683C;&#x5F0F;&#xFF0C;&#x5982; <code>com.example.mytag</code>&#x3002;</li>
<li>&#x503C; <code>value</code>&#xFF1A;&#x683C;&#x5F0F;&#x5FC5;&#x987B;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x9664;&#x4E86;&#x666E;&#x901A;&#x5B57;&#x7B26;&#x4E32;&#x5916;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x662F; <code>JSON</code>, <code>XML</code>, <code>CSV</code> &#x6216;&#x8005; <code>YAML</code>&#xFF0C;&#x5F53;&#x7136;&#xFF0C;&#x9700;&#x8981;&#x5148;&#x8FDB;&#x884C;&#x5E8F;&#x5217;&#x5316;&#x3002;</li>
</ul>
<p>&#x5F53;&#x8D44;&#x6E90;&#x5F88;&#x5C11;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5BF9;&#x4E00;&#x4E2A;&#x4E2A;&#x8D44;&#x6E90;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#xFF0C;&#x4F46;&#x662F;&#xFF0C;&#x5728;&#x7BA1;&#x7406;&#x5F88;&#x591A;&#x8D44;&#x6E90;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8FD9;&#x4E48;&#x505A;&#x5C31;&#x53D8;&#x5F97;&#x4E0D;&#x5927;&#x73B0;&#x5B9E;&#x3002;&#x7ECF;&#x5E38;&#x7684;&#x9700;&#x6C42;&#x662F;&#x9488;&#x5BF9;&#x67D0;&#x4E00;&#x7C7B;&#x7684;&#x8D44;&#x6E90;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x4E2A;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x7ECF;&#x5E38;&#x4F1A;&#x4F7F;&#x7528; <code>label</code> &#x6765;&#x5E2E;&#x52A9;&#x5B9E;&#x73B0;&#x3002;</p>
<p>&#x5F53;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x8D44;&#x6E90;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x8FD9;&#x4E2A;&#x8D44;&#x6E90;&#x7684; <code>label</code>&#xFF08;&#x4E00;&#x4E2A;&#x8D44;&#x6E90;&#x53EF;&#x4EE5;&#x6709;&#x5F88;&#x591A;&#x4E2A; <code>label</code>&#xFF09;&#xFF0C;&#x800C;&#x5F53;&#x521B;&#x5EFA;&#x4E86;&#x5F88;&#x591A;&#x4E2A;&#x8D44;&#x6E90;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FC7;&#x6EE4; <code>label</code> &#x7684;&#x952E;&#x3001;&#x503C;&#x6765;&#x5F97;&#x5230;&#x6240;&#x9700;&#x7684;&#x8D44;&#x6E90;&#x5217;&#x8868;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>docker run</code> &#x8FD0;&#x884C;&#x4E00;&#x5806;&#x5BB9;&#x5668;&#xFF0C;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x901A;&#x8FC7; <code>label</code> &#x6307;&#x5B9A;&#x5BB9;&#x5668;&#x662F;&#x67B6;&#x6784;&#x4E2D;&#x7684;&#x54EA;&#x4E00;&#x90E8;&#x5206;&#x3002;</p>
<ul>
<li>&#x524D;&#x7AEF;&#xFF1A;<code>--label type=frontend</code></li>
<li>&#x4E2D;&#x95F4;&#x4EF6;&#xFF1A;<code>--label type=middleware</code></li>
<li>&#x5B58;&#x50A8;&#xFF1A;<code>--label type=storage</code></li>
</ul>
<p>&#x5728;&#x540E;&#x671F;&#x7EF4;&#x62A4;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8FC7;&#x6EE4;&#x663E;&#x793A;&#x60F3;&#x8981;&#x7684;&#x5BB9;&#x5668;&#xFF0C;&#x6BD4;&#x5982;&#x6211;&#x4EEC;&#x53EA;&#x60F3;&#x770B;&#x524D;&#x7AEF;&#x5BB9;&#x5668;&#x8FD0;&#x884C;&#x60C5;&#x51B5;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker ps --filter label=<span class="built_in">type</span>=frontend</div></pre></td></tr></table></figure>
<p>&#x800C;&#x4E14;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x8FDB;&#x4E00;&#x6B65;&#x7684;&#x548C;&#x5176;&#x5B83;&#x547D;&#x4EE4;&#x914D;&#x5408;&#x64CD;&#x4F5C;&#x8FD9;&#x7EC4;&#x5BB9;&#x5668;&#xFF0C;&#x6BD4;&#x5982;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x505C;&#x6B62;&#x6240;&#x6709;&#x524D;&#x7AEF;&#x5BB9;&#x5668;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker stop $(docker ps <span class="_">-f</span> label=<span class="built_in">type</span>=frontend)</div></pre></td></tr></table></figure>
<p>&#x4F7F;&#x7528; <code>label</code> &#x5728;&#x96C6;&#x7FA4;&#x8C03;&#x5EA6;&#x4E2D;&#x4E5F;&#x975E;&#x5E38;&#x6709;&#x7528;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;&#x4E0D;&#x540C;&#x7684; Docker &#x4E3B;&#x673A;&#x7684;&#x5F15;&#x64CE; <code>dockerd</code> &#x53C2;&#x6570;&#x4E2D;&#xFF0C;&#x901A;&#x8FC7; <code>label</code> &#x6765;&#x52A0;&#x5165;&#x5B58;&#x50A8;&#x7C7B;&#x578B;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x5982;&#xFF1A;</p>
<ul>
<li>&#x5B58;&#x50A8;&#x7C7B;&#x578B;&#x4E3A; <code>SSD</code>&#xFF1A;<code>--label storage=ssd</code></li>
<li>&#x5B58;&#x50A8;&#x7C7B;&#x578B;&#x4E3A; <code>HDD</code>&#xFF1A;<code>--label storage=hdd</code></li>
</ul>
<p>&#x5BF9;&#x4E8E;&#x6570;&#x636E;&#x5E93;&#x7684;&#x670D;&#x52A1;&#xFF0C;&#x6211;&#x4EEC;&#x81EA;&#x7136;&#x5E0C;&#x671B;&#x8DD1;&#x5728; <code>SSD</code> &#x4E0A;&#x4EE5;&#x83B7;&#x5F97;&#x66F4;&#x5927;&#x7684;&#x6027;&#x80FD;&#xFF0C;&#x800C;&#x65E5;&#x5FD7;&#x3001;&#x5907;&#x4EFD;&#x670D;&#x52A1;&#x5219;&#x5E0C;&#x671B;&#x8DD1;&#x5728; <code>HDD</code> &#x4E0A;&#x83B7;&#x5F97;&#x66F4;&#x9AD8;&#x7684;&#x5BB9;&#x91CF;&#x3002;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x8FD9;&#x4E48;&#x505A;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">docker service create \</div><div class="line">    --name mysql \</div><div class="line">    --constraint <span class="string">&apos;engine.labels.storage == ssd&apos;</span> \</div><div class="line">    mysql</div></pre></td></tr></table></figure>
<h3 id="tian-jia-label-yi-ji-guo-lu"><a href="#&#x6DFB;&#x52A0;label&#x4EE5;&#x53CA;&#x8FC7;&#x6EE4;" class="headerlink" title="&#x6DFB;&#x52A0;label&#x4EE5;&#x53CA;&#x8FC7;&#x6EE4;"></a>&#x6DFB;&#x52A0;<code>label</code>&#x4EE5;&#x53CA;&#x8FC7;&#x6EE4; <a href="#tian-jia-label-yi-ji-guo-lu" class="header-anchor">#</a></h3><p>&#x6DFB;&#x52A0; <code>label</code> &#x5927;&#x591A;&#x683C;&#x5F0F;&#x90FD;&#x662F;&#x5728;&#x521B;&#x5EFA;&#x3001;&#x4FEE;&#x6539;&#x8D44;&#x6E90;&#x65F6;&#xFF0C;&#x4F7F;&#x7528; <code>--label &lt;key&gt;=&lt;value&gt;</code> &#x53C2;&#x6570;&#xFF08;&#x90E8;&#x5206;&#x547D;&#x4EE4;&#x63D0;&#x4F9B;&#x4E86; <code>-l</code> &#x7F29;&#x5199;&#x5F62;&#x5F0F;&#xFF09;&#x3002;<code>value</code> &#x53EF;&#x4EE5;&#x7701;&#x7565;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A; <code>--label &lt;key&gt;</code>&#x3002;&#x5982;&#x679C;&#x9700;&#x8981;&#x5B9A;&#x4E49;&#x591A;&#x7EC4; <code>label</code>&#xFF0C;&#x53EA;&#x9700;&#x591A;&#x7EC4; <code>--label</code> &#x5373;&#x53EF;&#x3002;</p>
<p>&#x8FC7;&#x6EE4; <code>label</code> &#x5219;&#x5927;&#x591A;&#x53D1;&#x751F;&#x5728;&#x5217;&#x8868;&#x547D;&#x4EE4;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528; <code>--filter label=&lt;key&gt;=&lt;value&gt;</code>&#xFF0C;&#x6216;&#x8005;&#x5BF9;&#x4E8E;&#x4E0D;&#x5173;&#x5FC3; <code>value</code> &#x7684;&#x60C5;&#x51B5;&#xFF0C;<code>--filter label=&lt;key&gt;</code>&#xFF08;&#x90E8;&#x5206;&#x547D;&#x4EE4;&#x63D0;&#x4F9B;&#x4E86; <code>-f</code> &#x7684;&#x7F29;&#x5199;&#x5F62;&#x5F0F;&#xFF09;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x7684;&#x5217;&#x8868;&#xFF0C;&#x5217;&#x51FA;&#x4E86;&#x652F;&#x6301; <code>label</code> &#x7684;&#x547D;&#x4EE4;&#xFF08;&#x9664;&#x975E;&#x7279;&#x6B8A;&#x58F0;&#x660E;&#xFF0C;&#x201D;&#x6DFB;&#x52A0;&#x201D;&#x547D;&#x4EE4;&#x4F7F;&#x7528; <code>--label</code> &#x9009;&#x9879;&#x6DFB;&#x52A0; <code>label</code>&#xFF1B;&#x201D;&#x8FC7;&#x6EE4;&#x201D;&#x547D;&#x4EE4;&#x4F7F;&#x7528; <code>--filter</code> &#x8FC7;&#x6EE4;<code>label</code>&#xFF09;&#xFF1A;</p>
<ul>
<li>Docker &#x5F15;&#x64CE;<ul>
<li>&#x6DFB;&#x52A0;&#xFF1A;<code>dockerd</code>&#xFF1A; <a href="https://docs.docker.com/engine/reference/commandline/dockerd/" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/dockerd/</a></li>
</ul>
</li>
<li>&#x955C;&#x50CF;<ul>
<li>&#x6DFB;&#x52A0;&#xFF1A;<ul>
<li><code>docker build</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/build/" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/build/</a></li>
<li><code>Dockerfile</code> &#x4E2D;&#x7684; <code>LABEL</code>&#xFF08;&#x4F1A;&#x7EE7;&#x627F;<code>FROM</code>&#x955C;&#x50CF;&#x7684;<code>LABEL</code>&#xFF09;&#xFF1A;<a href="https://docs.docker.com/engine/reference/builder/#/label" target="_blank" rel="external">https://docs.docker.com/engine/reference/builder/#/label</a></li>
</ul>
</li>
<li>&#x8FC7;&#x6EE4;&#xFF1A;<code>docker images</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/images/#/filtering" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/images/#/filtering</a></li>
</ul>
</li>
<li>&#x5BB9;&#x5668;<ul>
<li>&#x6DFB;&#x52A0;&#xFF1A;<code>docker create</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/create/" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/create/</a><ul>
<li>&#x9664;&#x4E86; <code>--label</code> &#x5916;&#xFF0C;<code>docker create</code> &#x8FD8;&#x652F;&#x6301;&#x4F7F;&#x7528;&#x9009;&#x9879; <code>--label-file</code> &#x4ECE;&#x6587;&#x4EF6;&#x4E2D;&#x52A0;&#x8F7D; <code>label</code></li>
</ul>
</li>
<li>&#x6DFB;&#x52A0;&#xFF1A;<code>docker run</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/run/#/set-metadata-on-container--l---label---label-file" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/run/#/set-metadata-on-container--l---label---label-file</a><ul>
<li>&#x9664;&#x4E86; <code>--label</code> &#x5916;&#xFF0C;<code>docker run</code> &#x8FD8;&#x652F;&#x6301;&#x4F7F;&#x7528;&#x9009;&#x9879; <code>--label-file</code> &#x4ECE;&#x6587;&#x4EF6;&#x4E2D;&#x52A0;&#x8F7D; <code>label</code></li>
</ul>
</li>
<li>&#x8FC7;&#x6EE4;&#xFF1A;<code>docker ps</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/ps/#/label" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/ps/#/label</a></li>
</ul>
</li>
<li>&#x5377;<ul>
<li>&#x6DFB;&#x52A0;&#xFF1A;<code>docker volume create</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/volume_create/" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/volume_create/</a></li>
<li>&#x8FC7;&#x6EE4;&#xFF1A;<code>docker volume ls</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/volume_ls/#/filtering" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/volume_ls/#/filtering</a></li>
</ul>
</li>
<li>&#x7F51;&#x7EDC;<ul>
<li>&#x6DFB;&#x52A0;&#xFF1A;<code>docker network create</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/network_create/" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/network_create/</a></li>
<li>&#x8FC7;&#x6EE4;&#xFF1A;<code>docker network ls</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/network_ls/#/filtering" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/network_ls/#/filtering</a></li>
</ul>
</li>
<li>Swarm &#x8282;&#x70B9;<ul>
<li><code>docker node update</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/node_update/#/add-label-metadata-to-a-node" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/node_update/#/add-label-metadata-to-a-node</a><ul>
<li>&#x6DFB;&#x52A0;&#xFF1A;<code>--label-add</code></li>
<li>&#x5220;&#x9664;&#xFF1A;<code>--label-rm</code></li>
</ul>
</li>
<li>&#x8FC7;&#x6EE4;&#xFF1A;<code>docker node ls</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/node_ls/#/filtering" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/node_ls/#/filtering</a></li>
<li>&#x8FC7;&#x6EE4;&#xFF1A;<code>docker node ps</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/node_ps/#/label" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/node_ps/#/label</a></li>
</ul>
</li>
<li>&#x670D;&#x52A1;<ul>
<li>&#x6DFB;&#x52A0;&#xFF1A;<code>docker service create</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/service_create/#/set-metadata-on-a-service--l---label" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/service_create/#/set-metadata-on-a-service--l---label</a><ul>
<li>&#x9664;&#x4E86; <code>--label</code> &#x5916;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <code>--container-label</code> &#x6765;&#x6DFB;&#x52A0;&#x5BB9;&#x5668; <code>label</code></li>
</ul>
</li>
<li><code>docker service update</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/service_update/" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/service_update/</a><ul>
<li>&#x6DFB;&#x52A0;&#x5BB9;&#x5668; <code>label</code>&#xFF1A;<code>--container-label-add</code></li>
<li>&#x5220;&#x9664;&#x5BB9;&#x5668; <code>label</code>&#xFF1A;<code>--container-label-rm</code></li>
<li>&#x6DFB;&#x52A0;&#x670D;&#x52A1; <code>label</code>&#xFF1A;<code>--label-add</code></li>
<li>&#x5220;&#x9664;&#x670D;&#x52A1; <code>label</code>&#xFF1A;<code>--label-rm</code></li>
</ul>
</li>
<li>&#x8FC7;&#x6EE4;&#xFF1A;<code>docker service ls</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/service_ls/#/label" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/service_ls/#/label</a></li>
</ul>
</li>
</ul>
<p>&#x9664;&#x4E86;&#x4E0A;&#x8FF0;&#x8D44;&#x6E90;&#x5916;&#xFF0C;<code>docker events</code> &#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>label</code> &#x8FC7;&#x6EE4;&#x7ED3;&#x679C;&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/events/" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/events/</a></p>
<h3 id="ji-qun-diao-du-yue-shu"><a href="#&#x96C6;&#x7FA4;&#x8C03;&#x5EA6;&#x7EA6;&#x675F;" class="headerlink" title="&#x96C6;&#x7FA4;&#x8C03;&#x5EA6;&#x7EA6;&#x675F;"></a>&#x96C6;&#x7FA4;&#x8C03;&#x5EA6;&#x7EA6;&#x675F; <a href="#ji-qun-diao-du-yue-shu" class="header-anchor">#</a></h3><ul>
<li>&#x4E00;&#x4EE3; Swarm&#xFF1A;&#x4F7F;&#x7528;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x6DFB;&#x52A0;&#x7EA6;&#x675F;<ul>
<li><code>docker run</code>&#xFF1A;<code>-e constraint:storage==sdd</code>&#xFF1A;<a href="https://docs.docker.com/swarm/scheduler/filter/#/how-to-write-filter-expressions" target="_blank" rel="external">https://docs.docker.com/swarm/scheduler/filter/#/how-to-write-filter-expressions</a></li>
<li><code>docker-compose.yml</code>&#xFF1A;&#x4F7F;&#x7528; <code>environment</code> &#x6765;&#x8FDB;&#x884C;&#x7EA6;&#x675F;&#xFF1A;<a href="https://docs.docker.com/compose/swarm/#/manual-scheduling" target="_blank" rel="external">https://docs.docker.com/compose/swarm/#/manual-scheduling</a></li>
</ul>
</li>
</ul>
<p>&#x5982;&#xFF1A;</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="attr">version:</span> <span class="string">&quot;2&quot;</span></div><div class="line"><span class="attr">services:</span></div><div class="line"><span class="attr">    redis:</span></div><div class="line"><span class="attr">        image:</span> redis</div><div class="line"><span class="attr">        environment:</span></div><div class="line"><span class="bullet">            -</span> <span class="string">&quot;constraint:storage==ssd&quot;</span></div></pre></td></tr></table></figure>
<ul>
<li>&#x4E8C;&#x4EE3; Swarm<ul>
<li><code>docker service create</code>&#xFF1A;<code>--constraint value</code>&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/service_create/#/specify-service-constraints---constraint" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/service_create/#/specify-service-constraints---constraint</a></li>
</ul>
</li>
</ul>
<p>&#x5982;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528; <code>Swarm &#x8282;&#x70B9;</code> &#x7684; <code>label</code> &#x8FDB;&#x884C;&#x7EA6;&#x675F;&#xFF08;&#x6CE8;&#x610F;&#xFF0C;&#x8FD9;&#x6B21;&#x7528;&#x7684;&#x4E0D;&#x662F;<code>&#x5F15;&#x64CE;</code>&#x7684;<code>label</code>&#xFF09;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">docker service create \</div><div class="line">    --name web \</div><div class="line">    --constraint <span class="string">&apos;node.labels.type == frontend&apos;</span> \</div><div class="line">    nginx</div></pre></td></tr></table></figure>
<h1 id="dockerfile-xiang-guan-wen-ti"><a href="#Dockerfile-&#x76F8;&#x5173;&#x95EE;&#x9898;" class="headerlink" title="Dockerfile &#x76F8;&#x5173;&#x95EE;&#x9898;"></a><code>Dockerfile</code> &#x76F8;&#x5173;&#x95EE;&#x9898; <a href="#dockerfile-xiang-guan-wen-ti" class="header-anchor">#</a></h1><h2 id="docker-commit-zen-me-yong-a"><a href="#docker-commit-&#x600E;&#x4E48;&#x7528;&#x554A;&#xFF1F;" class="headerlink" title="docker commit &#x600E;&#x4E48;&#x7528;&#x554A;&#xFF1F;"></a><code>docker commit</code> &#x600E;&#x4E48;&#x7528;&#x554A;&#xFF1F; <a href="#docker-commit-zen-me-yong-a" class="header-anchor">#</a></h2><p>&#x7B80;&#x5355;&#x7684;&#x56DE;&#x7B54;&#x5C31;&#x662F;&#xFF0C;&#x4E0D;&#x8981;&#x7528; <code>commit</code>&#xFF0C;&#x53BB;&#x5199; <code>Dockerfile</code>&#x3002;</p>
<p>Docker &#x4E0D;&#x662F;&#x865A;&#x62DF;&#x673A;&#x3002;&#x8FD9;&#x53E5;&#x8BDD;&#x8981;&#x5728;&#x5B66;&#x4E60; Docker &#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x53CD;&#x590D;&#x63D0;&#x9192;&#x81EA;&#x5DF1;&#x3002;&#x6240;&#x4EE5;&#x4E0D;&#x8981;&#x628A;&#x865A;&#x62DF;&#x673A;&#x4E2D;&#x7684;&#x4E00;&#x4E9B;&#x6982;&#x5FF5;&#x5E26;&#x8FC7;&#x6765;&#x3002;</p>
<p>Docker &#x63D0;&#x4F9B;&#x4E86;&#x5F88;&#x597D;&#x7684; <code>Dockerfile</code> &#x7684;&#x673A;&#x5236;&#x6765;&#x5E2E;&#x52A9;&#x5B9A;&#x5236;&#x955C;&#x50CF;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528; Shell &#x547D;&#x4EE4;&#xFF0C;&#x975E;&#x5E38;&#x65B9;&#x4FBF;&#x3002;&#x800C;&#x4E14;&#xFF0C;&#x8FD9;&#x6837;&#x5236;&#x4F5C;&#x7684;&#x955C;&#x50CF;&#x66F4;&#x52A0;&#x900F;&#x660E;&#xFF0C;&#x4E5F;&#x5BB9;&#x6613;&#x7EF4;&#x62A4;&#xFF0C;&#x5728;&#x57FA;&#x7840;&#x955C;&#x50CF;&#x5347;&#x7EA7;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x7B80;&#x5355;&#x5730;&#x91CD;&#x65B0;&#x6784;&#x5EFA;&#x4E00;&#x4E0B;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x7EE7;&#x627F;&#x57FA;&#x7840;&#x955C;&#x50CF;&#x7684;&#x5B89;&#x5168;&#x7EF4;&#x62A4;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x4F7F;&#x7528; <code>docker commit</code> &#x5236;&#x4F5C;&#x7684;&#x955C;&#x50CF;&#x88AB;&#x79F0;&#x4E3A;<code>&#x9ED1;&#x7BB1;&#x955C;&#x50CF;</code>&#xFF0C;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x5C31;&#x662F;&#x91CC;&#x9762;&#x8FDB;&#x884C;&#x7684;&#x662F;&#x9ED1;&#x7BB1;&#x64CD;&#x4F5C;&#xFF0C;&#x9664;&#x672C;&#x4EBA;&#x5916;&#x65E0;&#x4EBA;&#x77E5;&#x6653;&#x3002;&#x5373;&#x4F7F;&#x8FD9;&#x4E2A;&#x5236;&#x4F5C;&#x955C;&#x50CF;&#x7684;&#x4EBA;&#xFF0C;&#x8FC7;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x540E;&#x4E5F;&#x4E0D;&#x4F1A;&#x5B8C;&#x6574;&#x7684;&#x8BB0;&#x8D77;&#x91CC;&#x9762;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x90A3;&#x4E48;&#x5F53;&#x6709;&#x4E9B;&#x4E1C;&#x897F;&#x9700;&#x8981;&#x6539;&#x53D8;&#x65F6;&#xFF0C;&#x6216;&#x8005;&#x56E0;&#x57FA;&#x7840;&#x955C;&#x50CF;&#x66F4;&#x65B0;&#x800C;&#x9700;&#x8981;&#x91CD;&#x65B0;&#x5236;&#x4F5C;&#x955C;&#x50CF;&#x65F6;&#xFF0C;&#x4F1A;&#x8BA9;&#x4E00;&#x5207;&#x53D8;&#x5F97;&#x5F02;&#x5E38;&#x56F0;&#x96BE;&#xFF0C;&#x5C31;&#x5982;&#x540C;&#x91CD;&#x65B0;&#x5B89;&#x88C5;&#x8C03;&#x8BD5;&#x914D;&#x7F6E;&#x670D;&#x52A1;&#x5668;&#x4E00;&#x6837;&#xFF0C;&#x5931;&#x53BB;&#x4E86; Docker &#x7684;&#x4F18;&#x52BF;&#x4E86;&#x3002;</p>
<p>&#x53E6;&#x5916;&#xFF0C;Docker &#x4E0D;&#x662F;&#x865A;&#x62DF;&#x673A;&#xFF0C;&#x5176;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x662F; Union FS&#xFF0C;&#x5206;&#x5C42;&#x5F0F;&#x5B58;&#x50A8;&#xFF0C;&#x6BCF;&#x4E00;&#x6B21; <code>commit</code> &#x90FD;&#x4F1A;&#x5EFA;&#x7ACB;&#x4E00;&#x5C42;&#xFF0C;&#x4E0A;&#x4E00;&#x5C42;&#x7684;&#x6587;&#x4EF6;&#x5E76;&#x4E0D;&#x4F1A;&#x56E0;&#x4E3A; <code>rm</code> &#x800C;&#x5220;&#x9664;&#xFF0C;&#x53EA;&#x662F;&#x5728;&#x5F53;&#x524D;&#x5C42;&#x6807;&#x8BB0;&#x4E3A;&#x5220;&#x9664;&#x800C;&#x770B;&#x4E0D;&#x5230;&#x4E86;&#x800C;&#x5DF2;&#xFF0C;&#x6BCF;&#x6B21; <code>docker pull</code> &#x7684;&#x65F6;&#x5019;&#xFF0C;&#x90A3;&#x4E9B;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x6587;&#x4EF6;&#x90FD;&#x4F1A;&#x5982;&#x5F71;&#x968F;&#x5F62;&#xFF0C;&#x6240;&#x5F97;&#x5230;&#x7684;&#x955C;&#x50CF;&#x4E5F;&#x5FC5;&#x7136;&#x81C3;&#x80BF;&#x4E0D;&#x582A;&#x3002;&#x800C;&#x4E14;&#xFF0C;&#x968F;&#x7740;&#x6587;&#x4EF6;&#x5C42;&#x6570;&#x7684;&#x589E;&#x52A0;&#xFF0C;&#x4E0D;&#x4EC5;&#x4EC5;&#x955C;&#x50CF;&#x66F4;&#x81C3;&#x80BF;&#xFF0C;&#x5176;&#x8FD0;&#x884C;&#x65F6;&#x6027;&#x80FD;&#x4E5F;&#x5FC5;&#x7136;&#x4F1A;&#x53D7;&#x5230;&#x5F71;&#x54CD;&#x3002;&#x8FD9;&#x4E00;&#x5207;&#x90FD;&#x8FDD;&#x80CC;&#x4E86; Docker &#x7684;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#x3002;</p>
<p>&#x4F7F;&#x7528; <code>commit</code> &#x7684;&#x573A;&#x5408;&#x662F;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x73AF;&#x5883;&#xFF0C;&#x6BD4;&#x5982;&#x5165;&#x4FB5;&#x540E;&#x4FDD;&#x5B58;&#x73B0;&#x573A;&#x7B49;&#x7B49;&#xFF0C;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x4E0D;&#x5E94;&#x8BE5;&#x6210;&#x4E3A;&#x5B9A;&#x5236;&#x955C;&#x50CF;&#x7684;&#x6807;&#x51C6;&#x505A;&#x6CD5;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x8BF7;&#x7528; <code>Dockerfile</code> &#x5B9A;&#x5236;&#x955C;&#x50CF;&#x3002;</p>
<h2 id="dockerfile-zen-me-xie"><a href="#Dockerfile-&#x600E;&#x4E48;&#x5199;&#xFF1F;" class="headerlink" title="Dockerfile &#x600E;&#x4E48;&#x5199;&#xFF1F;"></a><code>Dockerfile</code> &#x600E;&#x4E48;&#x5199;&#xFF1F; <a href="#dockerfile-zen-me-xie" class="header-anchor">#</a></h2><p>&#x6700;&#x76F4;&#x63A5;&#x4E5F;&#x662F;&#x6700;&#x7B80;&#x5355;&#x7684;&#x529E;&#x6CD5;&#x662F;&#x770B;&#x5B98;&#x65B9;&#x6587;&#x6863;&#x3002;</p>
<p>&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x8BB2;&#x8FF0;&#x5177;&#x4F53;<code>Dockerfile</code>&#x7684;&#x547D;&#x4EE4;&#x8BED;&#x6CD5;&#xFF1A;<a href="https://docs.docker.com/engine/reference/builder/" target="_blank" rel="external">https://docs.docker.com/engine/reference/builder/</a></p>
<p>&#x7136;&#x540E;&#xFF0C;&#x5B66;&#x4E60;&#x4E00;&#x4E0B;&#x5B98;&#x65B9;&#x7684;<code>Dockerfile</code>&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#xFF1A;<a href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/" target="_blank" rel="external">https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/</a></p>
<p>&#x6700;&#x540E;&#xFF0C;&#x53BB; Docker Hub &#x5B66;&#x4E60;&#x90A3;&#x4E9B;Official&#x7684;&#x955C;&#x50CF;<code>Dockerfile</code>&#x548B;&#x5199;&#x7684;&#x3002;</p>
<h2 id="dockerfile-jiu-shi-shell-jiao-ben-ba-na-wo-dong-yi-xing-xing-ba-xu-yao-zhuang-de-dong-xi-du-xie-jin-qu-bu-jiu-xing-liao"><a href="#Dockerfile-&#x5C31;&#x662F;-shell-&#x811A;&#x672C;&#x5427;&#xFF1F;&#x90A3;&#x6211;&#x61C2;&#xFF0C;&#x4E00;&#x884C;&#x884C;&#x628A;&#x9700;&#x8981;&#x88C5;&#x7684;&#x4E1C;&#x897F;&#x90FD;&#x5199;&#x8FDB;&#x53BB;&#x4E0D;&#x5C31;&#x884C;&#x4E86;&#x3002;" class="headerlink" title="Dockerfile &#x5C31;&#x662F; shell &#x811A;&#x672C;&#x5427;&#xFF1F;&#x90A3;&#x6211;&#x61C2;&#xFF0C;&#x4E00;&#x884C;&#x884C;&#x628A;&#x9700;&#x8981;&#x88C5;&#x7684;&#x4E1C;&#x897F;&#x90FD;&#x5199;&#x8FDB;&#x53BB;&#x4E0D;&#x5C31;&#x884C;&#x4E86;&#x3002;"></a><code>Dockerfile</code> &#x5C31;&#x662F; shell &#x811A;&#x672C;&#x5427;&#xFF1F;&#x90A3;&#x6211;&#x61C2;&#xFF0C;&#x4E00;&#x884C;&#x884C;&#x628A;&#x9700;&#x8981;&#x88C5;&#x7684;&#x4E1C;&#x897F;&#x90FD;&#x5199;&#x8FDB;&#x53BB;&#x4E0D;&#x5C31;&#x884C;&#x4E86;&#x3002; <a href="#dockerfile-jiu-shi-shell-jiao-ben-ba-na-wo-dong-yi-xing-xing-ba-xu-yao-zhuang-de-dong-xi-du-xie-jin-qu-bu-jiu-xing-liao" class="header-anchor">#</a></h2><p>&#x4E0D;&#x662F;&#x8FD9;&#x6837;&#x7684;&#x3002;<code>Dockerfile</code> &#x4E0D;&#x7B49;&#x4E8E; <code>.sh</code> &#x811A;&#x672C;</p>
<p><code>Dockerfile</code> &#x786E;&#x5B9E;&#x662F;&#x63CF;&#x8FF0;&#x5982;&#x4F55;&#x6784;&#x5EFA;&#x955C;&#x50CF;&#x7684;&#xFF0C;&#x5176;&#x4E2D;&#x4E5F;&#x63D0;&#x4F9B;&#x4E86; <code>RUN</code> &#x8FD9;&#x6837;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x53EF;&#x4EE5;&#x8FD0;&#x884C; shell &#x547D;&#x4EE4;&#x3002;&#x4F46;&#x662F;&#x548C;&#x666E;&#x901A; shell &#x811A;&#x672C;&#x8FD8;&#x6709;&#x5F88;&#x5927;&#x7684;&#x4E0D;&#x540C;&#x3002;</p>
<p>Dockerfile &#x63CF;&#x8FF0;&#x7684;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x955C;&#x50CF;&#x7684;&#x6BCF;&#x4E00;&#x5C42;&#x8981;&#x5982;&#x4F55;&#x6784;&#x5EFA;&#xFF0C;&#x6240;&#x4EE5;&#x6BCF;&#x4E00;&#x4E2A;<code>RUN</code>&#x662F;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x4E00;&#x5C42;&#x3002;&#x6240;&#x4EE5;&#x4E00;&#x5B9A;&#x8981;&#x7406;&#x89E3;&#x201C;&#x5206;&#x5C42;&#x5B58;&#x50A8;&#x201D;&#x7684;&#x6982;&#x5FF5;&#x3002;&#x4E0A;&#x4E00;&#x5C42;&#x7684;&#x4E1C;&#x897F;&#x4E0D;&#x4F1A;&#x88AB;&#x7269;&#x7406;&#x5220;&#x9664;&#xFF0C;&#x800C;&#x662F;&#x4F1A;&#x4FDD;&#x7559;&#x7ED9;&#x4E0B;&#x4E00;&#x5C42;&#xFF0C;&#x4E0B;&#x4E00;&#x5C42;&#x4E2D;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x5220;&#x9664;&#x8FD9;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x53EA;&#x662F;&#x8FD9;&#x4E00;&#x5C42;&#x505A;&#x7684;&#x67D0;&#x4E2A;&#x6807;&#x8BB0;&#xFF0C;&#x8BF4;&#x8FD9;&#x4E2A;&#x8DEF;&#x5F84;&#x7684;&#x4E1C;&#x897F;&#x5220;&#x4E86;&#x3002;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x5E76;&#x4E0D;&#x4F1A;&#x53BB;&#x4FEE;&#x6539;&#x4E0A;&#x4E00;&#x5C42;&#x7684;&#x4E1C;&#x897F;&#x3002;&#x6BCF;&#x4E00;&#x5C42;&#x90FD;&#x662F;&#x9759;&#x6001;&#x7684;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;&#x5BB9;&#x5668;&#x672C;&#x8EAB;&#x7684;<code>immutable</code>&#x7279;&#x6027;&#xFF0C;&#x8981;&#x4FDD;&#x6301;&#x81EA;&#x8EAB;&#x7684;&#x9759;&#x6001;&#x7279;&#x6027;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x5F88;&#x591A;&#x65B0;&#x624B;&#x4F1A;&#x5E38;&#x72AF;&#x4E0B;&#x9762;&#x8FD9;&#x6837;&#x7684;&#x9519;&#x8BEF;&#xFF0C;&#x628A; <code>Dockerfile</code> &#x5F53;&#x505A; shell &#x811A;&#x672C;&#x6765;&#x5199;&#x4E86;&#xFF1A;</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">RUN</span><span class="bash"> yum update</span></div><div class="line"><span class="keyword">RUN</span><span class="bash"> yum -y install gcc</span></div><div class="line"><span class="keyword">RUN</span><span class="bash"> yum -y install python</span></div><div class="line"><span class="keyword">ADD</span><span class="bash"> jdk-xxxx.tar.gz /tmp</span></div><div class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">cd</span> xxxx &amp;&amp; install</span></div><div class="line"><span class="keyword">RUN</span><span class="bash"> xxx &amp;&amp; configure &amp;&amp; make &amp;&amp; make install</span></div></pre></td></tr></table></figure>
<p>&#x8FD9;&#x662F;&#x76F8;&#x5F53;&#x9519;&#x8BEF;&#x7684;&#x3002;&#x9664;&#x4E86;&#x65E0;&#x754F;&#x7684;&#x589E;&#x52A0;&#x4E86;&#x5F88;&#x591A;&#x5C42;&#xFF0C;&#x800C;&#x4E14;&#x5F88;&#x591A;&#x8FD0;&#x884C;&#x65F6;&#x4E0D;&#x9700;&#x8981;&#x7684;&#x4E1C;&#x897F;&#xFF0C;&#x90FD;&#x88AB;&#x88C5;&#x8FDB;&#x4E86;&#x955C;&#x50CF;&#x91CC;&#xFF0C;&#x6BD4;&#x5982;&#x7F16;&#x8BD1;&#x73AF;&#x5883;&#x3001;&#x66F4;&#x65B0;&#x7684;&#x8F6F;&#x4EF6;&#x5305;&#x7B49;&#x7B49;&#x3002;&#x7ED3;&#x679C;&#x5C31;&#x662F;&#x4EA7;&#x751F;&#x975E;&#x5E38;&#x81C3;&#x80BF;&#x3001;&#x975E;&#x5E38;&#x591A;&#x5C42;&#x7684;&#x955C;&#x50CF;&#xFF0C;&#x4E0D;&#x4EC5;&#x4EC5;&#x589E;&#x52A0;&#x4E86;&#x6784;&#x5EFA;&#x90E8;&#x7F72;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x4E5F;&#x5F88;&#x5BB9;&#x6613;&#x51FA;&#x9519;&#x3002;</p>
<p>&#x6B63;&#x786E;&#x7684;&#x5199;&#x6CD5;&#x5E94;&#x8BE5;&#x662F;&#x628A;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x653E;&#x5230;&#x4E00;&#x4E2A; <code>RUN</code> &#x4E0B;&#xFF0C;&#x591A;&#x6761;&#x547D;&#x4EE4;&#x5E94;&#x8BE5;&#x7528; <code>&amp;&amp;</code> &#x8FDE;&#x63A5;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x6700;&#x540E;&#x8981;&#x6253;&#x626B;&#x5E72;&#x51C0;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x73AF;&#x5883;&#x3002;&#x6BD4;&#x5982;&#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x6458;&#x81EA;&#x5B98;&#x65B9; redis &#x955C;&#x50CF; <code>Dockerfile</code> &#x7684;&#x90E8;&#x5206;&#xFF1A;</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">RUN</span><span class="bash"> buildDeps=<span class="string">&apos;gcc libc6-dev make&apos;</span> \</span></div><div class="line">    &amp;&amp; <span class="built_in">set</span> -x \</div><div class="line">    &amp;&amp; apt-get update &amp;&amp; apt-get install -y <span class="variable">$buildDeps</span> --no-install-recommends \</div><div class="line">    &amp;&amp; rm -rf /var/lib/apt/lists/* \</div><div class="line">    &amp;&amp; wget -O redis.tar.gz <span class="string">&quot;<span class="variable">$REDIS_DOWNLOAD_URL</span>&quot;</span> \</div><div class="line">    &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$REDIS_DOWNLOAD_SHA1</span> *redis.tar.gz&quot;</span> | sha1sum -c - \</div><div class="line">    &amp;&amp; mkdir -p /usr/src/redis \</div><div class="line">    &amp;&amp; tar -xzf redis.tar.gz -C /usr/src/redis --strip-components=1 \</div><div class="line">    &amp;&amp; rm redis.tar.gz \</div><div class="line">    &amp;&amp; make -C /usr/src/redis \</div><div class="line">    &amp;&amp; make -C /usr/src/redis install \</div><div class="line">    &amp;&amp; rm -r /usr/src/redis \</div><div class="line">    &amp;&amp; apt-get purge -y --auto-remove <span class="variable">$buildDeps</span></div></pre></td></tr></table></figure>
<h2 id="context-dao-di-shi-yi-ge-shi-me-gai-nian"><a href="#context-&#x5230;&#x5E95;&#x662F;&#x4E00;&#x4E2A;&#x4EC0;&#x4E48;&#x6982;&#x5FF5;&#xFF1F;" class="headerlink" title="context &#x5230;&#x5E95;&#x662F;&#x4E00;&#x4E2A;&#x4EC0;&#x4E48;&#x6982;&#x5FF5;&#xFF1F;"></a><code>context</code> &#x5230;&#x5E95;&#x662F;&#x4E00;&#x4E2A;&#x4EC0;&#x4E48;&#x6982;&#x5FF5;&#xFF1F; <a href="#context-dao-di-shi-yi-ge-shi-me-gai-nian" class="header-anchor">#</a></h2><p><code>context</code>&#xFF0C;&#x4E0A;&#x4E0B;&#x6587;&#xFF0C;&#x662F; <code>docker build</code> &#x4E2D;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x4E00;&#x4E2A;&#x6982;&#x5FF5;&#x3002;&#x6784;&#x5EFA;&#x955C;&#x50CF;&#x5FC5;&#x987B;&#x6307;&#x5B9A; <code>context</code>&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker build -t xxx &lt;context&#x8DEF;&#x5F84;&gt;</div></pre></td></tr></table></figure>
<p>&#x6216;&#x8005; <code>docker-compose.yml</code> &#x4E2D;&#x7684;</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="attr">app:</span></div><div class="line"><span class="attr">    build:</span></div><div class="line"><span class="attr">        context:</span> &lt;context&#x8DEF;&#x5F84;<span class="string">&gt;</span></div><div class="line"><span class="attr">        dockerfile:</span> dockerfile</div></pre></td></tr></table></figure>
<p>&#x8FD9;&#x91CC;&#x90FD;&#x9700;&#x8981;&#x6307;&#x5B9A; <code>context</code>&#x3002;</p>
<p><code>context</code> &#x662F;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#xFF0C;&#x4F46;&#x4E0D;&#x8981;&#x548C;&#x6784;&#x5EFA;&#x955C;&#x50CF;&#x7684;<code>Dockerfile</code> &#x4E2D;&#x7684; <code>WORKDIR</code> &#x5F04;&#x6DF7;&#xFF0C;<code>context</code> &#x662F; <code>docker build</code> &#x547D;&#x4EE4;&#x7684;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x3002;</p>
<p><code>docker build</code> &#x547D;&#x4EE4;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x771F;&#x6B63;&#x6784;&#x5EFA;&#x955C;&#x50CF;&#x5E76;&#x975E;&#x7531;&#x8BE5;&#x547D;&#x4EE4;&#x76F4;&#x63A5;&#x5B8C;&#x6210;&#x3002;<code>docker build</code> &#x547D;&#x4EE4;&#x5C06; <code>context</code> &#x7684;&#x76EE;&#x5F55;&#x4E0A;&#x4F20;&#x7ED9; <code>docker daemon</code>&#xFF0C;&#x7531;&#x5B83;&#x8D1F;&#x8D23;&#x5236;&#x4F5C;&#x955C;&#x50CF;&#x3002;</p>
<p>&#x5728; Dockerfile &#x4E2D;&#x5982;&#x679C;&#x5199; <code>COPY ./package.json /app/</code> &#x8FD9;&#x79CD;&#x547D;&#x4EE4;&#xFF0C;&#x5B9E;&#x9645;&#x7684;&#x610F;&#x601D;&#x5E76;&#x4E0D;&#x662F;&#x6307;&#x6267;&#x884C; <code>docker build</code> &#x6240;&#x5728;&#x7684;&#x76EE;&#x5F55;&#x4E0B;&#x7684; <code>package.json</code>&#xFF0C;&#x4E5F;&#x4E0D;&#x662F;&#x6307; <code>Dockerfile</code> &#x6240;&#x5728;&#x76EE;&#x5F55;&#x4E0B;&#x7684; <code>package.json</code>&#xFF0C;&#x800C;&#x662F;&#x6307; <code>context</code> &#x76EE;&#x5F55;&#x4E0B;&#x7684; <code>package.json</code>&#x3002;</p>
<p>&#x8FD9;&#x5C31;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x6709;&#x4EBA;&#x53D1;&#x73B0; <code>COPY ../package.json /app</code> &#x6216;&#x8005; <code>COPY /opt/xxxx /app</code> &#x65E0;&#x6CD5;&#x5DE5;&#x4F5C;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x90FD;&#x5728; <code>context</code> &#x4E4B;&#x5916;&#xFF0C;&#x5982;&#x679C;&#x771F;&#x6B63;&#x9700;&#x8981;&#xFF0C;&#x5E94;&#x8BE5;&#x5C06;&#x5B83;&#x4EEC;&#x590D;&#x5236;&#x5230; <code>context</code> &#x76EE;&#x5F55;&#x4E0B;&#x518D;&#x64CD;&#x4F5C;&#x3002;</p>
<p><code>docker build -t xxx .</code> &#x4E2D;&#x7684;&#x8FD9;&#x4E2A;<code>.</code>&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x5C31;&#x662F;&#x5728;&#x6307;&#x5B9A; <code>Context</code> &#x7684;&#x76EE;&#x5F55;&#xFF0C;&#x800C;&#x5E76;&#x975E;&#x662F;&#x6307;&#x5B9A; <code>Dockerfile</code> &#x6240;&#x5728;&#x76EE;&#x5F55;&#x3002;</p>
<p>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x989D;&#x5916;&#x6307;&#x5B9A; <code>Dockerfile</code> &#x7684;&#x8BDD;&#xFF0C;&#x4F1A;&#x5C06; <code>Context</code> &#x4E0B;&#x7684;&#x540D;&#x4E3A; <code>Dockerfile</code> &#x7684;&#x6587;&#x4EF6;&#x4F5C;&#x4E3A; <code>Dockerfile</code>&#x3002;&#x6240;&#x4EE5;&#x5F88;&#x591A;&#x4EBA;&#x4F1A;&#x6DF7;&#x6DC6;&#xFF0C;&#x8BA4;&#x4E3A;&#x8FD9;&#x4E2A; <code>.</code> &#x662F;&#x5728;&#x8BF4; <code>Dockerfile</code> &#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x5176;&#x5B9E;&#x4E0D;&#x7136;&#x3002;</p>
<h2 id="entrypoint-he-cmd-dao-di-you-shi-me-bu-tong"><a href="#ENTRYPOINT-&#x548C;-CMD-&#x5230;&#x5E95;&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x540C;&#xFF1F;" class="headerlink" title="ENTRYPOINT &#x548C; CMD &#x5230;&#x5E95;&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x540C;&#xFF1F;"></a><code>ENTRYPOINT</code> &#x548C; <code>CMD</code> &#x5230;&#x5E95;&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x540C;&#xFF1F; <a href="#entrypoint-he-cmd-dao-di-you-shi-me-bu-tong" class="header-anchor">#</a></h2><p><code>Dockerfile</code> &#x7684;&#x76EE;&#x7684;&#x662F;&#x5236;&#x4F5C;&#x955C;&#x50CF;&#xFF0C;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x51C6;&#x5907;&#x7684;&#x662F;&#x4E3B;&#x8FDB;&#x7A0B;&#x8FD0;&#x884C;&#x73AF;&#x5883;&#x3002;&#x90A3;&#x4E48;&#x51C6;&#x5907;&#x597D;&#x540E;&#xFF0C;&#x9700;&#x8981;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x624D;&#x53EF;&#x4EE5;&#x542F;&#x52A8;&#x4E3B;&#x8FDB;&#x7A0B;&#xFF0C;&#x800C;&#x542F;&#x52A8;&#x7684;&#x529E;&#x6CD5;&#x5C31;&#x662F;&#x8C03;&#x7528; <code>ENTRYPOINT</code>&#xFF0C;&#x5E76;&#x4E14;&#x628A; <code>CMD</code> &#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x8FDB;&#x53BB;&#x8FD0;&#x884C;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x4E0B;&#x9762;&#x7684;&#x6982;&#x5FF5;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ENTRYPOINT <span class="string">&quot;CMD&quot;</span></div></pre></td></tr></table></figure>
<p>&#x5047;&#x8BBE;&#x6709;&#x4E2A; <code>myubuntu</code> &#x955C;&#x50CF; <code>ENTRYPOINT</code> &#x662F; <code>sh -c</code>&#xFF0C;&#x800C;&#x6211;&#x4EEC; <code>docker run -it myubuntu uname -a</code>&#x3002;&#x90A3;&#x4E48; <code>uname -a</code> &#x5C31;&#x662F;&#x8FD0;&#x884C;&#x65F6;&#x6307;&#x5B9A;&#x7684; <code>CMD</code>&#xFF0C;&#x90A3;&#x4E48; Docker &#x5B9E;&#x9645;&#x8FD0;&#x884C;&#x7684;&#x5C31;&#x662F;&#x7ED3;&#x5408;&#x8D77;&#x6765;&#x7684;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sh -c <span class="string">&quot;uname -a&quot;</span></div></pre></td></tr></table></figure>
<ul>
<li>&#x5982;&#x679C;&#x6CA1;&#x6709;&#x6307;&#x5B9A; <code>ENTRYPOINT</code>&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53EA;&#x6267;&#x884C; <code>CMD</code>&#xFF1B;</li>
<li>&#x5982;&#x679C;&#x6307;&#x5B9A;&#x4E86; <code>ENTRYPOINT</code> &#x800C;&#x6CA1;&#x6709;&#x6307;&#x5B9A; <code>CMD</code>&#xFF0C;&#x81EA;&#x7136;&#x6267;&#x884C; <code>ENTRYPOINT</code>;</li>
<li>&#x5982;&#x679C; <code>ENTRYPOINT</code> &#x548C; <code>CMD</code> &#x90FD;&#x6307;&#x5B9A;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x5982;&#x540C;&#x4E0A;&#x9762;&#x6240;&#x8FF0;&#xFF0C;&#x6267;&#x884C; <code>ENTRYPOINT &quot;CMD&quot;</code>&#xFF1B;</li>
<li>&#x5982;&#x679C;&#x6CA1;&#x6709;&#x6307;&#x5B9A; <code>ENTRYPOINT</code>&#xFF0C;&#x800C; <code>CMD</code> &#x7528;&#x7684;&#x662F;&#x4E0A;&#x8FF0;&#x90A3;&#x79CD; shell &#x547D;&#x4EE4;&#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x5219;&#x81EA;&#x52A8;&#x4F7F;&#x7528; <code>sh -c</code> &#x4F5C;&#x4E3A; <code>ENTRYPOINT</code>&#x3002;</li>
</ul>
<p>&#x6CE8;&#x610F;&#x6700;&#x540E;&#x4E00;&#x70B9;&#x7684;&#x533A;&#x522B;&#xFF0C;&#x8FD9;&#x4E2A;&#x533A;&#x522B;&#x5BFC;&#x81F4;&#x4E86;&#x540C;&#x6837;&#x7684;&#x547D;&#x4EE4;&#x653E;&#x5230; <code>CMD</code> &#x548C; <code>ENTRYPOINT</code> &#x4E0B;&#x6548;&#x679C;&#x4E0D;&#x540C;&#xFF0C;&#x56E0;&#x6B64;&#x6709;&#x53EF;&#x80FD;&#x653E;&#x5728; <code>ENTRYPOINT</code> &#x4E0B;&#x7684;&#x540C;&#x6837;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x7531;&#x4E8E;&#x9700;&#x8981; <code>tty</code> &#x800C;&#x8FD0;&#x884C;&#x65F6;&#x5FD8;&#x8BB0;&#x4E86;&#x7ED9;&#xFF08;&#x6BD4;&#x5982;&#x5FD8;&#x8BB0;&#x4E86;<code>docker-compose.yml</code> &#x7684; <code>tty:true</code>&#xFF09;&#x5BFC;&#x81F4;&#x8FD0;&#x884C;&#x5931;&#x8D25;&#x3002;</p>
<p>&#x8FD9;&#x79CD;&#x7528;&#x6CD5;&#x53EF;&#x4EE5;&#x5F88;&#x7075;&#x6D3B;&#xFF0C;&#x6BD4;&#x5982;&#x6211;&#x4EEC;&#x505A;&#x4E2A; <code>git</code> &#x955C;&#x50CF;&#xFF0C;&#x53EF;&#x4EE5;&#x628A; <code>git</code> &#x547D;&#x4EE4;&#x6307;&#x5B9A;&#x4E3A; <code>ENTRYPOINT</code>&#xFF0C;&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x5728; <code>docker run</code> &#x7684;&#x65F6;&#x5019;&#xFF0C;&#x76F4;&#x63A5;&#x8DDF;&#x5B50;&#x547D;&#x4EE4;&#x5373;&#x53EF;&#x3002;&#x6BD4;&#x5982; <code>docker run git log</code> &#x5C31;&#x662F;&#x663E;&#x793A;&#x65E5;&#x5FD7;&#x3002;</p>
<h2 id="na-dao-yi-ge-jing-xiang-ru-he-huo-de-jing-xiang-de-dockerfile"><a href="#&#x62FF;&#x5230;&#x4E00;&#x4E2A;&#x955C;&#x50CF;&#xFF0C;&#x5982;&#x4F55;&#x83B7;&#x5F97;&#x955C;&#x50CF;&#x7684;-Dockerfile-&#xFF1F;" class="headerlink" title="&#x62FF;&#x5230;&#x4E00;&#x4E2A;&#x955C;&#x50CF;&#xFF0C;&#x5982;&#x4F55;&#x83B7;&#x5F97;&#x955C;&#x50CF;&#x7684; Dockerfile &#xFF1F;"></a>&#x62FF;&#x5230;&#x4E00;&#x4E2A;&#x955C;&#x50CF;&#xFF0C;&#x5982;&#x4F55;&#x83B7;&#x5F97;&#x955C;&#x50CF;&#x7684; <code>Dockerfile</code> &#xFF1F; <a href="#na-dao-yi-ge-jing-xiang-ru-he-huo-de-jing-xiang-de-dockerfile" class="header-anchor">#</a></h2><ul>
<li>&#x76F4;&#x63A5;&#x53BB; Docker Hub &#x4E0A;&#x770B;&#xFF1A;&#x5927;&#x591A;&#x6570; Docker Hub &#x4E0A;&#x7684;&#x955C;&#x50CF;&#x90FD;&#x4F1A;&#x6709; <code>Dockerfile</code>&#xFF0C;&#x76F4;&#x63A5;&#x5728; Docker Hub &#x7684;&#x955C;&#x50CF;&#x9875;&#x9762;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230; <code>Dockerfile</code> &#x7684;&#x94FE;&#x63A5;&#xFF1B;</li>
<li>&#x5982;&#x679C;&#x662F;&#x81EA;&#x5DF1;&#x516C;&#x53F8;&#x505A;&#x7684;&#xFF0C;&#x6700;&#x7B80;&#x5355;&#x7684;&#x529E;&#x6CD5;&#x5C31;&#x662F;&#x6253;&#x4E2A;&#x7535;&#x8BDD;&#x3001;&#x53D1;&#x4E2A;&#x6D88;&#x606F;&#x95EE;&#x4E00;&#x4E0B;&#x3002;&#x522B;&#x770B;&#x8FD9;&#x4E2A;&#x8BF4;&#x6CD5;&#x770B;&#x8D77;&#x6765;&#x5F88;&#x50BB;&#xFF0C;&#x4E0D;&#x5C11;&#x4EBA;&#x90FD;&#x5B81;&#x53EF;&#x81EA;&#x5DF1;&#x7422;&#x78E8;&#x4E5F;&#x4E0D;&#x53BB;&#x95EE;&#xFF1B;</li>
<li>&#x5982;&#x679C;&#x6CA1;&#x6709; <code>Dockerfile</code>&#xFF0C;&#x4E00;&#x822C;&#x8FD9;&#x7C7B;&#x955C;&#x50CF;&#x5C31;&#x4E0D;&#x5E94;&#x8BE5;&#x8003;&#x8651;&#x4F7F;&#x7528;&#x4E86;&#xFF0C;&#x8FD9;&#x7C7B;&#x9ED1;&#x7BB1;&#x4F3C;&#x7684;&#x955C;&#x50CF;&#x5F88;&#x5BB9;&#x6709;&#x6709;&#x95EE;&#x9898;&#x3002;&#x5982;&#x679C;&#x662F;&#x4EC0;&#x4E48;&#x7279;&#x6B8A;&#x539F;&#x56E0;&#xFF0C;&#x90A3;&#x7EE7;&#x7EED;&#x5F80;&#x4E0B;&#x770B;&#xFF1B;</li>
<li><code>docker history</code> &#x53EF;&#x4EE5;&#x770B;&#x5230;&#x955C;&#x50CF;&#x6BCF;&#x4E00;&#x5C42;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x5305;&#x62EC;&#x547D;&#x4EE4;&#xFF0C;&#x5F53;&#x7136;&#x9ED1;&#x7BB1;&#x955C;&#x50CF;&#x7684; <code>commit</code> &#x770B;&#x4E0D;&#x89C1;&#x64CD;&#x4F5C;&#xFF1B;</li>
<li><code>docker inspect</code> &#x53EF;&#x4EE5;&#x5206;&#x6790;&#x955C;&#x50CF;&#x5F88;&#x591A;&#x7EC6;&#x8282;&#x3002;</li>
<li>&#x76F4;&#x63A5;&#x8FD0;&#x884C;&#x955C;&#x50CF;&#xFF0C;&#x8FDB;&#x5165;<code>shell</code>&#xFF0C;&#x7136;&#x540E;&#x6839;&#x636E;&#x4E0A;&#x9762;&#x7684;&#x5206;&#x6790;&#x7ED3;&#x679C;&#x53BB;&#x8FDB;&#x4E00;&#x6B65;&#x5206;&#x6790;&#x65E5;&#x5FD7;&#x3001;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x53CA;&#x53D8;&#x5316;&#x3002;</li>
<li>&#x7ECF;&#x8FC7;&#x5206;&#x6790;&#x540E;&#xFF0C;&#x81EA;&#x5DF1;&#x5199; <code>Dockerfile</code> &#x8FD8;&#x539F;&#x64CD;&#x4F5C;&#x3002;</li>
</ul>
<h2 id="zai-ni-de-lnmp-de-li-zi-zhong-php-de-dockerfile-li-mian-de-gou-jian-yi-lai-he-yun-xing-yi-lai-du-shi-shi-me-yi-si"><a href="#&#x5728;&#x4F60;&#x7684;-LNMP-&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;PHP-&#x7684;-Dockerfile-&#x91CC;&#x9762;&#x7684;-&#x201C;&#x6784;&#x5EFA;&#x4F9D;&#x8D56;&#x201D;-&#x548C;-&#x201C;&#x8FD0;&#x884C;&#x4F9D;&#x8D56;&#x201D;-&#x90FD;&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#xFF1F;" class="headerlink" title="&#x5728;&#x4F60;&#x7684; LNMP &#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;PHP &#x7684; Dockerfile &#x91CC;&#x9762;&#x7684; &#x201C;&#x6784;&#x5EFA;&#x4F9D;&#x8D56;&#x201D; &#x548C; &#x201C;&#x8FD0;&#x884C;&#x4F9D;&#x8D56;&#x201D; &#x90FD;&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#xFF1F;"></a>&#x5728;&#x4F60;&#x7684; LNMP &#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;PHP &#x7684; <code>Dockerfile</code> &#x91CC;&#x9762;&#x7684; &#x201C;&#x6784;&#x5EFA;&#x4F9D;&#x8D56;&#x201D; &#x548C; &#x201C;&#x8FD0;&#x884C;&#x4F9D;&#x8D56;&#x201D; &#x90FD;&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#xFF1F; <a href="#zai-ni-de-lnmp-de-li-zi-zhong-php-de-dockerfile-li-mian-de-gou-jian-yi-lai-he-yun-xing-yi-lai-du-shi-shi-me-yi-si" class="header-anchor">#</a></h2><p>&#x8FD9;&#x91CC;&#x6240;&#x63D0;&#x5230;&#x7684;&#x662F;&#x6211;&#x7684;&#x90A3;&#x4E2A; LNMP &#x4F8B;&#x5B50;&#x7684; <code>php</code> &#x670D;&#x52A1;&#x7684; <code>Dockerfile</code>&#xFF1A;<a href="https://coding.net/u/twang2218/p/docker-lnmp/git/blob/master/php/Dockerfile" target="_blank" rel="external">https://coding.net/u/twang2218/p/docker-lnmp/git/blob/master/php/Dockerfile</a></p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">FROM</span> php:<span class="number">7</span>-fpm</div><div class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">set</span> -xe \</span></div><div class="line"><span class="comment"># &quot;&#x6784;&#x5EFA;&#x4F9D;&#x8D56;&quot;</span></div><div class="line">    &amp;&amp; buildDeps=<span class="string">&quot; \</span></div><div class="line">        build-essential \</div><div class="line">        php5-dev \</div><div class="line">        libfreetype6-dev \</div><div class="line">        libjpeg62-turbo-dev \</div><div class="line">        libmcrypt-dev \</div><div class="line">        libpng12-dev \</div><div class="line">    &quot; \</div><div class="line"><span class="comment"># &quot;&#x8FD0;&#x884C;&#x4F9D;&#x8D56;&quot;</span></div><div class="line">    &amp;&amp; runtimeDeps=<span class="string">&quot; \</span></div><div class="line">        libfreetype6 \</div><div class="line">        libjpeg62-turbo \</div><div class="line">        libmcrypt4 \</div><div class="line">        libpng12-0 \</div><div class="line">    &quot; \</div><div class="line"><span class="comment"># &quot;&#x5B89;&#x88C5; php &#x4EE5;&#x53CA;&#x7F16;&#x8BD1;&#x6784;&#x5EFA;&#x7EC4;&#x4EF6;&#x6240;&#x9700;&#x5305;&quot;</span></div><div class="line">    &amp;&amp; apt-get update \</div><div class="line">    &amp;&amp; apt-get install -y ${runtimeDeps} ${buildDeps} --no-install-recommends \</div><div class="line"><span class="comment"># &quot;&#x7F16;&#x8BD1;&#x5B89;&#x88C5; php &#x7EC4;&#x4EF6;&quot;</span></div><div class="line">    &amp;&amp; docker-php-ext-install iconv mcrypt mysqli pdo pdo_mysql zip \</div><div class="line">    &amp;&amp; docker-php-ext-configure gd \</div><div class="line">        --with-freetype-dir=/usr/include/ \</div><div class="line">        --with-jpeg-dir=/usr/include/ \</div><div class="line">    &amp;&amp; docker-php-ext-install gd \</div><div class="line"><span class="comment"># &quot;&#x6E05;&#x7406;&quot;</span></div><div class="line">    &amp;&amp; apt-get purge -y --auto-remove \</div><div class="line">        -o APT::AutoRemove::RecommendsImportant=false \</div><div class="line">        -o APT::AutoRemove::SuggestsImportant=false \</div><div class="line">        $buildDeps \</div><div class="line">    &amp;&amp; rm -rf /var/cache/apt/* \</div><div class="line">    &amp;&amp; rm -rf /var/lib/apt/lists/*</div></pre></td></tr></table></figure>
<p>&#x8FD9;&#x91CC;&#x662F;&#x9488;&#x5BF9; <code>php</code> &#x955C;&#x50CF;&#x8FDB;&#x884C;&#x5B9A;&#x5236;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B; <code>php:7-fpm</code> &#x4E2D;&#x6CA1;&#x6709;&#x5B89;&#x88C5;&#x6240;&#x9700;&#x7684; <code>mysqli</code>, <code>pdo_mysql</code>, <code>gd</code> &#x7B49;&#x7EC4;&#x4EF6;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x5B89;&#x88C5;&#xFF0C;&#x800C;&#x4E14;&#xFF0C;&#x90E8;&#x5206;&#x7EC4;&#x4EF6;&#x8FD8;&#x9700;&#x8981;&#x7F16;&#x8BD1;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#xFF0C;&#x8FD9;&#x91CC;&#x6D89;&#x53CA;&#x4E86;&#x4E24;&#x7C7B;&#x4F9D;&#x8D56;&#x5E93;/&#x5DE5;&#x5177;&#xFF0C;&#x4E00;&#x7C7B;&#x662F;&#x5B89;&#x88C5;&#x3001;&#x7F16;&#x8BD1;&#x9636;&#x6BB5;&#x6240;&#x9700;&#x8981;&#x7684;&#x4F9D;&#x8D56;&#xFF1B;&#x53E6;&#x4E00;&#x7C7B;&#x662F;&#x8FD0;&#x884C;&#x65F6;&#x6240;&#x9700;&#x7684;&#x4F9D;&#x8D56;&#x3002;&#x8981;&#x8BB0;&#x4F4F; <code>Dockerfile</code> &#x7684;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#x4E2D;&#x8981;&#x6C42;&#x6700;&#x7EC8;&#x955C;&#x50CF;&#x53EA;&#x5E94;&#x8BE5;&#x4FDD;&#x7559;&#x6700;&#x5C0F;&#x7684;&#x6240;&#x9700;&#x4F9D;&#x8D56;&#xFF0C;&#x56E0;&#x6B64;&#x5B89;&#x88C5;&#x6784;&#x5EFA;&#x7684;&#x4F9D;&#x8D56;&#x5E94;&#x8BE5;&#x5728;&#x5B89;&#x88C5;&#x7ED3;&#x675F;&#x540E;&#x6E05;&#x9664;&#xFF0C;&#x8FD9;&#x4E00;&#x5C42;&#x53EA;&#x4FDD;&#x7559;&#x771F;&#x6B63;&#x9700;&#x8981;&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x4F9D;&#x8D56;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#xFF0C;&#x9075;&#x5FAA;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#x7684;&#x8981;&#x6C42;&#xFF0C;&#x8FD9;&#x91CC;&#x533A;&#x5206;&#x4E86; <code>buildDeps</code> &#x548C; <code>runtimeDeps</code> &#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x5B89;&#x88C5;&#x7ED3;&#x675F;&#x540E;&#xFF0C;&#x5378;&#x8F7D;&#x3001;&#x6E05;&#x7406; <code>buildDeps</code> &#x7684;&#x4F9D;&#x8D56;&#x3002;&#x8FD9;&#x6837;&#x786E;&#x4FDD;&#x6CA1;&#x6709;&#x65E0;&#x5173;&#x7684;&#x4E1C;&#x897F;&#x8FD8;&#x5728;&#x8BE5;&#x5C42;&#x4E2D;&#x3002;</p>
<h2 id="ying-yong-dai-ma-shi-ying-gai-gua-zai-su-zhu-mu-lu-huan-shi-fang-ru-jing-xiang-nei"><a href="#&#x5E94;&#x7528;&#x4EE3;&#x7801;&#x662F;&#x5E94;&#x8BE5;&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;&#x8FD8;&#x662F;&#x653E;&#x5165;&#x955C;&#x50CF;&#x5185;&#xFF1F;" class="headerlink" title="&#x5E94;&#x7528;&#x4EE3;&#x7801;&#x662F;&#x5E94;&#x8BE5;&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;&#x8FD8;&#x662F;&#x653E;&#x5165;&#x955C;&#x50CF;&#x5185;&#xFF1F;"></a>&#x5E94;&#x7528;&#x4EE3;&#x7801;&#x662F;&#x5E94;&#x8BE5;&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;&#x8FD8;&#x662F;&#x653E;&#x5165;&#x955C;&#x50CF;&#x5185;&#xFF1F; <a href="#ying-yong-dai-ma-shi-ying-gai-gua-zai-su-zhu-mu-lu-huan-shi-fang-ru-jing-xiang-nei" class="header-anchor">#</a></h2><p>&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#x90FD;&#x53EF;&#x4EE5;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4EE3;&#x7801;&#x53D8;&#x52A8;&#x975E;&#x5E38;&#x9891;&#x7E41;&#xFF0C;&#x6BD4;&#x5982;&#x5F00;&#x53D1;&#x9636;&#x6BB5;&#xFF0C;&#x4EE3;&#x7801;&#x51E0;&#x4E4E;&#x6BCF;&#x51E0;&#x5206;&#x949F;&#x5C31;&#x9700;&#x8981;&#x53D8;&#x52A8;&#x8C03;&#x8BD5;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>--volume</code> &#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;&#x7684;&#x529E;&#x6CD5;&#x3002;&#x8FD9;&#x6837;&#x4E0D;&#x7528;&#x6BCF;&#x6B21;&#x6784;&#x5EFA;&#x65B0;&#x955C;&#x50CF;&#xFF0C;&#x76F4;&#x63A5;&#x518D;&#x6B21;&#x8FD0;&#x884C;&#x5C31;&#x53EF;&#x4EE5;&#x52A0;&#x8F7D;&#x6700;&#x65B0;&#x4EE3;&#x7801;&#xFF0C;&#x751A;&#x81F3;&#x6709;&#x4E9B;&#x5DE5;&#x5177;&#x53EF;&#x4EE5;&#x89C2;&#x5BDF;&#x6587;&#x4EF6;&#x53D8;&#x5316;&#x4ECE;&#x800C;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x63D0;&#x9AD8;&#x5F00;&#x53D1;&#x6548;&#x7387;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4EE3;&#x7801;&#x6CA1;&#x6709;&#x90A3;&#x4E48;&#x9891;&#x7E41;&#x53D8;&#x52A8;&#xFF0C;&#x6BD4;&#x5982;&#x53D1;&#x5E03;&#x9636;&#x6BB5;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x5E94;&#x8BE5;&#x5C06;&#x6784;&#x5EFA;&#x597D;&#x7684;&#x5E94;&#x7528;&#x653E;&#x5165;&#x955C;&#x50CF;&#x3002;&#x4E00;&#x822C;&#x6765;&#x8BF4;&#x662F;&#x4F7F;&#x7528; CI/CD &#x5DE5;&#x5177;&#xFF0C;&#x5982; <code>Jenkins</code>, <code>Drone.io</code>, <code>Gitlab CI</code> &#x7B49;&#xFF0C;&#x8FDB;&#x884C;&#x6784;&#x5EFA;&#x3001;&#x6D4B;&#x8BD5;&#x3001;&#x5236;&#x4F5C;&#x955C;&#x50CF;&#x3001;&#x53D1;&#x5E03;&#x955C;&#x50CF;&#x3001;&#x4EE5;&#x53CA;&#x5206;&#x6B65;&#x53D1;&#x5E03;&#x4E0A;&#x7EBF;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E5F;&#x662F;&#x540C;&#x6837;&#x7684;&#x9053;&#x7406;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x9891;&#x7E41;&#x53D8;&#x66F4;&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x53EF;&#x4EE5;&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#xFF0C;&#x6216;&#x8005;&#x52A8;&#x6001;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5377;&#x3002;&#x4F46;&#x662F;&#x5BF9;&#x4E8E;&#x5E76;&#x975E;&#x9891;&#x7E41;&#x53D8;&#x66F4;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x5E94;&#x8BE5;&#x5C06;&#x5176;&#x7EB3;&#x5165;&#x7248;&#x672C;&#x63A7;&#x5236;&#x4E2D;&#xFF0C;&#x8D70; CI/CD &#x6D41;&#x7A0B;&#x8FDB;&#x884C;&#x90E8;&#x7F72;&#x3002;</p>
<p>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x4E00;&#x70B9;&#x662F;&#xFF0C;&#x7ED1;&#x5B9A;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;&#x867D;&#x7136;&#x65B9;&#x4FBF;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x5229;&#x4E8E;&#x96C6;&#x7FA4;&#x90E8;&#x7F72;&#xFF0C;&#x56E0;&#x4E3A;&#x96C6;&#x7FA4;&#x90E8;&#x7F72;&#x524D;&#x8FD8;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x96C6;&#x7FA4;&#x5404;&#x4E2A;&#x8282;&#x70B9;&#x540C;&#x6B65;&#x5B58;&#x5728;&#x6240;&#x6302;&#x8F7D;&#x7684;&#x76EE;&#x5F55;&#x53CA;&#x5176;&#x5185;&#x5BB9;&#x3002;&#x56E0;&#x6B64;&#x96C6;&#x7FA4;&#x90E8;&#x7F72;&#x66F4;&#x503E;&#x5411;&#x4E8E;&#x5C06;&#x5E94;&#x7528;&#x6253;&#x5165;&#x955C;&#x50CF;&#xFF0C;&#x65B9;&#x4FBF;&#x90E8;&#x7F72;&#x3002;</p>
<h1 id="docker-compose-xiang-guan-wen-ti"><a href="#Docker-Compose-&#x76F8;&#x5173;&#x95EE;&#x9898;" class="headerlink" title="Docker Compose &#x76F8;&#x5173;&#x95EE;&#x9898;"></a>Docker Compose &#x76F8;&#x5173;&#x95EE;&#x9898; <a href="#docker-compose-xiang-guan-wen-ti" class="header-anchor">#</a></h1><h2 id="ni-na-ge-lnmp-li-zi-zhong-de-docker-compose-yml-zhong-you-hao-duo-networks-du-shi-shi-me-yi-si-a"><a href="#&#x4F60;&#x90A3;&#x4E2A;LNMP&#x4F8B;&#x5B50;&#x4E2D;&#x7684;-docker-compose-yml-&#x4E2D;&#x6709;&#x597D;&#x591A;-networks&#xFF0C;&#x90FD;&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#x554A;&#xFF1F;" class="headerlink" title="&#x4F60;&#x90A3;&#x4E2A;LNMP&#x4F8B;&#x5B50;&#x4E2D;&#x7684; docker-compose.yml &#x4E2D;&#x6709;&#x597D;&#x591A; networks&#xFF0C;&#x90FD;&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#x554A;&#xFF1F;"></a>&#x4F60;&#x90A3;&#x4E2A;<code>LNMP</code>&#x4F8B;&#x5B50;&#x4E2D;&#x7684; <code>docker-compose.yml</code> &#x4E2D;&#x6709;&#x597D;&#x591A; <code>networks</code>&#xFF0C;&#x90FD;&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#x554A;&#xFF1F; <a href="#ni-na-ge-lnmp-li-zi-zhong-de-docker-compose-yml-zhong-you-hao-duo-networks-du-shi-shi-me-yi-si-a" class="header-anchor">#</a></h2><p>&#x6211;&#x5199;&#x7684;<code>LNMP</code>&#x591A;&#x5BB9;&#x5668;&#x4E92;&#x901A;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;<a href="https://coding.net/u/twang2218/p/docker-lnmp/git" target="_blank" rel="external">https://coding.net/u/twang2218/p/docker-lnmp/git</a></p>
<p>&#x524D;&#x9762;<code>services</code>&#x4E0B;&#x7684;&#x6BCF;&#x4E2A;&#x670D;&#x52A1;&#x4E0B;&#x9762;&#x7684;<code>networks</code>&#xFF0C;&#x662F;&#x8BF4;&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#x8981;&#x63A5;&#x5230;&#x54EA;&#x4E2A;&#x7F51;&#x7EDC;&#x4E0A;&#x3002;<br>&#x800C;&#x6700;&#x540E;&#x7684;&#x90A3;&#x4E2A;&#x603B;&#x7684;<code>networks</code>&#x4E0B;&#x9762;&#x7684;&#xFF0C;&#x662F;&#x8FD9;&#x51E0;&#x4E2A;&#x7F51;&#x7EDC;&#x7684;&#x5B9A;&#x4E49;&#x3002;</p>
<p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;<code>nginx</code> &#x63A5;&#x5230;&#x4E86;&#x540D;&#x4E3A; <code>frontend</code> &#x7684;&#x524D;&#x7AEF;&#x7F51;&#x7EDC;&#xFF1B;<code>mysql</code> &#x63A5;&#x5230;&#x4E86;&#x540D;&#x4E3A; <code>backend</code> &#x7684;&#x540E;&#x7AEF;&#x7F51;&#x7EDC;&#xFF1B;&#x800C;&#x4F5C;&#x4E3A;&#x4E2D;&#x95F4;&#x7684; <code>php</code> &#x65E2;&#x9700;&#x8981;&#x548C; <code>nginx</code> &#x901A;&#x8BAF;&#xFF0C;&#x53C8;&#x9700;&#x8981;&#x548C; <code>mysql</code> &#x901A;&#x8BAF;&#xFF0C;&#x6240;&#x4EE5;&#x540C;&#x65F6;&#x8FDE;&#x63A5;&#x4E86; <code>frontend</code> &#x548C; <code>backend</code> &#x7F51;&#x7EDC;&#x3002;&#x7531;&#x4E8E; <code>nginx</code> &#x548C; <code>mysql</code> &#x4E0D;&#x5904;&#x4E8E;&#x540C;&#x4E00;&#x7F51;&#x7EDC;&#xFF0C;&#x6240;&#x4EE5;&#x4E8C;&#x8005;&#x65E0;&#x6CD5;&#x901A;&#x8BAF;&#xFF0C;&#x8D77;&#x5230;&#x4E86;&#x9694;&#x79BB;&#x7684;&#x4F5C;&#x7528;&#x3002;</p>
<p>&#x5173;&#x4E8E;Docker&#x81EA;&#x5B9A;&#x4E49;&#x7F51;&#x7EDC;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x4E00;&#x4E0B;&#x5B98;&#x65B9;&#x6587;&#x6863;&#x7684;&#x4ECB;&#x7ECD;&#xFF1A;<br><a href="https://docs.docker.com/engine/userguide/networking/dockernetworks/#/user-defined-networks" target="_blank" rel="external">https://docs.docker.com/engine/userguide/networking/dockernetworks/#/user-defined-networks</a></p>
<p>&#x5173;&#x4E8E;&#x5728;Docker Compose&#x4E2D;&#x4F7F;&#x7528;&#x81EA;&#x5B9A;&#x4E49;&#x7F51;&#x7EDC;&#x7684;&#x90E8;&#x5206;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5B98;&#x65B9;&#x8FD9;&#x90E8;&#x5206;&#x6587;&#x6863;&#xFF1A;<br><a href="https://docs.docker.com/compose/networking/" target="_blank" rel="external">https://docs.docker.com/compose/networking/</a></p>
<h2 id="shi-yong-compose-de-shi-hou-peng-dao-an-http-request-took-too-long-to-complete-cuo-wu-zen-me-ban"><a href="#&#x4F7F;&#x7528;-Compose-&#x7684;&#x65F6;&#x5019;&#x78B0;&#x5230;-&#x201C;An-HTTP-request-took-too-long-to-complete&#x2026;-&#x201D;-&#x9519;&#x8BEF;&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F;" class="headerlink" title="&#x4F7F;&#x7528; Compose &#x7684;&#x65F6;&#x5019;&#x78B0;&#x5230; &#x201C;An HTTP request took too long to complete&#x2026;.&#x201D; &#x9519;&#x8BEF;&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F;"></a>&#x4F7F;&#x7528; Compose &#x7684;&#x65F6;&#x5019;&#x78B0;&#x5230; &#x201C;An HTTP request took too long to complete&#x2026;.&#x201D; &#x9519;&#x8BEF;&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F; <a href="#shi-yong-compose-de-shi-hou-peng-dao-an-http-request-took-too-long-to-complete-cuo-wu-zen-me-ban" class="header-anchor">#</a></h2><p>Compose &#x7684;&#x8BF7;&#x6C42;&#x8D85;&#x65F6;&#x65F6;&#x9650;&#x662F;&#x53EF;&#x4EE5;&#x914D;&#x7F6E;&#x7684;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">export</span> COMPOSE_HTTP_TIMEOUT=120</div></pre></td></tr></table></figure>
<p>&#x4E0D;&#x8FC7;&#xFF0C;&#x8FD9;&#x4E0D;&#x662F;&#x95EE;&#x9898;&#x7684;&#x89E3;&#x51B3;&#x529E;&#x6CD5;&#xFF0C;&#x56E0;&#x4E3A;&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x5E94;&#x8BE5;&#x8D85;&#x65F6;&#xFF0C;&#x8D85;&#x65F6;&#x7684;&#x539F;&#x56E0;&#x662F;&#x56E0;&#x4E3A;&#x6240;&#x8BBF;&#x95EE;&#x7684; Docker Engine &#x8FC7;&#x4E8E;&#x7E41;&#x5FD9;&#xFF0C;&#x800C;&#x65E0;&#x6CD5;&#x54CD;&#x5E94; Compose &#x7684;&#x8BF7;&#x6C42;&#x3002;&#x5E94;&#x8BE5;&#x68C0;&#x67E5;&#x5177;&#x4F53; Docker Engine &#x51FA;&#x4E86;&#x4EC0;&#x4E48;&#x95EE;&#x9898;&#xFF0C;&#x662F;&#x4E0D;&#x662F;&#x8FD8;&#x5728;&#x7528;&#x7740; <code>CentOS</code> &#x9ED8;&#x8BA4;&#x7684; device mapper &#x7684; loop &#x8BBE;&#x5907;&#xFF0C;&#x7B49;&#x7B49;&#x3002;</p>
<h1 id="docker-swarm-xiang-guan-wen-ti"><a href="#Docker-Swarm-&#x76F8;&#x5173;&#x95EE;&#x9898;" class="headerlink" title="Docker Swarm &#x76F8;&#x5173;&#x95EE;&#x9898;"></a>Docker Swarm &#x76F8;&#x5173;&#x95EE;&#x9898; <a href="#docker-swarm-xiang-guan-wen-ti" class="header-anchor">#</a></h1><h2 id="docker-duo-su-zhu-wang-luo-zen-me-pei-zhi"><a href="#Docker-&#x591A;&#x5BBF;&#x4E3B;&#x7F51;&#x7EDC;&#x600E;&#x4E48;&#x914D;&#x7F6E;&#xFF1F;" class="headerlink" title="Docker &#x591A;&#x5BBF;&#x4E3B;&#x7F51;&#x7EDC;&#x600E;&#x4E48;&#x914D;&#x7F6E;&#xFF1F;"></a>Docker &#x591A;&#x5BBF;&#x4E3B;&#x7F51;&#x7EDC;&#x600E;&#x4E48;&#x914D;&#x7F6E;&#xFF1F; <a href="#docker-duo-su-zhu-wang-luo-zen-me-pei-zhi" class="header-anchor">#</a></h2><p>&#x6211;&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x914D;&#x7F6E;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x91CC;&#x770B;&#x3002;<br><a href="https://gist.github.com/twang2218/def4097648deac398a949b58e2a31610" target="_blank" rel="external">https://gist.github.com/twang2218/def4097648deac398a949b58e2a31610</a></p>
<p>&#x5176;&#x4E2D;&#x4E24;&#x4E2A;&#x811A;&#x672C;:</p>
<ul>
<li>&#x5E26;swarm&#x4E00;&#x8D77;&#x73A9; overlay&#xFF1A;<code>build-overlay-with-swarm.sh</code></li>
<li>&#x4E0D;&#x5E26;swarm&#x73A9;&#xFF0C;&#x76F4;&#x63A5;&#x6784;&#x5EFA;overlay&#xFF1A;<code>build-overlay-without-swarm.sh</code></li>
</ul>
<h2 id="swarm-huan-jing-zhong-zen-me-zhi-ding-mou-ge-rong-qi-zai-zhi-ding-de-su-zhu-shang-yun-xing-ni"><a href="#Swarm&#x73AF;&#x5883;&#x4E2D;&#x600E;&#x4E48;&#x6307;&#x5B9A;&#x67D0;&#x4E2A;&#x5BB9;&#x5668;&#x5728;&#x6307;&#x5B9A;&#x7684;&#x5BBF;&#x4E3B;&#x4E0A;&#x8FD0;&#x884C;&#x5462;&#xFF1F;" class="headerlink" title="Swarm&#x73AF;&#x5883;&#x4E2D;&#x600E;&#x4E48;&#x6307;&#x5B9A;&#x67D0;&#x4E2A;&#x5BB9;&#x5668;&#x5728;&#x6307;&#x5B9A;&#x7684;&#x5BBF;&#x4E3B;&#x4E0A;&#x8FD0;&#x884C;&#x5462;&#xFF1F;"></a>Swarm&#x73AF;&#x5883;&#x4E2D;&#x600E;&#x4E48;&#x6307;&#x5B9A;&#x67D0;&#x4E2A;&#x5BB9;&#x5668;&#x5728;&#x6307;&#x5B9A;&#x7684;&#x5BBF;&#x4E3B;&#x4E0A;&#x8FD0;&#x884C;&#x5462;&#xFF1F; <a href="#swarm-huan-jing-zhong-zen-me-zhi-ding-mou-ge-rong-qi-zai-zhi-ding-de-su-zhu-shang-yun-xing-ni" class="header-anchor">#</a></h2><p>&#x6BCF;&#x4E2A; Docker Host &#x5EFA;&#x7ACB;&#x65F6;&#x90FD;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <code>--label</code> &#x6307;&#x5B9A;&#x5176; Docker Daemon &#x7684;&#x6807;&#x7B7E;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">docker daemon \</div><div class="line">    --label com.example.environment=<span class="string">&quot;production&quot;</span> \</div><div class="line">    --label com.example.storage=<span class="string">&quot;ssd&quot;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>&#x6CE8;&#x610F;&#xFF0C;&#x4E0A;&#x9762;&#x7684;&#x914D;&#x7F6E;&#x53C2;&#x6570;&#x5E94;&#x8BE5;&#x914D;&#x7F6E;&#x5728; <code>docker daemon</code> &#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x91CC;&#xFF0C;&#x5982; <code>docker.service</code>&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x7B80;&#x5355;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x6267;&#x884C;&#x2026;&#x2026;</p>
</blockquote>
<p>&#x7136;&#x540E;&#x8FD0;&#x884C;&#x5BB9;&#x5668;&#x65F6;&#xFF0C;&#x4F7F;&#x7528;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x7EA6;&#x675F;&#x8C03;&#x5EA6;&#x5373;&#x53EF;&#x3002;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; Compose &#x6587;&#x4EF6;&#x7684; <code>environment</code> &#x914D;&#x7F6E;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>docker run</code> &#x7684; <code>-e</code> &#x73AF;&#x5883;&#x53D8;&#x91CF;&#x53C2;&#x6570;&#x3002;&#x4E0B;&#x9762;&#x4EE5; Compose &#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E3A;&#x4F8B;&#xFF1A;</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="attr">version:</span> <span class="string">&quot;2&quot;</span></div><div class="line"><span class="attr">services:</span></div><div class="line"><span class="attr">  mongodb:</span></div><div class="line"><span class="attr">    image:</span> mongo:latest</div><div class="line"><span class="attr">    environment:</span></div><div class="line"><span class="bullet">      -</span> <span class="string">&quot;constraint:com.example.storage==ssd&quot;</span></div></pre></td></tr></table></figure>
<p>&#x8FD9;&#x6837;&#x8FD9;&#x4E2A; <code>mongodb</code> &#x7684;&#x670D;&#x52A1;&#x5C31;&#x4F1A;&#x8FD0;&#x884C;&#x5728;&#x6807;&#x8BB0;&#x4E3A; <code>com.example.storage=&quot;ssd&quot;</code> &#x7684;&#x5BBF;&#x4E3B;&#x4E0A;&#x8FD0;&#x884C;&#x3002;</p>
<h2 id="wei-shi-me-swarm-ji-qun-de-overlay-network-kua-su-zhu-wu-fa-hu-fang"><a href="#&#x4E3A;&#x4EC0;&#x4E48;-Swarm-&#x96C6;&#x7FA4;&#x7684;-overlay-network-&#x8DE8;&#x5BBF;&#x4E3B;&#x65E0;&#x6CD5;&#x4E92;&#x8BBF;&#xFF1F;" class="headerlink" title="&#x4E3A;&#x4EC0;&#x4E48; Swarm &#x96C6;&#x7FA4;&#x7684; overlay network &#x8DE8;&#x5BBF;&#x4E3B;&#x65E0;&#x6CD5;&#x4E92;&#x8BBF;&#xFF1F;"></a>&#x4E3A;&#x4EC0;&#x4E48; Swarm &#x96C6;&#x7FA4;&#x7684; overlay network &#x8DE8;&#x5BBF;&#x4E3B;&#x65E0;&#x6CD5;&#x4E92;&#x8BBF;&#xFF1F; <a href="#wei-shi-me-swarm-ji-qun-de-overlay-network-kua-su-zhu-wu-fa-hu-fang" class="header-anchor">#</a></h2><p>&#x9996;&#x5148;&#xFF0C;&#x68C0;&#x67E5;&#x5EFA;&#x7ACB; Swarm &#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5BF9;&#x5176;&#x5B83;&#x8282;&#x70B9;&#x6240;&#x5BA3;&#x544A;&#x7684;&#x672C;&#x8282;&#x70B9;&#x7684;&#x5730;&#x5740;&#x662F;&#x5426;&#x6B63;&#x786E;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x5355;&#x7F51;&#x5361;&#x3001;&#x5355;IP&#x7684;&#x5BBF;&#x4E3B;&#xFF0C;Swarm &#x4F1A;&#x81EA;&#x52A8;&#x9009;&#x62E9;&#x7F51;&#x5361;&#x5730;&#x5740;&#xFF0C;&#x4F46;&#x662F;&#x591A;&#x7F51;&#x5361;&#x3001;&#x591A;IP&#x7684;&#x5BBF;&#x4E3B;&#xFF0C;&#x5C31;&#x5FC5;&#x987B;&#x624B;&#x52A8;&#x5BA3;&#x544A;&#x5730;&#x5740;&#x3002;</p>
<ul>
<li>&#x5BF9;&#x4E8E;&#x4E00;&#x4EE3; Swarm &#x800C;&#x8A00;&#xFF0C;&#x68C0;&#x67E5;&#x4E00;&#x4E0B; <code>docker daemon</code> &#x7684;&#x914D;&#x7F6E;&#x4E2D;&#xFF0C;<code>--cluster-advertise</code> &#x5730;&#x5740;&#x662F;&#x5426;&#x914D;&#x7F6E;&#x6B63;&#x786E;&#x3002;</li>
<li>&#x5BF9;&#x4E8E;&#x4E8C;&#x4EE3; Swarm&#xFF0C;&#x5219;&#x68C0;&#x67E5;&#x4E00;&#x4E0B;&#x521B;&#x5EFA;&#x3001;&#x52A0;&#x5165; Swarm &#x7684;&#x65F6;&#x5019;&#xFF0C;<code>--advertise-addr</code> &#x662F;&#x5426;&#x586B;&#x5199;&#x6B63;&#x786E;&#x3002;</li>
</ul>
<p>&#x5BA3;&#x544A;&#x5730;&#x5740;&#x5FC5;&#x987B;&#x662F;&#x5168;&#x96C6;&#x7FA4;&#x53EF;&#x4EE5;&#x4E92;&#x8BBF;&#x7684;&#xFF0C;&#x7531;&#x4E8E;&#x8BE5;&#x5730;&#x5740;&#x7AEF;&#x53E3;&#x662F; <code>Docker Remote API</code> &#x7AEF;&#x53E3;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x7528; <code>curl</code> &#x6765;&#x8FDE;&#x63A5;&#x5176;&#x5B83;&#x8282;&#x70B9;&#xFF0C;&#x4EE5;&#x5224;&#x65AD;&#x4E92;&#x901A;&#x6027;&#x3002;</p>
<p>&#x7136;&#x540E;&#xFF0C;&#x68C0;&#x67E5;&#x5BBF;&#x4E3B;&#x95F4;&#x7684;&#x7F51;&#x7EDC;&#x4E92;&#x901A;&#x95EE;&#x9898;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x5BBF;&#x4E3B;&#x7684;&#x9632;&#x706B;&#x5899;&#x5F00;&#x542F;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x68C0;&#x67E5;&#x4E0B;&#x5217;&#x670D;&#x52A1;&#x7AEF;&#x53E3;&#x6709;&#x6CA1;&#x6709;&#x653E;&#x5F00;&#xFF1A;</p>
<ul>
<li><code>7946/{udp,tcp}</code></li>
<li><code>4789/{udp,tcp}</code></li>
<li>{<code>2375</code>,<code>2376</code>,<code>2377</code>,<code>3375</code>,<code>3376</code>}/<code>tcp</code> &#xFF08;&#x5177;&#x4F53;&#x7AEF;&#x53E3;&#x53D6;&#x51B3;&#x4E8E;&#x5B9E;&#x9645; <code>Swarm</code> &#x6216; <code>Engine</code> &#x5B88;&#x62A4;&#x7AEF;&#x53E3;)</li>
</ul>
<p>&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <code>telnet</code>, <code>curl</code> &#x4E4B;&#x7C7B;&#x7684;&#x5DE5;&#x5177;&#x786E;&#x4FDD;&#x4E0A;&#x8FF0;&#x7AEF;&#x53E3;&#x53EF;&#x4EE5;&#x4E92;&#x8BBF;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8FD8;&#x662F;&#x6709;&#x95EE;&#x9898;&#xFF0C;&#x53EF;&#x4EE5;&#x8FDB;&#x4E00;&#x6B65;&#x542F;&#x7528;&#x5404;&#x4E2A; <code>docker daemon</code> &#x7684;&#x8C03;&#x8BD5;&#x6A21;&#x5F0F;&#x3002;&#x548C;&#x914D;&#x7F6E; <code>--insecure-registry</code> &#x4E00;&#x6837;&#xFF0C;&#x7F16;&#x8F91; Docker &#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x5728; <code>dockerd</code> &#x540E;&#x6DFB;&#x52A0; <code>-D</code> &#x53C2;&#x6570;&#x3002;&#x7136;&#x540E;&#x91CD;&#x65B0;&#x542F;&#x52A8;&#xFF0C;&#x5EFA;&#x7ACB;&#x96C6;&#x7FA4;&#x3001;&#x7F51;&#x7EDC;&#x3001;&#x670D;&#x52A1;&#x3002;&#x5982;&#x679C;&#x95EE;&#x9898;&#x91CD;&#x73B0;&#xFF0C;&#x53EF;&#x4EE5;&#x5206;&#x6790; <code>Docker Daemon</code> &#x7684;&#x65E5;&#x5FD7;&#xFF0C;&#x5177;&#x4F53;&#x67E5;&#x770B;&#x65E5;&#x5FD7;&#x7684;&#x65B9;&#x6CD5;&#x89C1;&#x524D;&#x9762;&#x7684;&#x95EE;&#x7B54;&#x3002;</p>
<p>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x4E8C;&#x4EE3; Swarm &#x521B;&#x5EFA;&#x7684;<code>service</code>&#x9ED8;&#x8BA4;&#x7684; <code>--endpoint-mode</code> &#x662F; <code>vip</code>&#xFF0C;&#x4E5F;&#x5C31;&#x662F;<code>&#x865A;&#x62DF;IP</code>&#xFF0C;&#x5229;&#x7528;<code>IPVS</code>&#x505A;&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#x7684;&#x90A3;&#x4E2A;&#x3002;&#x4F7F;&#x7528;&#x670D;&#x52A1;&#x540D;&#x89E3;&#x6790;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x8FD4;&#x56DE;&#x8FD9;&#x4E2A;<code>vip</code>&#x5730;&#x5740;&#xFF0C;&#x8BE5;&#x5730;&#x5740;&#x662F;&#x65E0;&#x6CD5;&#x8DE8;&#x5BBF;&#x4E3B; <code>ping</code> &#x7684;&#x3002;&#x56E0;&#x6B64;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x8981;&#x9A8C;&#x8BC1;&#x8DE8;&#x5BBF;&#x4E3B;&#x670D;&#x52A1;&#x4E92;&#x901A;&#x6027;&#xFF0C;&#x5E94;&#x8BE5;&#x76F4;&#x63A5;&#x786E;&#x8BA4;<code>TCP</code>&#x6216;<code>UDP</code>&#x670D;&#x52A1;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x3002;&#x5982;&#x679C;&#x5FC5;&#x987B;<code>ping</code>&#xFF0C;&#x90A3;&#x4E48;&#x4E0D;&#x8981;&#x53BB;<code>ping</code>&#x8FD9;&#x4E2A;<code>vip</code>&#xFF0C;&#x4F7F;&#x7528;&#x670D;&#x52A1;&#x5BB9;&#x5668;&#x771F;&#x5B9E;&#x5730;&#x5740;<code>tasks.&lt;&#x670D;&#x52A1;&#x540D;&gt;</code>&#xFF0C;&#x6BD4;&#x5982;&#x670D;&#x52A1;&#x540D;&#x4E3A;<code>web</code>&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4F7F;&#x7528;&#x547D;&#x4EE4;<code>ping tasks.web</code>&#x3002;</p>
<p>&#x53C2;&#x8003;&#xFF1A;</p>
<p><a href="https://docs.docker.com/swarm/plan-for-production/" target="_blank" rel="external">https://docs.docker.com/swarm/plan-for-production/</a></p>
<p><a href="https://docs.docker.com/engine/swarm/swarm-tutorial/#/open-ports-between-the-hosts" target="_blank" rel="external">https://docs.docker.com/engine/swarm/swarm-tutorial/#/open-ports-between-the-hosts</a></p>
<p><a href="https://docs.docker.com/engine/swarm/networking/" target="_blank" rel="external">https://docs.docker.com/engine/swarm/networking/</a></p>
<h2 id="docker-er-dai-swarm-ji-swarm-mode-docker-service-create-bu-ke-yi-shi-yong-v-na-zen-me-shi-yong-juan-volume"><a href="#Docker-&#x4E8C;&#x4EE3;Swarm-&#x65E2;-Swarm-Mode-&#xFF0C;docker-service-create-&#x4E0D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;-v-&#x90A3;&#x600E;&#x4E48;&#x4F7F;&#x7528;&#x5377;-Volume-&#xFF1F;" class="headerlink" title="Docker &#x4E8C;&#x4EE3;Swarm (&#x65E2; Swarm Mode)&#xFF0C;docker service create &#x4E0D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; -v &#x90A3;&#x600E;&#x4E48;&#x4F7F;&#x7528;&#x5377;(Volume)&#xFF1F;"></a>Docker &#x4E8C;&#x4EE3;Swarm (&#x65E2; Swarm Mode)&#xFF0C;<code>docker service create</code> &#x4E0D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>-v</code> &#x90A3;&#x600E;&#x4E48;&#x4F7F;&#x7528;&#x5377;(Volume)&#xFF1F; <a href="#docker-er-dai-swarm-ji-swarm-mode-docker-service-create-bu-ke-yi-shi-yong-v-na-zen-me-shi-yong-juan-volume" class="header-anchor">#</a></h2><p>&#x4ECE;&#x4E8C;&#x4EE3; Swarm &#x5F00;&#x59CB;&#xFF0C;&#x5C06;&#x4F7F;&#x7528; <code>--mount</code> &#x53C2;&#x6570;&#x6765;&#x8FDB;&#x884C;&#x5377;&#x6302;&#x8F7D;&#xFF0C;&#x5E76;&#x4E14;&#x5BF9;&#x8BED;&#x4E49;&#x8FDB;&#x884C;&#x66F4;&#x660E;&#x786E;&#x7684;&#x5212;&#x5206;&#x3002;</p>
<p>&#x6302;&#x8F7D;&#x5206;&#x4E24;&#x79CD;&#xFF1A;</p>
<ul>
<li>&#x7ED1;&#x5B9A;&#x6302;&#x8F7D; <code>bind-mount</code>&#xFF1A;&#x8FD9;&#x7C7B;&#x6302;&#x8F7D;&#x5C06;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;/&#x6587;&#x4EF6;&#x7ED1;&#x5B9A;&#x5230;&#x5BB9;&#x5668;&#x7684;&#x67D0;&#x4E2A;&#x4F4D;&#x7F6E;&#x3002;&#x8FD9;&#x7C7B;&#x6302;&#x8F7D;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x5BBF;&#x4E3B;&#x548C;&#x5BB9;&#x5668;&#x7684;&#x4E0D;&#x540C;uid&#x5BFC;&#x81F4;&#x7684;&#x6743;&#x9650;&#x3001;&#x8BBF;&#x95EE;&#x63A7;&#x5236;&#x5DEE;&#x5F02;&#x95EE;&#x9898;&#x3002;</li>
<li>&#x6570;&#x636E;&#x5377; <code>data volumes</code>&#xFF1A;&#x8FD9;&#x7C7B;&#x6302;&#x8F7D;&#x662F;&#x4E4B;&#x524D;&#x63A8;&#x8350;&#x4F7F;&#x7528;&#x7684;&#x5377;&#x3002;&#x5377;&#x53EF;&#x4EE5;&#x5206;&#x4E3A;&#x547D;&#x540D;&#x5377;<code>named volume</code>&#x4EE5;&#x53CA;&#x533F;&#x540D;&#x5377;<code>anonymous volume</code></li>
</ul>
<p>&#x6302;&#x8F7D;&#x53C2;&#x6570;&#x7684;&#x683C;&#x5F0F;&#x57FA;&#x672C;&#x4E0A;&#x4E3A; <code>--mount &lt;key1&gt;=&lt;value1&gt;[,&lt;key2&gt;=&lt;value2&gt;,...]</code>&#x3002;</p>
<p>&#x4E3B;&#x8981;&#x53C2;&#x6570;&#x6709;&#xFF1A;</p>
<ul>
<li><code>type</code>: &#x5982;&#x4E4B;&#x524D;&#x6240;&#x8BF4;&#xFF0C;&#x4E24;&#x79CD;&#x7C7B;&#x578B;&#xFF1A; <code>volume</code> &#x548C; <code>bind</code>&#x3002;&#x5982;&#x679C;&#x4E0D;&#x6307;&#x5B9A; <code>type</code>&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A; <code>volume</code>&#xFF1B;</li>
<li><code>src</code> &#x6216; <code>source</code>&#xFF1A;&#x6E90;&#xFF1A;<ul>
<li>&#x5982;&#x679C; <code>type=volume</code>&#xFF0C;<code>src</code> &#x5219;&#x662F;&#x5377;&#x7684;&#x540D;&#x5B57;&#xFF0C;&#x662F;&#x53EF;&#x9009;&#x9879;&#x3002;&#x5982;&#x679C;&#x5B58;&#x5728;&#x5C31;&#x662F;&#x547D;&#x540D;&#x5377;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6307;&#x5B9A; <code>src</code> &#x5219;&#x662F;&#x533F;&#x540D;&#x5377;&#xFF1B;</li>
<li>&#x5982;&#x679C; <code>type=bind</code>&#xFF0C;<code>src</code> &#x662F;&#x5BBF;&#x4E3B;&#x672C;&#x5730;&#x7684;&#x8DEF;&#x5F84;&#xFF1B;</li>
</ul>
</li>
<li><code>dst</code> &#x6216; <code>destination</code> &#x6216; <code>target</code>&#xFF1A;&#x5C06;&#x5728;&#x5BB9;&#x5668;&#x5185;&#x6302;&#x8F7D;&#x7684;&#x8DEF;&#x5F84;&#x3002;&#x5982;&#x679C;&#x8DEF;&#x5F84;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x4F1A;&#x5728;&#x6302;&#x8F7D;&#x524D;&#x81EA;&#x52A8;&#x5EFA;&#x7ACB;&#x8DEF;&#x5F84;&#x3002;</li>
<li><code>readonly</code> &#x6216; <code>ro</code>&#xFF1A;&#x662F;&#x5426;&#x8BA9;&#x8BE5;&#x6302;&#x8F7D;&#x4E3A;&#x53EA;&#x8BFB;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;&#x8BFB;&#x5199;&#x3002;</li>
</ul>
<p>&#x9664;&#x6B64;&#x4E4B;&#x5916;&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x5E38;&#x89C1;&#x7684;&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#xFF1A;</p>
<ul>
<li><code>volume-driver</code>&#xFF1A;&#x6307;&#x5B9A;&#x5377;&#x9A71;&#x52A8;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F; <code>local</code>&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x5176;&#x5B83;&#xFF08;&#x5982; <code>flocker</code>, <code>glusterfs</code>, <code>ceph</code>&#xFF09;&#x4E4B;&#x7C7B;&#x7684;&#x9A71;&#x52A8;&#xFF1B;</li>
<li><code>volume-label</code>&#xFF1A;&#x6307;&#x5B9A;&#x5377;&#x7684;&#x5143;&#x6570;&#x636E;(metadata)&#xFF0C;&#x4ECE;&#x800C;&#x65B9;&#x4FBF;&#x8FC7;&#x6EE4;&#x64CD;&#x4F5C;&#xFF1B;</li>
<li><code>volume-opt</code>&#xFF1A;&#x4E0D;&#x540C;&#x7684;&#x5377;&#x9A71;&#x52A8;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x989D;&#x5916;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x8FD9;&#x4E2A;&#x9009;&#x9879;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x8FD9;&#x4E9B;&#x53C2;&#x6570;&#x3002;</li>
</ul>
<p><code>--mount</code> &#x548C; <code>--volume</code> &#x6709;&#x4E00;&#x4E9B;&#x5DEE;&#x5F02;&#x9700;&#x8981;&#x6CE8;&#x610F;&#xFF1A;</p>
<ul>
<li><code>--mount</code> &#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x5377;&#xFF0C;&#x800C;&#x65E0;&#x9700;&#x4E8B;&#x5148;&#x4F7F;&#x7528; <code>docker volume create</code> &#x6765;&#x521B;&#x5EFA;&#x5377;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x591A;&#x7EC4;&#x4E0D;&#x540C;&#x9A71;&#x52A8;&#x7684;&#x5377;&#xFF1B;</li>
<li><code>--mount</code> &#x5982;&#x679C; <code>type=bind</code> &#x7684;&#x8BDD;&#xFF0C;&#x5BBF;&#x4E3B;&#x5FC5;&#x987B;&#x5B58;&#x5728;&#x6307;&#x5B9A;&#x76EE;&#x5F55;&#xFF0C;&#x5426;&#x5219;&#x62A5;&#x9519;&#x3002;&#x800C; <code>--volume</code> &#x5219;&#x5728;&#x5BBF;&#x4E3B;&#x4E0D;&#x5B58;&#x5728;&#x8BE5;&#x8DEF;&#x5F84;&#x65F6;&#xFF0C;&#x5728;&#x5BBF;&#x4E3B;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7A7A;&#x76EE;&#x5F55;&#x6765;&#x8FDB;&#x884C;&#x7ED1;&#x5B9A;&#x3002;</li>
</ul>
<p>&#x4E3E;&#x51E0;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A;</p>
<p>&#x6302;&#x8F7D;&#x547D;&#x540D;&#x5377;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">docker service create \</div><div class="line">  --name my-service \</div><div class="line">  --replicas 3 \</div><div class="line">  --mount <span class="built_in">type</span>=volume,<span class="built_in">source</span>=my-volume,destination=/path/<span class="keyword">in</span>/container,volume-label=<span class="string">&quot;color=red&quot;</span>,volume-label=<span class="string">&quot;shape=round&quot;</span> \</div><div class="line">  nginx:alpine</div></pre></td></tr></table></figure>
<p>&#x6302;&#x8F7D;&#x533F;&#x540D;&#x5377;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">docker service create \</div><div class="line">  --name my-service \</div><div class="line">  --replicas 3 \</div><div class="line">  --mount <span class="built_in">type</span>=volume,destination=/path/<span class="keyword">in</span>/container \</div><div class="line">  nginx:alpine</div></pre></td></tr></table></figure>
<p>&#x7ED1;&#x5B9A;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">docker service create \</div><div class="line"> --name my-service \</div><div class="line"> --mount <span class="built_in">type</span>=<span class="built_in">bind</span>,<span class="built_in">source</span>=/path/on/host,destination=/path/<span class="keyword">in</span>/container \</div><div class="line"> nginx:alpine</div></pre></td></tr></table></figure>
<p>&#x53C2;&#x8003;&#x5B98;&#x7F51;&#x6587;&#x6863;&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/service_create/#/add-bind-mounts-or-volumes" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/service_create/#/add-bind-mounts-or-volumes</a></p>
<h2 id="dui-yu-liang-jie-dian-ji-qun-lai-shuo-replicas-2-he-mode-global-shi-bu-shi-yi-ge-yi-si"><a href="#&#x5BF9;&#x4E8E;&#x4E24;&#x8282;&#x70B9;&#x96C6;&#x7FA4;&#x6765;&#x8BF4;&#xFF0C;-replicas-2-&#x548C;-mode-global-&#x662F;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x610F;&#x601D;&#xFF1F;" class="headerlink" title="&#x5BF9;&#x4E8E;&#x4E24;&#x8282;&#x70B9;&#x96C6;&#x7FA4;&#x6765;&#x8BF4;&#xFF0C;--replicas=2 &#x548C; --mode=global &#x662F;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x610F;&#x601D;&#xFF1F;"></a>&#x5BF9;&#x4E8E;&#x4E24;&#x8282;&#x70B9;&#x96C6;&#x7FA4;&#x6765;&#x8BF4;&#xFF0C;<code>--replicas=2</code> &#x548C; <code>--mode=global</code> &#x662F;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x610F;&#x601D;&#xFF1F; <a href="#dui-yu-liang-jie-dian-ji-qun-lai-shuo-replicas-2-he-mode-global-shi-bu-shi-yi-ge-yi-si" class="header-anchor">#</a></h2><p>&#x9996;&#x5148;&#xFF0C;&#x4E8C;&#x8005;&#x8BED;&#x4E49;&#x5C31;&#x4E0D;&#x540C;&#x3002;</p>
<ul>
<li><code>--replicas=2</code>&#xFF0C;&#x662F;&#x8981;&#x6C42;&#x8BE5;&#x670D;&#x52A1;&#x6709;2&#x4E2A;&#x526F;&#x672C;&#xFF0C;&#x65E0;&#x8BBA;&#x96C6;&#x7FA4;&#x591A;&#x5C11;&#x4E2A;&#x8282;&#x70B9;&#xFF0C;&#x4E5F;&#x4E0D;&#x5728;&#x4E4E;&#x8FD9;&#x4E24;&#x4E2A;&#x526F;&#x672C;&#x662F;&#x4E0D;&#x662F;&#x90FD;&#x8DD1;&#x5728;&#x4E00;&#x4E2A;&#x5BBF;&#x4E3B;&#x4E0A;&#xFF0C;&#x6240;&#x4EE5;&#x65E0;&#x6CD5;&#x786E;&#x4FDD;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x4E00;&#x4E2A;&#x526F;&#x672C;&#xFF1B;</li>
<li><code>--mode=global</code>&#xFF0C;&#x662F;&#x8981;&#x6C42;&#x670D;&#x52A1;&#x5728;&#x96C6;&#x7FA4;&#x6BCF;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x4E0A;&#x8DD1;&#x4E00;&#x4E2A;&#x526F;&#x672C;&#x3002;</li>
</ul>
<p>&#x73B0;&#x8C61;&#x4E0A;&#x4E5F;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;<code>--replicas=2</code> &#x662F;&#x8981;&#x786E;&#x4FDD;&#x526F;&#x672C;&#x4E3A;2&#x4E2A;&#x3002;&#x90A3;&#x4E48;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x6302;&#x4E86;&#xFF0C;&#x4F1A;&#x5728;&#x53E6;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x4E0A;&#x5728;&#x8D77;&#x4E00;&#x4E2A;&#x526F;&#x672C;&#xFF0C;&#x4ECE;&#x800C;&#x786E;&#x4FDD;&#x526F;&#x672C;&#x6570;&#x4E3A;2&#x3002;&#x800C;&#x5BF9;&#x4E8E; <code>--mode=global</code> &#x6765;&#x8BF4;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x6302;&#x4E86;&#xFF0C;&#x4E0D;&#x4F1A;&#x518D;&#x53E6;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x4E0A;&#x8D77;&#x4E00;&#x4E2A;&#x526F;&#x672C;&#x3002;</p>
<h1 id="docker-machine-xiang-guan-wen-ti"><a href="#Docker-Machine-&#x76F8;&#x5173;&#x95EE;&#x9898;" class="headerlink" title="Docker Machine &#x76F8;&#x5173;&#x95EE;&#x9898;"></a>Docker Machine &#x76F8;&#x5173;&#x95EE;&#x9898; <a href="#docker-machine-xiang-guan-wen-ti" class="header-anchor">#</a></h1><h2 id="ru-he-zai-docker-toolbox-zhong-chuang-jian-de-default-xu-ni-ji-zhong-tian-jia-docker-opts-zhi-lei-de-pei-zhi"><a href="#&#x5982;&#x4F55;&#x5728;-Docker-Toolbox-&#x4E2D;&#x521B;&#x5EFA;&#x7684;-default-&#x865A;&#x62DF;&#x673A;&#x4E2D;&#x6DFB;&#x52A0;DOCKER-OPTS&#x4E4B;&#x7C7B;&#x7684;&#x914D;&#x7F6E;&#xFF1F;" class="headerlink" title="&#x5982;&#x4F55;&#x5728; Docker Toolbox &#x4E2D;&#x521B;&#x5EFA;&#x7684; default &#x865A;&#x62DF;&#x673A;&#x4E2D;&#x6DFB;&#x52A0;DOCKER_OPTS&#x4E4B;&#x7C7B;&#x7684;&#x914D;&#x7F6E;&#xFF1F;"></a>&#x5982;&#x4F55;&#x5728; Docker Toolbox &#x4E2D;&#x521B;&#x5EFA;&#x7684; <code>default</code> &#x865A;&#x62DF;&#x673A;&#x4E2D;&#x6DFB;&#x52A0;<code>DOCKER_OPTS</code>&#x4E4B;&#x7C7B;&#x7684;&#x914D;&#x7F6E;&#xFF1F; <a href="#ru-he-zai-docker-toolbox-zhong-chuang-jian-de-default-xu-ni-ji-zhong-tian-jia-docker-opts-zhi-lei-de-pei-zhi" class="header-anchor">#</a></h2><p>&#x5176;&#x5B9E;&#x5728;&#x6700;&#x521D;&#x521B;&#x5EFA;&#x8BE5;docker host&#x65F6;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5229;&#x7528; <code>docker-machine</code> &#x6307;&#x5B9A;&#x5F15;&#x64CE;&#x914D;&#x7F6E;&#x53C2;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x8981;&#x7D27;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;rm&#x6389;&#x8FD9;&#x4E2A;&#x865A;&#x62DF;&#x673A;&#xFF0C;&#x91CD;&#x65B0;&#x5EFA;&#x7ACB;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4E0D;&#x65B9;&#x4FBF; rm &#x6389;&#x8FD9;&#x4E2A;&#x865A;&#x62DF;&#x673A;&#xFF0C;&#x53EF;&#x4EE5; <code>docker-machine ssh</code> &#x8FDB;&#x5165;&#x8FD9;&#x4E2A;&#x865A;&#x62DF;&#x673A;&#xFF0C;&#x7136;&#x540E;&#x4FEE;&#x6539; <code>/var/lib/boot2docker/profile</code> &#x6587;&#x4EF6;&#xFF0C;&#x4FEE;&#x6539;&#x91CC;&#x9762;&#x7684; <code>EXTRA_ARGS</code> &#x53C2;&#x6570;&#x5373;&#x53EF;&#x3002;</p>
<h2 id="docker-machine-chuang-jian-de-zhu-ji-zen-me-zhi-jie-ssh-jin-qu-gai-liao-root-mi-ma-hao-xiang-ye-mei-yong"><a href="#docker-machine-&#x521B;&#x5EFA;&#x7684;&#x4E3B;&#x673A;&#x600E;&#x4E48;&#x76F4;&#x63A5;-ssh-&#x8FDB;&#x53BB;&#xFF1F;&#x6539;&#x4E86;-root-&#x5BC6;&#x7801;&#x597D;&#x50CF;&#x4E5F;&#x6CA1;&#x7528;&#xFF1F;" class="headerlink" title="docker-machine &#x521B;&#x5EFA;&#x7684;&#x4E3B;&#x673A;&#x600E;&#x4E48;&#x76F4;&#x63A5; ssh &#x8FDB;&#x53BB;&#xFF1F;&#x6539;&#x4E86; root &#x5BC6;&#x7801;&#x597D;&#x50CF;&#x4E5F;&#x6CA1;&#x7528;&#xFF1F;"></a><code>docker-machine</code> &#x521B;&#x5EFA;&#x7684;&#x4E3B;&#x673A;&#x600E;&#x4E48;&#x76F4;&#x63A5; <code>ssh</code> &#x8FDB;&#x53BB;&#xFF1F;&#x6539;&#x4E86; <code>root</code> &#x5BC6;&#x7801;&#x597D;&#x50CF;&#x4E5F;&#x6CA1;&#x7528;&#xFF1F; <a href="#docker-machine-chuang-jian-de-zhu-ji-zen-me-zhi-jie-ssh-jin-qu-gai-liao-root-mi-ma-hao-xiang-ye-mei-yong" class="header-anchor">#</a></h2><p><code>docker-machine</code> &#x521B;&#x5EFA;&#x7684;&#x4E3B;&#x673A;&#xFF0C;&#x4F1A;&#x9075;&#x5FAA;&#x5B89;&#x5168;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#xFF0C;&#x56E0;&#x6B64;&#x4E00;&#x822C;&#x4E0D;&#x4F1A;&#x5141;&#x8BB8; <code>root</code> &#x767B;&#x5F55;&#xFF0C;&#x800C;&#x4E14;&#x4E00;&#x822C;&#x4E0D;&#x4F1A;&#x5141;&#x8BB8;&#x5BC6;&#x7801;&#x767B;&#x5F55;&#xFF0C;&#x53EA;&#x5141;&#x8BB8;<code>&#x5BC6;&#x94A5;</code>&#x767B;&#x5F55;&#xFF08;&#x4E5F;&#x5C31;&#x662F;&#x5F88;&#x591A;&#x56FD;&#x5185;&#x6587;&#x7AE0;&#x79F0;&#x4E3A;&#x7684;&#x514D;&#x5BC6;&#x767B;&#x5F55;&#xFF0C;&#x5176;&#x5B9E;&#x5E76;&#x975E;&#x514D;&#x5BC6;&#xFF09;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#xFF0C;&#x4F7F;&#x7528;&#x5BC6;&#x94A5; <code>~/.docker/machine/machines/&lt;&#x673A;&#x5668;&#x540D;&gt;/id_rsa</code> &#x767B;&#x5F55;&#x5373;&#x53EF;&#x3002;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ssh -i ~/.docker/machine/machines/default/id_rsa \</div><div class="line">    -o UserKnownHostsFile=/dev/null \</div><div class="line">    -o StrictHostKeyChecking=no \</div><div class="line">    docker@$(docker-machine ip default)</div></pre></td></tr></table></figure>
<p>&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#x8FDE;&#x63A5;&#x7684;&#x662F; <code>default</code> &#x8FD9;&#x4E2A;&#x673A;&#x5668;&#xFF0C;&#x9700;&#x8981;&#x8FDE;&#x63A5;&#x5176;&#x5B83;&#x7684;&#x673A;&#x5668;&#x6362;&#x6210;&#x522B;&#x7684;&#x5373;&#x53EF;&#x3002;&#x53E6;&#x5916;&#x7684;&#x4E24;&#x4E2A; <code>-o</code> &#x7684;&#x53C2;&#x6570;&#x662F;&#x8BA9;&#x5176;&#x4E0D;&#x8981;&#x6821;&#x9A8C;&#x670D;&#x52A1;&#x5668;&#x5BC6;&#x94A5;&#xFF0C;&#x8FD9;&#x5F53;&#x7136;&#x662F;&#x4E0D;&#x5B89;&#x5168;&#x7684;&#xFF0C;&#x4E0D;&#x8FC7;&#x8FD9;&#x91CC;&#x53EA;&#x662F;&#x8BD5;&#x9A8C;&#x7684;&#x865A;&#x62DF;&#x673A;&#xFF0C;&#x6240;&#x4EE5;&#x6CA1;&#x5173;&#x7CFB;&#x3002;</p>
<h2 id="docker-machine-shi-yong-d-generic-shi-zhi-ding-yong-hu-generic-ssh-user-hou-fa-xian-yao-sudo-mi-ma-jie-guo-bao-cuo-tui-chu-zhe-shi-zen-me-hui-shi"><a href="#docker-machine-&#x4F7F;&#x7528;-d-generic-&#x65F6;&#xFF0C;&#x6307;&#x5B9A;&#x7528;&#x6237;-generic-ssh-user-&#x540E;&#x53D1;&#x73B0;&#x8981;-sudo-&#x5BC6;&#x7801;&#xFF0C;&#x7ED3;&#x679C;&#x62A5;&#x9519;&#x9000;&#x51FA;&#xFF0C;&#x8FD9;&#x662F;&#x600E;&#x4E48;&#x56DE;&#x4E8B;&#xFF1F;" class="headerlink" title="docker-machine &#x4F7F;&#x7528; -d generic &#x65F6;&#xFF0C;&#x6307;&#x5B9A;&#x7528;&#x6237; --generic-ssh-user &#x540E;&#x53D1;&#x73B0;&#x8981; sudo &#x5BC6;&#x7801;&#xFF0C;&#x7ED3;&#x679C;&#x62A5;&#x9519;&#x9000;&#x51FA;&#xFF0C;&#x8FD9;&#x662F;&#x600E;&#x4E48;&#x56DE;&#x4E8B;&#xFF1F;"></a><code>docker-machine</code> &#x4F7F;&#x7528; <code>-d generic</code> &#x65F6;&#xFF0C;&#x6307;&#x5B9A;&#x7528;&#x6237; <code>--generic-ssh-user</code> &#x540E;&#x53D1;&#x73B0;&#x8981; <code>sudo</code> &#x5BC6;&#x7801;&#xFF0C;&#x7ED3;&#x679C;&#x62A5;&#x9519;&#x9000;&#x51FA;&#xFF0C;&#x8FD9;&#x662F;&#x600E;&#x4E48;&#x56DE;&#x4E8B;&#xFF1F; <a href="#docker-machine-shi-yong-d-generic-shi-zhi-ding-yong-hu-generic-ssh-user-hou-fa-xian-yao-sudo-mi-ma-jie-guo-bao-cuo-tui-chu-zhe-shi-zen-me-hui-shi" class="header-anchor">#</a></h2><p>&#x4F60;&#x5E94;&#x8BE5;&#x518D;&#x4ED4;&#x7EC6;&#x770B;&#x770B; <code>generic</code> &#x7684;&#x5B98;&#x65B9;&#x6587;&#x6863;&#xFF1A;<a href="https://docs.docker.com/machine/drivers/generic/#/sudo-privileges" target="_blank" rel="external">https://docs.docker.com/machine/drivers/generic/#/sudo-privileges</a></p>
<p>&#x91CC;&#x9762;&#x8BF4;&#x7684;&#x5F88;&#x6E05;&#x695A;&#xFF0C;&#x9ED8;&#x8BA4;&#x7528;&#x6237;&#x662F; <code>root</code>&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x901A;&#x8FC7; <code>--generic-ssh-user</code> &#x6307;&#x5B9A;&#x5176;&#x5B83;&#x7528;&#x6237;&#x7684;&#x8BDD;&#xFF0C;&#x8BE5;&#x7528;&#x6237;&#x5FC5;&#x987B;&#x62E5;&#x6709;&#x65E0;&#x5BC6;&#x7801;<code>sudo</code>&#x7684;&#x80FD;&#x529B;&#xFF0C;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x5C31;&#x662F;&#x5728; <code>sudoers</code> &#x6587;&#x4EF6;&#x4E2D;&#x5BF9;&#x8BE5;&#x7528;&#x6237;&#x914D;&#x7F6E; <code>NOPASSWD</code>&#x3002;</p>
<h1 id="docker-registry-xiang-guan-wen-ti"><a href="#Docker-Registry-&#x76F8;&#x5173;&#x95EE;&#x9898;" class="headerlink" title="Docker Registry &#x76F8;&#x5173;&#x95EE;&#x9898;"></a>Docker Registry &#x76F8;&#x5173;&#x95EE;&#x9898; <a href="#docker-registry-xiang-guan-wen-ti" class="header-anchor">#</a></h1><h2 id="wo-docker-push-de-shi-hou-zen-me-bao-authentication-required-cuo-wu"><a href="#&#x6211;-docker-push-&#x7684;&#x65F6;&#x5019;&#x600E;&#x4E48;&#x62A5;-authentication-required-&#x9519;&#x8BEF;&#xFF1F;" class="headerlink" title="&#x6211; docker push &#x7684;&#x65F6;&#x5019;&#x600E;&#x4E48;&#x62A5; authentication required &#x9519;&#x8BEF;&#xFF1F;"></a>&#x6211; <code>docker push</code> &#x7684;&#x65F6;&#x5019;&#x600E;&#x4E48;&#x62A5; <code>authentication required</code> &#x9519;&#x8BEF;&#xFF1F; <a href="#wo-docker-push-de-shi-hou-zen-me-bao-authentication-required-cuo-wu" class="header-anchor">#</a></h2><p>&#x56E0;&#x4E3A;&#x4F60;&#x6CA1;&#x6709;&#x767B;&#x5F55;&#x3002;&#x5982;&#x679C;&#x662F;&#x5411; Docker Hub &#x63A8;&#x9001;&#x955C;&#x50CF;&#xFF0C;&#x9700;&#x8981;&#x5728;&#x6CE8;&#x518C;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#xFF1A; <a href="https://hub.docker.com/" target="_blank" rel="external">https://hub.docker.com/</a></p>
<h2 id="wo-zhu-ce-yong-hu-aaa-liao-zen-me-huan-shi-wu-fa-docker-push-bbb-xxx-a"><a href="#&#x6211;&#x6CE8;&#x518C;&#x7528;&#x6237;-aaa-&#x4E86;&#xFF0C;&#x600E;&#x4E48;&#x8FD8;&#x662F;&#x65E0;&#x6CD5;-docker-push-bbb-xxx-&#x554A;&#xFF1F;" class="headerlink" title="&#x6211;&#x6CE8;&#x518C;&#x7528;&#x6237; aaa &#x4E86;&#xFF0C;&#x600E;&#x4E48;&#x8FD8;&#x662F;&#x65E0;&#x6CD5; docker push bbb/xxx &#x554A;&#xFF1F;"></a>&#x6211;&#x6CE8;&#x518C;&#x7528;&#x6237; <code>aaa</code> &#x4E86;&#xFF0C;&#x600E;&#x4E48;&#x8FD8;&#x662F;&#x65E0;&#x6CD5; <code>docker push bbb/xxx</code> &#x554A;&#xFF1F; <a href="#wo-zhu-ce-yong-hu-aaa-liao-zen-me-huan-shi-wu-fa-docker-push-bbb-xxx-a" class="header-anchor">#</a></h2><p>&#x1F612;&#x2026;&#x2026;&#x56E0;&#x4E3A;&#x4F60; <code>push</code> &#x5230;&#x522B;&#x4EBA;&#x7684; <code>repo</code> &#x4E86;&#xFF0C;&#x4F60;&#x53EA;&#x80FD; <code>push</code> &#x5230; <code>aaa/xxx</code> &#x4E0B;&#x3002;</p>
<h2 id="bu-guan-yong-a-wo-zhe-hui-docker-push-aaa-xxx-liao-zen-me-gao-su-wo-bu-cun-zai-a"><a href="#&#x4E0D;&#x7BA1;&#x7528;&#x554A;&#xFF0C;&#x6211;&#x8FD9;&#x56DE;-docker-push-aaa-xxx-&#x4E86;&#xFF0C;&#x600E;&#x4E48;&#x544A;&#x8BC9;&#x6211;&#x4E0D;&#x5B58;&#x5728;&#x554A;&#xFF1F;" class="headerlink" title="&#x4E0D;&#x7BA1;&#x7528;&#x554A;&#xFF0C;&#x6211;&#x8FD9;&#x56DE; docker push aaa/xxx &#x4E86;&#xFF0C;&#x600E;&#x4E48;&#x544A;&#x8BC9;&#x6211;&#x4E0D;&#x5B58;&#x5728;&#x554A;&#xFF1F;"></a>&#x4E0D;&#x7BA1;&#x7528;&#x554A;&#xFF0C;&#x6211;&#x8FD9;&#x56DE; <code>docker push aaa/xxx</code> &#x4E86;&#xFF0C;&#x600E;&#x4E48;&#x544A;&#x8BC9;&#x6211;&#x4E0D;&#x5B58;&#x5728;&#x554A;&#xFF1F; <a href="#bu-guan-yong-a-wo-zhe-hui-docker-push-aaa-xxx-liao-zen-me-gao-su-wo-bu-cun-zai-a" class="header-anchor">#</a></h2><p>&#x1F613;&#x2026;&#x2026;&#x56E0;&#x4E3A;&#x4F60;&#x6CA1;&#x6709; <code>tag</code> &#x5BF9;&#x5E94;&#x7684;&#x955C;&#x50CF;&#x4E3A; <code>aaa/xxx</code>&#x3002;</p>
<p>&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x90FD;&#x662F;&#x7531;&#x4E8E;&#x4F60;&#x6CA1;&#x6709;&#x53BB;&#x770B;&#x6587;&#x6863;&#xFF0C;&#x5EFA;&#x8BAE;&#x4E0D;&#x8981;&#x8FD9;&#x4E48;&#x4E00;&#x6B21;&#x6B21;&#x7684;&#x778E;&#x649E;&#xFF0C;&#x53BB;&#x770B;&#x5B98;&#x7F51;&#x6587;&#x6863;&#xFF1A;</p>
<p><a href="https://docs.docker.com/engine/getstarted/step_six/" target="_blank" rel="external">https://docs.docker.com/engine/getstarted/step_six/</a><br><a href="https://docs.docker.com/engine/tutorials/dockerrepos/" target="_blank" rel="external">https://docs.docker.com/engine/tutorials/dockerrepos/</a></p>
<h2 id="docker-push-dao-si-you-registry-zong-shi-bu-cheng-gong-zen-me-ban"><a href="#docker-push-&#x5230;&#x79C1;&#x6709;-registry-&#x603B;&#x662F;&#x4E0D;&#x6210;&#x529F;&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F;" class="headerlink" title="docker push &#x5230;&#x79C1;&#x6709; registry &#x603B;&#x662F;&#x4E0D;&#x6210;&#x529F;&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F;"></a><code>docker push</code> &#x5230;&#x79C1;&#x6709; registry &#x603B;&#x662F;&#x4E0D;&#x6210;&#x529F;&#xFF0C;&#x600E;&#x4E48;&#x529E;&#xFF1F; <a href="#docker-push-dao-si-you-registry-zong-shi-bu-cheng-gong-zen-me-ban" class="header-anchor">#</a></h2><p>&#x5982;&#x679C;&#x5728;&#x62A5;&#x9519;&#x4E2D;&#x770B;&#x5230;&#x4E86; <code>https</code>&#xFF0C;&#x90A3;&#x5F88;&#x53EF;&#x80FD;&#x662F;&#x56E0;&#x4E3A; <code>registry</code> &#x6CA1;&#x6709;&#x914D;&#x7F6E;&#x8BC1;&#x4E66;&#x3002;</p>
<p>&#x5F88;&#x591A;&#x4EBA;&#x6700;&#x5F00;&#x59CB;&#x914D;&#x7F6E; <code>registry</code> &#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E3A;&#x4E86;&#x7B80;&#x5355;&#x800C;&#x6CA1;&#x6709;&#x914D;&#x7F6E; <code>TLS</code> &#x8BC1;&#x4E66;&#x3002;</p>
<p>&#x8FD9;&#x662F;<strong>&#x4E0D;&#x5B89;&#x5168;</strong>&#x7684;&#x505A;&#x6CD5;&#xFF0C;&#x5728; Docker &#x4E2D;<strong>&#x4E0D;&#x63A8;&#x8350;</strong>&#x4F7F;&#x7528;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x523B;&#x610F;&#x7684;&#x589E;&#x52A0;&#x4E86;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x4E0D;&#x5B89;&#x5168; <code>registry</code> &#x7684;&#x590D;&#x6742;&#x5EA6;&#x3002;&#x4F7F;&#x7528;&#x8005;&#x5FC5;&#x987B;&#x5728; <code>docker daemon</code> &#x914D;&#x7F6E;&#x4E2D;&#xFF0C;&#x660E;&#x786E;&#x58F0;&#x660E;&#x8981;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x4E0D;&#x5B89;&#x5168;&#x7684; <code>registry</code>&#x3002;</p>
<p>&#x6BD4;&#x5982;&#xFF0C;&#x5728; <a href="http://www.ubuntu.com/download/server" target="_blank" rel="external">Ubuntu 16.04</a> &#x4E2D;&#xFF0C;&#x7F16;&#x8F91; <code>/etc/systemd/system/multi-user.target.wants/docker.service</code> &#x4E2D;&#x7684; <code>ExecStart=</code> &#x7684;&#x7ED3;&#x5C3E;&#xFF0C;&#x52A0;&#x5165; <code>--insecure-registry=192.168.99.100:5000</code>&#xFF0C;&#x5C06; <code>192.168.99.100:5000</code> &#x66FF;&#x6362;&#x6210;&#x4F60;&#x7684; <code>registry</code> &#x5730;&#x5740;&#x3002;&#x5982;&#x679C;&#x6709;&#x5F88;&#x591A; <code>registry</code>&#xFF0C;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x591A;&#x7EC4;&#x3002;&#x6216;&#x8005;&#x5982;&#x679C;&#x865A;&#x62DF;&#x673A;&#x7684; <code>IP</code> &#x603B;&#x662F;&#x53D8;&#x5316;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>CIDR</code> &#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x6BD4;&#x5982; <code>--insecure-registry=192.168.99.0/24</code>&#x3002;</p>
<p>&#x4E0D;&#x8FC7;&#x6D4B;&#x8BD5;&#x8FC7;&#x540E;&#xFF0C;&#x4E00;&#x5B9A;&#x8981;<a href="https://docs.docker.com/registry/deploying/#/get-a-certificate" target="_blank" rel="external">&#x914D;&#x4E0A; TLS &#x8BC1;&#x4E66;</a>&#x3002;&#x73B0;&#x5728; <a href="https://letsencrypt.org/getting-started/" target="_blank" rel="external">Let&#x2019;s Encrpyt</a> &#x5DF2;&#x7ECF;&#x652F;&#x6301; <code>DNS</code> &#x8BA4;&#x8BC1;&#x4E86;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x66B4;&#x9732;&#x5185;&#x90E8;&#x7684;&#x673A;&#x5668;&#x4E8E;&#x516C;&#x7F51;&#xFF0C;&#x7528;&#x5176;<a href="https://certbot.eff.org/" target="_blank" rel="external">&#x811A;&#x672C;</a>&#x81EA;&#x52A8;&#x53D6;&#x5F97;&#x514D;&#x8D39;&#x8BC1;&#x4E66;&#x662F;&#x5F88;&#x65B9;&#x4FBF;&#x7684;&#x3002;</p>
<h2 id="wo-docker-push-liao-hen-duo-jing-xiang-dao-si-you-de-registry-shang-zen-me-cai-neng-cha-kan-shang-mian-du-you-sha-huo-zhe-sou-suo"><a href="#&#x6211;-docker-push-&#x4E86;&#x5F88;&#x591A;&#x955C;&#x50CF;&#x5230;&#x79C1;&#x6709;&#x7684;-registry-&#x4E0A;&#xFF0C;&#x600E;&#x4E48;&#x624D;&#x80FD;&#x67E5;&#x770B;&#x4E0A;&#x9762;&#x90FD;&#x6709;&#x5565;&#xFF1F;&#x6216;&#x8005;&#x641C;&#x7D22;&#xFF1F;" class="headerlink" title="&#x6211; docker push &#x4E86;&#x5F88;&#x591A;&#x955C;&#x50CF;&#x5230;&#x79C1;&#x6709;&#x7684; registry &#x4E0A;&#xFF0C;&#x600E;&#x4E48;&#x624D;&#x80FD;&#x67E5;&#x770B;&#x4E0A;&#x9762;&#x90FD;&#x6709;&#x5565;&#xFF1F;&#x6216;&#x8005;&#x641C;&#x7D22;&#xFF1F;"></a>&#x6211; <code>docker push</code> &#x4E86;&#x5F88;&#x591A;&#x955C;&#x50CF;&#x5230;&#x79C1;&#x6709;&#x7684; registry &#x4E0A;&#xFF0C;&#x600E;&#x4E48;&#x624D;&#x80FD;&#x67E5;&#x770B;&#x4E0A;&#x9762;&#x90FD;&#x6709;&#x5565;&#xFF1F;&#x6216;&#x8005;&#x641C;&#x7D22;&#xFF1F; <a href="#wo-docker-push-liao-hen-duo-jing-xiang-dao-si-you-de-registry-shang-zen-me-cai-neng-cha-kan-shang-mian-du-you-sha-huo-zhe-sou-suo" class="header-anchor">#</a></h2><p>&#x4E24;&#x79CD;&#x529E;&#x6CD5;&#xFF0C;&#x4E00;&#x79CD;&#x662F;&#x4F7F;&#x7528; Registry V2 API&#x3002;&#x53EF;&#x4EE5;&#x5217;&#x51FA;&#x6240;&#x6709;&#x955C;&#x50CF;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl http://&lt;&#x79C1;&#x6709;registry&#x5730;&#x5740;&gt;/v2/_catalog</div></pre></td></tr></table></figure>
<p>&#x5982;&#x679C;&#x79C1;&#x6709; Registry &#x5C1A;&#x652F;&#x6301; V1 API&#xFF08;&#x5DF2;&#x7ECF;&#x5E9F;&#x5F03;&#xFF09;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>docker search</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker search &lt;&#x79C1;&#x6709;registry&#x5730;&#x5740;&gt;/&lt;&#x5173;&#x952E;&#x5B57;&gt;</div></pre></td></tr></table></figure>
<h2 id="ru-he-shan-chu-si-you-registry-zhong-de-jing-xiang"><a href="#&#x5982;&#x4F55;&#x5220;&#x9664;&#x79C1;&#x6709;-registry-&#x4E2D;&#x7684;&#x955C;&#x50CF;&#xFF1F;" class="headerlink" title="&#x5982;&#x4F55;&#x5220;&#x9664;&#x79C1;&#x6709; registry &#x4E2D;&#x7684;&#x955C;&#x50CF;&#xFF1F;"></a>&#x5982;&#x4F55;&#x5220;&#x9664;&#x79C1;&#x6709; registry &#x4E2D;&#x7684;&#x955C;&#x50CF;&#xFF1F; <a href="#ru-he-shan-chu-si-you-registry-zhong-de-jing-xiang" class="header-anchor">#</a></h2><p>&#x9996;&#x5148;&#xFF0C;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;docker registry &#x662F;&#x4E0D;&#x5141;&#x8BB8;&#x5220;&#x9664;&#x955C;&#x50CF;&#x7684;&#xFF0C;&#x9700;&#x8981;&#x5728;&#x914D;&#x7F6E;<code>config.yml</code>&#x4E2D;&#x542F;&#x7528;&#xFF1A;</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attr">delete:</span></div><div class="line"><span class="attr">    enabled:</span> <span class="literal">true</span></div></pre></td></tr></table></figure>
<p>&#x7136;&#x540E;&#xFF0C;&#x4F7F;&#x7528; API <code>GET /v2/&lt;&#x955C;&#x50CF;&#x540D;&gt;/manifests/&lt;tag&gt;</code> &#x6765;&#x53D6;&#x5F97;&#x8981;&#x5220;&#x9664;&#x7684;<code>&#x955C;&#x50CF;:Tag</code>&#x6240;&#x5BF9;&#x5E94;&#x7684; <code>digest</code>&#x3002;</p>
<p>Registry <code>2.3</code> &#x4EE5;&#x540E;&#xFF0C;&#x5FC5;&#x987B;&#x52A0;&#x5165;&#x5934; <code>Accept: application/vnd.docker.distribution.manifest.v2+json</code>&#xFF0C;&#x5426;&#x5219;&#x53D6;&#x5230;&#x7684; <code>digest</code> &#x662F;&#x9519;&#x8BEF;&#x7684;&#xFF0C;&#x8FD9;&#x662F;&#x4E3A;&#x4E86;&#x9632;&#x6B62;&#x8BEF;&#x5220;&#x9664;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#xFF0C;&#x8981;&#x5220;&#x9664; <code>myimage:latest</code> &#x955C;&#x50CF;&#xFF0C;&#x90A3;&#x4E48;&#x53D6;&#x5F97; <code>digest</code> &#x7684;&#x547D;&#x4EE4;&#x662F;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ curl --header <span class="string">&quot;Accept: application/vnd.docker.distribution.manifest.v2+json&quot;</span> \</div><div class="line">  -I -X HEAD http://192.168.99.100:5000/v2/myimage/manifests/latest \</div><div class="line">  | grep Digest</div><div class="line">Docker-Content-Digest: sha256:3a07b4e06c73b2e3924008270c7f3c3c6e3f70d4dbb814ad8bff2697123ca33c</div></pre></td></tr></table></figure>
<p>&#x7136;&#x540E;&#x8C03;&#x7528; API <code>DELETE /v2/&lt;&#x955C;&#x50CF;&#x540D;&gt;/manifests/&lt;digest&gt;</code> &#x6765;&#x5220;&#x9664;&#x955C;&#x50CF;&#x3002;&#x6BD4;&#x5982;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl  -X DELETE http://192.168.99.100:5000/v2/myimage/manifests/sha256:3a07b4e06c73b2e3924008270c7f3c3c6e3f70d4dbb814ad8bff2697123ca33c</div></pre></td></tr></table></figure>
<p>&#x81F3;&#x6B64;&#xFF0C;&#x955C;&#x50CF;&#x5DF2;&#x4ECE; <code>registry</code> &#x4E2D;&#x6807;&#x8BB0;&#x5220;&#x9664;&#xFF0C;&#x5916;&#x754C;&#x8BBF;&#x95EE; <code>pull</code> &#x4E0D;&#x5230;&#x4E86;&#x3002;&#x4F46;&#x662F; <code>registry</code> &#x7684;&#x672C;&#x5730;&#x7A7A;&#x95F4;&#x5E76;&#x672A;&#x91CA;&#x653E;&#xFF0C;&#x9700;&#x8981;&#x7B49;&#x5F85;&#x5783;&#x573E;&#x6536;&#x96C6;&#x624D;&#x4F1A;&#x91CA;&#x653E;&#x3002;&#x800C;&#x5783;&#x573E;&#x6536;&#x96C6;&#x4E0D;&#x53EF;&#x4EE5;&#x5728;&#x7EBF;&#x8FDB;&#x884C;&#xFF0C;&#x5FC5;&#x987B;&#x505C;&#x6B62; <code>registry</code>&#xFF0C;&#x7136;&#x540E;&#x6267;&#x884C;&#x3002;&#x6BD4;&#x5982;&#xFF0C;&#x5047;&#x8BBE; <code>registry</code> &#x662F;&#x7528; Compose &#x8FD0;&#x884C;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x4E0B;&#x9762;&#x547D;&#x4EE4;&#x7528;&#x6765;&#x5783;&#x573E;&#x6536;&#x96C6;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">docker-compose stop</div><div class="line">docker run -it --name gc --rm --volumes-from registry_registry_1 registry:2 garbage-collect /etc/registry/config.yml</div><div class="line">docker-compose start</div></pre></td></tr></table></figure>
<p>&#x5176;&#x4E2D; <code>registry_registry_1</code> &#x53EF;&#x4EE5;&#x66FF;&#x6362;&#x4E3A;&#x5B9E;&#x9645;&#x7684; <code>registry</code> &#x7684;&#x5BB9;&#x5668;&#x540D;&#xFF0C;&#x800C; <code>/etc/registry/config.yml</code> &#x5219;&#x66FF;&#x6362;&#x4E3A;&#x5B9E;&#x9645;&#x7684; <code>registry</code> &#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#x3002;</p>
<p>&#x53C2;&#x8003;&#x5B98;&#x7F51;&#x6587;&#x6863;&#xFF1A;</p>
<p><a href="https://docs.docker.com/registry/configuration/#/delete" target="_blank" rel="external">https://docs.docker.com/registry/configuration/#/delete</a></p>
<p><a href="https://docs.docker.com/registry/spec/api/#/deleting-an-image" target="_blank" rel="external">https://docs.docker.com/registry/spec/api/#/deleting-an-image</a></p>
<h2 id="shi-yong-guo-nei-jing-xiang-huan-shi-man-gong-si-nei-hao-duo-docker-zhu-ji-du-xu-yao-qu-chong-fu-xia-zai-jing-xiang-zha-ban"><a href="#&#x4F7F;&#x7528;&#x56FD;&#x5185;&#x955C;&#x50CF;&#x8FD8;&#x662F;&#x6162;&#xFF0C;&#x516C;&#x53F8;&#x5185;&#x597D;&#x591A;-docker-&#x4E3B;&#x673A;&#xFF0C;&#x90FD;&#x9700;&#x8981;&#x53BB;&#x91CD;&#x590D;&#x4E0B;&#x8F7D;&#x955C;&#x50CF;&#xFF0C;&#x548B;&#x529E;&#xFF1F;" class="headerlink" title="&#x4F7F;&#x7528;&#x56FD;&#x5185;&#x955C;&#x50CF;&#x8FD8;&#x662F;&#x6162;&#xFF0C;&#x516C;&#x53F8;&#x5185;&#x597D;&#x591A; docker &#x4E3B;&#x673A;&#xFF0C;&#x90FD;&#x9700;&#x8981;&#x53BB;&#x91CD;&#x590D;&#x4E0B;&#x8F7D;&#x955C;&#x50CF;&#xFF0C;&#x548B;&#x529E;&#xFF1F;"></a>&#x4F7F;&#x7528;&#x56FD;&#x5185;&#x955C;&#x50CF;&#x8FD8;&#x662F;&#x6162;&#xFF0C;&#x516C;&#x53F8;&#x5185;&#x597D;&#x591A; docker &#x4E3B;&#x673A;&#xFF0C;&#x90FD;&#x9700;&#x8981;&#x53BB;&#x91CD;&#x590D;&#x4E0B;&#x8F7D;&#x955C;&#x50CF;&#xFF0C;&#x548B;&#x529E;&#xFF1F; <a href="#shi-yong-guo-nei-jing-xiang-huan-shi-man-gong-si-nei-hao-duo-docker-zhu-ji-du-xu-yao-qu-chong-fu-xia-zai-jing-xiang-zha-ban" class="header-anchor">#</a></h2><p>&#x5728;&#x5C40;&#x57DF;&#x7F51;&#x5185;&#xFF0C;&#x672C;&#x5730;&#x67B6;&#x8BBE;&#x4E2A; Docker Registry mirror&#xFF0C;&#x4F5C;&#x4E3A;&#x7F13;&#x5B58;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x7A7A;&#x76EE;&#x5F55;&#xFF0C;&#x5E76;&#x4E14;&#x6DFB;&#x52A0; Registry &#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6; <code>config.yml</code>&#xFF0C;&#x5176;&#x5185;&#x5BB9;&#x4E3A;&#xFF1A;</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="attr">version:</span> <span class="number">0.1</span></div><div class="line"><span class="attr">log:</span></div><div class="line"><span class="attr">    fields:</span></div><div class="line"><span class="attr">        service:</span> registry</div><div class="line"><span class="attr">storage:</span></div><div class="line"><span class="attr">    cache:</span></div><div class="line"><span class="attr">        blobdescriptor:</span> inmemory</div><div class="line"><span class="attr">    filesystem:</span></div><div class="line"><span class="attr">        rootdirectory:</span> /var/lib/registry</div><div class="line"><span class="attr">http:</span></div><div class="line"><span class="attr">    addr:</span> :<span class="number">5000</span></div><div class="line"><span class="attr">    headers:</span></div><div class="line"><span class="attr">        X-Content-Type-Options:</span> [nosniff]</div><div class="line"><span class="attr">health:</span></div><div class="line"><span class="attr">    storagedriver:</span></div><div class="line"><span class="attr">        enabled:</span> <span class="literal">true</span></div><div class="line"><span class="attr">        interval:</span> <span class="number">10</span>s</div><div class="line"><span class="attr">        threshold:</span> <span class="number">3</span></div><div class="line"><span class="attr">proxy:</span></div><div class="line"><span class="attr">    remoteurl:</span> https://registry<span class="bullet">-1.</span>docker.io</div></pre></td></tr></table></figure>
<p>&#x5E76;&#x4E14;&#xFF0C;&#x5EFA;&#x7ACB;&#x4E2A; <code>docker-compose.yml</code> &#x6587;&#x4EF6;&#x65B9;&#x4FBF;&#x542F;&#x52A8;&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#xFF1A;</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="attr">version:</span> <span class="string">&apos;2&apos;</span></div><div class="line"><span class="attr">services:</span></div><div class="line"><span class="attr">    mirror:</span></div><div class="line"><span class="attr">        image:</span> registry:<span class="number">2</span></div><div class="line"><span class="attr">        ports:</span></div><div class="line"><span class="bullet">            -</span> <span class="string">&quot;5000:5000&quot;</span></div><div class="line"><span class="attr">        volumes:</span></div><div class="line"><span class="bullet">            -</span> ./config.yml:/etc/docker/registry/</div></pre></td></tr></table></figure>
<p>&#x7136;&#x540E;&#x7528; Docker Compose &#x542F;&#x52A8;&#x8FD9;&#x4E2A;&#x955C;&#x50CF;&#x670D;&#x52A1;&#xFF1A;<code>docker-compose up -d</code></p>
<p>&#x7136;&#x540E;&#x5728;&#x5C40;&#x57DF;&#x7F51;&#x4E2D;&#x7684;&#x6240;&#x6709; Docker &#x4E3B;&#x673A;&#x4E2D;&#x7684; Docker Daemon &#x914D;&#x7F6E;&#x4E2D;&#xFF0C;&#x90FD;&#x6DFB;&#x52A0;&#x4E00;&#x6761; <code>--registry-mirror=&lt;&#x8FD9;&#x4E2A;&#x955C;&#x50CF;&#x670D;&#x52A1;&#x5668;&#x7684;&#x5730;&#x5740;&gt;</code></p>
<p>&#x9996;&#x5148;&#x7528;docker pull&#x4E0B;&#x8F7D;&#x4E00;&#x4E2A;&#x672C;&#x5730;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x955C;&#x50CF;&#xFF0C;&#x770B;&#x4E00;&#x4E0B;&#x65F6;&#x95F4;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$ time docker pull php:7-fpm-alpine</div><div class="line">7-fpm-alpine: Pulling from library/php</div><div class="line">e110a4a17941: Pull complete</div><div class="line">d9f63633faf6: Pull complete</div><div class="line">ac309a5bc5d5: Pull complete</div><div class="line">4523ec888a62: Pull complete</div><div class="line">6a77f79ab9b5: Pull complete</div><div class="line">27243562b67c: Pull complete</div><div class="line">33e1803456c2: Pull complete</div><div class="line">a1219b0a1418: Pull complete</div><div class="line">Digest: sha256:f7d6f6844df64f8f615fa50ca28b3f1ad82be0a2dcde0b55205d31c1bb9f4820</div><div class="line">Status: Downloaded newer image <span class="keyword">for</span> php:7-fpm-alpine</div><div class="line">docker pull php:7-fpm-alpine  0.07s user 0.07s system 0% cpu 2:30.43 total</div></pre></td></tr></table></figure>
<p>&#x4E0A;&#x9762;&#x6211;&#x4EEC;&#x4E0B;&#x8F7D;&#x4E86; php:7-fpm-alpine&#xFF0C;&#x7528;&#x65F6; 2 &#x5206; 30&#x79D2;&#xFF0C;&#x7136;&#x540E;&#x6211;&#x4EEC;&#x5220;&#x6389;&#x955C;&#x50CF;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ docker rmi php:7-fpm-alpine</div><div class="line">Untagged: php:7-fpm-alpine</div><div class="line">Deleted: sha256:b80ca1f4f99d13e00ac6ef13aca7c1ef6e2fb83ec2fe6a035e8beeeb05afb4b6</div><div class="line">Deleted: sha256:69ee0f31988504dc3e3b068476f11d06b43<span class="built_in">fc</span>34465a1c58d351406b9d2368e7a</div><div class="line">...</div></pre></td></tr></table></figure>
<p>&#x7136;&#x540E;&#x91CD;&#x65B0;&#x4E0B;&#x8F7D;&#x955C;&#x50CF;&#xFF0C;&#x6D4B;&#x8BD5;&#x65F6;&#x95F4;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$ time docker pull php:7-fpm-alpine</div><div class="line">7-fpm-alpine: Pulling from library/php</div><div class="line">e110a4a17941: Pull complete</div><div class="line">d9f63633faf6: Pull complete</div><div class="line">ac309a5bc5d5: Pull complete</div><div class="line">4523ec888a62: Pull complete</div><div class="line">6a77f79ab9b5: Pull complete</div><div class="line">27243562b67c: Pull complete</div><div class="line">33e1803456c2: Pull complete</div><div class="line">a1219b0a1418: Pull complete</div><div class="line">Digest: sha256:f7d6f6844df64f8f615fa50ca28b3f1ad82be0a2dcde0b55205d31c1bb9f4820</div><div class="line">Status: Downloaded newer image <span class="keyword">for</span> php:7-fpm-alpine</div><div class="line">docker pull php:7-fpm-alpine  0.05s user 0.04s system 0% cpu 13.778 total</div></pre></td></tr></table></figure>
<p>&#x8FD9;&#x6B21;&#x7531;&#x4E8E;&#x8BE5; docker image &#x672C;&#x5730; mirror &#x7F13;&#x5B58;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x7528;&#x65F6;&#x7EA6;14&#x79D2;&#xFF0C;&#x901F;&#x5EA6;&#x5927;&#x5927;&#x63D0;&#x9AD8;&#x4E86;&#x3002;</p>
<p>&#x53C2;&#x8003;&#x5B98;&#x7F51;&#x6587;&#x6863;&#xFF1A;</p>
<p>&#x670D;&#x52A1;&#x7AEF;&#xFF1A;<a href="https://docs.docker.com/registry/configuration/#/proxy" target="_blank" rel="external">https://docs.docker.com/registry/configuration/#/proxy</a></p>
<p>&#x5BA2;&#x6237;&#x7AEF;&#xFF1A;<a href="https://docs.docker.com/engine/reference/commandline/dockerd/" target="_blank" rel="external">https://docs.docker.com/engine/reference/commandline/dockerd/</a></p>
<h2 id="zi-ji-jia-de-registry-zen-me-ren-he-yong-hu-du-ke-yi-qu-dao-jing-xiang-zhe-bu-an-quan-a"><a href="#&#x81EA;&#x5DF1;&#x67B6;&#x7684;-registry-&#x600E;&#x4E48;&#x4EFB;&#x4F55;&#x7528;&#x6237;&#x90FD;&#x53EF;&#x4EE5;&#x53D6;&#x5230;&#x955C;&#x50CF;&#xFF1F;&#x8FD9;&#x4E0D;&#x5B89;&#x5168;&#x554A;&#xFF1F;" class="headerlink" title="&#x81EA;&#x5DF1;&#x67B6;&#x7684; registry &#x600E;&#x4E48;&#x4EFB;&#x4F55;&#x7528;&#x6237;&#x90FD;&#x53EF;&#x4EE5;&#x53D6;&#x5230;&#x955C;&#x50CF;&#xFF1F;&#x8FD9;&#x4E0D;&#x5B89;&#x5168;&#x554A;&#xFF1F;"></a>&#x81EA;&#x5DF1;&#x67B6;&#x7684; <code>registry</code> &#x600E;&#x4E48;&#x4EFB;&#x4F55;&#x7528;&#x6237;&#x90FD;&#x53EF;&#x4EE5;&#x53D6;&#x5230;&#x955C;&#x50CF;&#xFF1F;&#x8FD9;&#x4E0D;&#x5B89;&#x5168;&#x554A;&#xFF1F; <a href="#zi-ji-jia-de-registry-zen-me-ren-he-yong-hu-du-ke-yi-qu-dao-jing-xiang-zhe-bu-an-quan-a" class="header-anchor">#</a></h2><p>&#x90A3;&#x662F;&#x56E0;&#x4E3A;&#x6CA1;&#x6709;&#x52A0;&#x8BA4;&#x8BC1;&#xFF0C;&#x4E0D;&#x52A0;&#x8BA4;&#x8BC1;&#x7684;&#x610F;&#x601D;&#x5C31;&#x662F;&#x5141;&#x8BB8;&#x4EFB;&#x4F55;&#x4EBA;&#x8BBF;&#x95EE;&#x7684;&#x3002;</p>
<p>&#x6DFB;&#x52A0;&#x8BA4;&#x8BC1;&#x6709;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#xFF1A;</p>
<ul>
<li>Registry &#x914D;&#x7F6E;&#x4E2D;&#x52A0;&#x5165;&#x8BA4;&#x8BC1;&#xFF1A; <a href="https://docs.docker.com/registry/configuration/#/auth" target="_blank" rel="external">https://docs.docker.com/registry/configuration/#/auth</a></li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="attr">auth:</span></div><div class="line"><span class="attr">  token:</span></div><div class="line"><span class="attr">    realm:</span> token-realm</div><div class="line"><span class="attr">    service:</span> token-service</div><div class="line"><span class="attr">    issuer:</span> registry-token-issuer</div><div class="line"><span class="attr">    rootcertbundle:</span> /root/certs/bundle</div><div class="line"><span class="attr">  htpasswd:</span></div><div class="line"><span class="attr">    realm:</span> basic-realm</div><div class="line"><span class="attr">    path:</span> /path/to/htpasswd</div></pre></td></tr></table></figure>
<ul>
<li>&#x524D;&#x7AEF;&#x67B6;&#x8BBE; nginx &#x8FDB;&#x884C;&#x8BA4;&#x8BC1;&#xFF1A;<a href="https://docs.docker.com/registry/recipes/nginx/" target="_blank" rel="external">https://docs.docker.com/registry/recipes/nginx/</a></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">location /v2/ {</div><div class="line">    ...</div><div class="line">    auth_basic <span class="string">&quot;Registry realm&quot;</span>;</div><div class="line">    auth_basic_user_file /etc/nginx/conf.d/nginx.htpasswd;</div><div class="line">    ...</div><div class="line">}</div></pre></td></tr></table></figure>
<h1 id="centos-rhel-hong-mao-xi-tong-te-you-wen-ti"><a href="#CentOS-RHEL-&#x7EA2;&#x5E3D;&#x7CFB;&#x7EDF;&#x7279;&#x6709;&#x95EE;&#x9898;" class="headerlink" title="CentOS/RHEL &#x7EA2;&#x5E3D;&#x7CFB;&#x7EDF;&#x7279;&#x6709;&#x95EE;&#x9898;"></a>CentOS/RHEL &#x7EA2;&#x5E3D;&#x7CFB;&#x7EDF;&#x7279;&#x6709;&#x95EE;&#x9898; <a href="#centos-rhel-hong-mao-xi-tong-te-you-wen-ti" class="header-anchor">#</a></h1><h2 id="zai-centos-6-shang-an-zhuang-hou-zen-me-zui-gao-zhi-you-docker-1-7-zhe-ge-ban-ben"><a href="#&#x5728;-CentOS-6-&#x4E0A;&#x5B89;&#x88C5;&#x540E;&#x600E;&#x4E48;&#x6700;&#x9AD8;&#x53EA;&#x6709;-Docker-1-7-&#x8FD9;&#x4E2A;&#x7248;&#x672C;&#xFF1F;" class="headerlink" title="&#x5728; CentOS 6 &#x4E0A;&#x5B89;&#x88C5;&#x540E;&#x600E;&#x4E48;&#x6700;&#x9AD8;&#x53EA;&#x6709; Docker 1.7 &#x8FD9;&#x4E2A;&#x7248;&#x672C;&#xFF1F;"></a>&#x5728; CentOS 6 &#x4E0A;&#x5B89;&#x88C5;&#x540E;&#x600E;&#x4E48;&#x6700;&#x9AD8;&#x53EA;&#x6709; Docker 1.7 &#x8FD9;&#x4E2A;&#x7248;&#x672C;&#xFF1F; <a href="#zai-centos-6-shang-an-zhuang-hou-zen-me-zui-gao-zhi-you-docker-1-7-zhe-ge-ban-ben" class="header-anchor">#</a></h2><p>Docker &#x5DF2;&#x7ECF;&#x4E0D;&#x518D;&#x652F;&#x6301; CentOS 6 &#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x770B;&#x5230;&#x7684;&#x662F;&#x5F88;&#x4E45;&#x4EE5;&#x524D;&#x7684;&#x8001;&#x7248;&#x672C;&#xFF0C;&#x4E4B;&#x540E;&#x518D;&#x4E5F;&#x6CA1;&#x6709;&#x53D1;&#x5E03;&#x8FC7; CentOS 6 &#x7684;&#x7248;&#x672C;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x4E0D;&#x8981;&#x518D;&#x5728; CentOS 6&#x4E0A;&#x7528; Docker &#x4E86;&#x3002;&#x6362; CentOS 7 &#x6216;&#x8005; Ubuntu &#x5427;&#x3002;</p>
<h2 id="gua-zai-su-zhu-mu-lu-jie-guo-permission-denied-mei-quan-xian"><a href="#&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;&#xFF0C;&#x7ED3;&#x679C;-Permission-denied&#xFF0C;&#x6CA1;&#x6743;&#x9650;" class="headerlink" title="&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;&#xFF0C;&#x7ED3;&#x679C; Permission denied&#xFF0C;&#x6CA1;&#x6743;&#x9650;"></a>&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;&#xFF0C;&#x7ED3;&#x679C; Permission denied&#xFF0C;&#x6CA1;&#x6743;&#x9650; <a href="#gua-zai-su-zhu-mu-lu-jie-guo-permission-denied-mei-quan-xian" class="header-anchor">#</a></h2><p>&#x539F;&#x56E0;&#x662F; CentOS/RHEL&#x4E2D;&#x7684; SELinux &#x9650;&#x5236;&#x4E86;&#x76EE;&#x5F55;&#x6743;&#x9650;&#x3002;&#x9700;&#x8981;&#x6DFB;&#x52A0;&#x89C4;&#x5219;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x662F; <code>man docker-run</code> &#x7684;&#x89E3;&#x91CA;&#xFF1A;</p>
<blockquote>
<p>When  using  SELinux,  be  aware that the host has no knowledge of container<br>SELinux policy. Therefore, in the above example, if SELinux policy  is enforced,<br>the /var/db directory is not  writable to the container. A &#x201C;Permission Denied&#x201D;<br>message will occur and an avc: message in the host&#x2019;s syslog.</p>
<p>To  work  around  this, at time of writing this man page, the following command<br>needs to be run in order for the  proper  SELinux  policy  type label to be<br>attached to the host directory:</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chcon -Rt svirt_sandbox_file_t /var/db</div></pre></td></tr></table></figure>
<p>&#x53C2;&#x8003;&#xFF1A;<a href="http://www.projectatomic.io/blog/2015/06/using-volumes-with-docker-can-cause-problems-with-selinux/" target="_blank" rel="external">http://www.projectatomic.io/blog/2015/06/using-volumes-with-docker-can-cause-problems-with-selinux/</a></p>
<h2 id="docker-de-var-lib-docker-devicemapper-zhan-yong-kong-jian-bu-duan-zeng-chang-zen-me-po"><a href="#Docker&#x7684;-var-lib-docker-devicemapper-&#x5360;&#x7528;&#x7A7A;&#x95F4;&#x4E0D;&#x65AD;&#x589E;&#x957F;-&#x600E;&#x4E48;&#x7834;&#xFF1F;" class="headerlink" title="Docker&#x7684; /var/lib/docker/devicemapper &#x5360;&#x7528;&#x7A7A;&#x95F4;&#x4E0D;&#x65AD;&#x589E;&#x957F;, &#x600E;&#x4E48;&#x7834;&#xFF1F;"></a>Docker&#x7684; <code>/var/lib/docker/devicemapper</code> &#x5360;&#x7528;&#x7A7A;&#x95F4;&#x4E0D;&#x65AD;&#x589E;&#x957F;, &#x600E;&#x4E48;&#x7834;&#xFF1F; <a href="#docker-de-var-lib-docker-devicemapper-zhan-yong-kong-jian-bu-duan-zeng-chang-zen-me-po" class="header-anchor">#</a></h2><p>&#x8FD9;&#x7C7B;&#x95EE;&#x9898;&#x4E00;&#x822C;&#x662F; CentOS/RHEL &#x7EA2;&#x5E3D;&#x7CFB;&#x7684;&#x95EE;&#x9898;&#xFF0C;CentOS &#x8FD9;&#x7C7B;&#x7EA2;&#x5E3D;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x7531;&#x4E8E;&#x4E0D;&#x50CF; Ubuntu &#x90A3;&#x6837;&#x6709;&#x6210;&#x719F;&#x7684; Union FS&#x5B9E;&#x73B0;(&#x5982;<code>aufs</code>)&#xFF0C;&#x6240;&#x4EE5;&#x53EA;&#x80FD;&#x4F7F;&#x7528; <code>devicemapper</code>&#xFF0C;&#x800C;&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;&#x7684;&#x662F;<code>lvm-loop</code>&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x7528;&#x4E00;&#x4E2A;&#x7A00;&#x758F;&#x6587;&#x4EF6;&#x6765;&#x5F53;&#x6210;&#x4E00;&#x4E2A;&#x5757;&#x8BBE;&#x5907;&#xFF0C;&#x7ED9;<code>devicemapper</code>&#x7528;&#xFF0C;&#x4F5C;&#x4E3A;Docker&#x955C;&#x50CF;&#x5BB9;&#x5668;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;&#x8FD9;&#x662F;&#x975E;&#x5E38;&#x4E0D;&#x63A8;&#x8350;&#x4F7F;&#x7528;&#x7684;&#xFF0C;&#x6027;&#x80FD;&#x5F88;&#x5DEE;&#x4E0D;&#x8BF4;&#xFF0C;&#x4E0D;&#x7A33;&#x5B9A;&#xFF0C;&#x8FD8;&#x6709;&#x5F88;&#x591A;bug&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x529E;&#x6CD5;&#x6362;Ubuntu/Debian&#x7CFB;&#x7EDF;&#xFF0C;&#x90A3;&#x4E48;&#x6700;&#x8D77;&#x7801;&#x5E94;&#x8BE5;&#x5EFA;&#x7ACB;&#x5757;&#x8BBE;&#x5907;&#xFF08;&#x5206;&#x533A;&#x3001;&#x5377;&#xFF09;&#x7ED9; <code>devicemapper</code>&#x7528;&#x3002;</p>
<p>&#x53C2;&#x8003;&#x5B98;&#x7F51;&#x6587;&#x6863;&#xFF1A;<a href="https://docs.docker.com/engine/userguide/storagedriver/device-mapper-driver/#configure-direct-lvm-mode-for-production" target="_blank" rel="external">https://docs.docker.com/engine/userguide/storagedriver/device-mapper-driver/#configure-direct-lvm-mode-for-production</a></p>
<p>&#x4E25;&#x683C;&#x6765;&#x8BF4; CentOS/RHEL 7 &#x4E2D;&#x5B9E;&#x9645;&#x4E0A;&#x6709;&#x4E00;&#x4E2A; Union FS &#x5B9E;&#x73B0;&#xFF0C;&#x867D;&#x7136; CentOS/RHEL 7 &#x7684;&#x5185;&#x6838;&#x662F;3.10&#xFF0C;&#x4E0D;&#x8FC7;&#x7EA2;&#x5E3D;&#x4ECE; Linux 3.18 backport &#x56DE;&#x6765;&#x4E86; <code>overlay</code> fs &#x7684;&#x9A71;&#x52A8;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x7EA2;&#x5E3D;&#x81EA;&#x5DF1;&#x90FD;&#x5728;&#x5B98;&#x65B9;&#x7684;&#x53D1;&#x5E03;&#x58F0;&#x660E;&#x4E2D;&#x8BF4;&#x80FD;&#x4E0D;&#x8981;&#x7528;&#x5C31;&#x4E0D;&#x7528;&#x3002;</p>
<p><a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/7.2_Release_Notes/technology-preview-file_systems.html" target="_blank" rel="external">https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/7.2_Release_Notes/technology-preview-file_systems.html</a></p>
<h2 id="centos-7-de-nei-he-tai-lao-liao-3-10-shi-bu-shi-hen-duo-docker-gong-neng-bu-zhi-chi"><a href="#CentOS-7-&#x7684;&#x5185;&#x6838;&#x592A;&#x8001;&#x4E86;-3-10&#xFF0C;&#x662F;&#x4E0D;&#x662F;&#x5F88;&#x591A;Docker&#x529F;&#x80FD;&#x4E0D;&#x652F;&#x6301;&#xFF1F;" class="headerlink" title="CentOS 7 &#x7684;&#x5185;&#x6838;&#x592A;&#x8001;&#x4E86; 3.10&#xFF0C;&#x662F;&#x4E0D;&#x662F;&#x5F88;&#x591A;Docker&#x529F;&#x80FD;&#x4E0D;&#x652F;&#x6301;&#xFF1F;"></a>CentOS 7 &#x7684;&#x5185;&#x6838;&#x592A;&#x8001;&#x4E86; 3.10&#xFF0C;&#x662F;&#x4E0D;&#x662F;&#x5F88;&#x591A;Docker&#x529F;&#x80FD;&#x4E0D;&#x652F;&#x6301;&#xFF1F; <a href="#centos-7-de-nei-he-tai-lao-liao-3-10-shi-bu-shi-hen-duo-docker-gong-neng-bu-zhi-chi" class="header-anchor">#</a></h2><p>&#x4E4B;&#x524D;&#x6211;&#x4E5F;&#x662F;&#x8FD9;&#x6837;&#x4EE5;&#x4E3A;&#x7684;&#xFF0C;&#x6BD5;&#x7ADF;&#x5F88;&#x591A;&#x5185;&#x6838;&#x529F;&#x80FD;&#x9700;&#x8981;&#x66F4;&#x9AD8;&#x7684;&#x7248;&#x672C;&#x3002;&#x6BD4;&#x5982; Overlay FS &#x9700;&#x8981;Linux 3.18&#xFF0C;&#x800C;Overlay network&#x9700;&#x8981;Linux 3.16&#x3002;&#x800C;CentOS 7&#x5185;&#x6838;&#x4E3A;3.10&#xFF0C;&#x6309;&#x7406;&#x8BF4;&#x4E0D;&#x4F1A;&#x652F;&#x6301;&#x8FD9;&#x4E9B;&#x9AD8;&#x7EA7;&#x7279;&#x6027;&#x3002;</p>
<p>&#x4F46;&#x662F;&#xFF0C;&#x4E8B;&#x5B9E;&#x5E76;&#x975E;&#x5982;&#x6B64;&#xFF0C;&#x7EA2;&#x5E3D;&#x56E2;&#x961F;&#x4F1A;&#x628A;&#x4E00;&#x4E9B;&#x65B0;&#x5185;&#x6838;&#x7684;&#x529F;&#x80FD;backport&#x56DE;&#x8001;&#x7684;&#x5185;&#x6838;&#x3002;&#x6BD4;&#x5982; <code>overlay fs</code>&#x7B49;&#x3002;&#x6240;&#x4EE5;&#x4E00;&#x4E9B;&#x529F;&#x80FD;&#x4F9D;&#x65E7;&#x4F1A;&#x652F;&#x6301;&#x3002;&#x56E0;&#x6B64; CentOS 7&#x7684;Docker Engine&#x540C;&#x6837;&#x53EF;&#x4EE5;&#x652F;&#x6301; <code>overlay network</code>&#xFF0C;&#x4EE5;&#x53CA; <code>overlay fs</code>&#x3002;&#x56E0;&#x6B64;&#x5728;&#x65B0;&#x7684; Docker 1.12 &#x4E2D;&#xFF0C;CentOS/RHEL 7 &#x624D;&#x6709;&#x53EF;&#x80FD;&#x652F;&#x6301; Swarm Mode&#x3002;</p>
<p>&#x5373;&#x4F7F;&#x7EA2;&#x5E3D;&#x4F1A;&#x628A;&#x4E00;&#x4E9B;&#x9AD8;&#x7248;&#x672C;&#x5185;&#x6838;&#x7684;&#x529F;&#x80FD;backport&#x56DE; 3.10 &#x5185;&#x6838;&#x4E2D;&#xFF0C;&#x8FD9;&#x79CD;&#x4FEE;&#x4FEE;&#x8865;&#x8865;&#x51FA;&#x6765;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5E76;&#x4E0D;&#x4E00;&#x5B9A;&#x5F88;&#x7A33;&#x5B9A;&#xFF0C;&#x6240;&#x4EE5;&#x4F9D;&#x65E7;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;&#x5176;&#x5B83;&#x7EF4;&#x62A4;&#x5185;&#x6838;&#x7248;&#x672C;&#x5347;&#x7EA7;&#x7684;Linux&#x53D1;&#x884C;&#x7248;&#xFF0C;&#x5982; Ubuntu&#x3002;</p>
<h2 id="centos-7-rhel-7-sheng-ji-1-12-hou-wu-fa-qi-dong-bao-cuo-unit-docker-socket-failed-to-load-no-such-file-or-directory"><a href="#CentOS-7-RHEL-7-&#x5347;&#x7EA7;-1-12-&#x540E;&#xFF0C;&#x65E0;&#x6CD5;&#x542F;&#x52A8;&#xFF0C;&#x62A5;&#x9519;-Unit-docker-socket-failed-to-load-No-such-file-or-directory" class="headerlink" title="CentOS 7/RHEL 7 &#x5347;&#x7EA7; 1.12 &#x540E;&#xFF0C;&#x65E0;&#x6CD5;&#x542F;&#x52A8;&#xFF0C;&#x62A5;&#x9519; Unit docker.socket failed to load: No such file or directory."></a>CentOS 7/RHEL 7 &#x5347;&#x7EA7; 1.12 &#x540E;&#xFF0C;&#x65E0;&#x6CD5;&#x542F;&#x52A8;&#xFF0C;&#x62A5;&#x9519; <code>Unit docker.socket failed to load: No such file or directory.</code> <a href="#centos-7-rhel-7-sheng-ji-1-12-hou-wu-fa-qi-dong-bao-cuo-unit-docker-socket-failed-to-load-no-such-file-or-directory" class="header-anchor">#</a></h2><p>&#x5176;&#x539F;&#x56E0;&#x662F;&#x7531;&#x4E8E;&#x4ECE; <code>1.12</code> &#x5F00;&#x59CB;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x5728; <code>systemd</code> &#x4E2D;&#x5199;&#x4E2A; <code>docker.socket</code> &#x6587;&#x4EF6;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5C31;&#x968F;&#x5347;&#x7EA7;&#x800C;&#x5220;&#x9664;&#x4E86;&#x3002;&#x800C; <code>docker.service</code> &#x7531;&#x4E8E;&#x88AB;&#x4FEE;&#x6539;&#x8FC7;&#xFF08;&#x6216;&#x522B;&#x7684;&#x4EC0;&#x4E48;&#x539F;&#x56E0;&#xFF09;&#xFF0C;&#x5BFC;&#x81F4; <code>yum</code> &#x5347;&#x7EA7;&#x7684;&#x65F6;&#x5019;&#x6CA1;&#x6709;&#x66FF;&#x6362;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x3002;&#x4E8E;&#x662F;&#x51FA;&#x73B0;&#x4E86;&#x65E7;&#x7684; <code>docker.service</code> &#x4E2D;&#x914D;&#x7F6E;&#x8981;&#x6C42;&#x6709; <code>docker.socket</code> &#x6587;&#x4EF6;&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5DF2;&#x7ECF;&#x5728;&#x65B0;&#x7684;&#x7248;&#x672C;&#x4E2D;&#x5220;&#x9664;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x5BFC;&#x81F4;&#x542F;&#x52A8;&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x89E3;&#x51B3;&#x529E;&#x6CD5;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x76F4;&#x63A5;&#x6253;&#x5F00; <code>docker.service</code>&#xFF0C;&#x5C06;&#x5176;&#x53C2;&#x7167; <code>1.12</code> &#x7684;&#x9ED8;&#x8BA4;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4FEE;&#x6539;&#x5373;&#x53EF;&#x3002;&#x5BFB;&#x627E;&#x5230; <code>Required=docker.socket</code> &#x90A3;&#x884C;&#xFF0C;&#x5220;&#x6389;&#x3002;&#x7136;&#x540E;&#x5BFB;&#x627E;&#x5230; <code>docker daemon</code> &#x90A3;&#x884C;&#xFF0C;&#x5C06;&#x5176;&#x540E;&#x7684; <code>-H fd://</code> &#x5220;&#x6389;&#x3002;&#x5982;&#x679C;&#x613F;&#x610F;&#xFF0C;&#x53EF;&#x4EE5;&#x8FDB;&#x4E00;&#x6B65;&#x5C06; <code>docker daemon</code> &#x6539;&#x4E3A; <code>dockerd</code>&#xFF0C;&#x56E0;&#x4E3A;&#x4ECE; <code>1.12</code> &#x5F00;&#x59CB;&#x6539;&#x540D;&#x53EB;&#x8FD9;&#x4E2A;&#x4E86;&#x3002;&#x4FDD;&#x5B58;&#x9000;&#x51FA;&#x91CD;&#x542F;&#x670D;&#x52A1;&#x5373;&#x53EF;&#x3002;</p>
<h1 id="mac-windows-xiang-guan-wen-ti"><a href="#Mac-Windows-&#x76F8;&#x5173;&#x95EE;&#x9898;" class="headerlink" title="Mac / Windows &#x76F8;&#x5173;&#x95EE;&#x9898;"></a>Mac / Windows &#x76F8;&#x5173;&#x95EE;&#x9898; <a href="#mac-windows-xiang-guan-wen-ti" class="header-anchor">#</a></h1><h2 id="wei-shi-me-zai-mac-xia-gua-zai-su-zhu-mu-lu-usr-local-nginx-bu-cheng-gong"><a href="#&#x4E3A;&#x4EC0;&#x4E48;&#x5728;Mac&#x4E0B;&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;-usr-local-nginx&#x4E0D;&#x6210;&#x529F;&#xFF1F;" class="headerlink" title="&#x4E3A;&#x4EC0;&#x4E48;&#x5728;Mac&#x4E0B;&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;/usr/local/nginx&#x4E0D;&#x6210;&#x529F;&#xFF1F;"></a>&#x4E3A;&#x4EC0;&#x4E48;&#x5728;<code>Mac</code>&#x4E0B;&#x6302;&#x8F7D;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;<code>/usr/local/nginx</code>&#x4E0D;&#x6210;&#x529F;&#xFF1F; <a href="#wei-shi-me-zai-mac-xia-gua-zai-su-zhu-mu-lu-usr-local-nginx-bu-cheng-gong" class="header-anchor">#</a></h2><p>&#x867D;&#x7136; Docker &#x56E2;&#x961F;&#x5C3D;&#x91CF;&#x8BA9;&#x4F7F;&#x7528; <a href="https://www.docker.com/products/docker-toolbox" target="_blank" rel="external">Docker Toolbox</a>, <a href="https://docs.docker.com/docker-for-mac/" target="_blank" rel="external">Docker for Mac</a> and <a href="https://docs.docker.com/docker-for-windows" target="_blank" rel="external">Docker fo Windows</a> &#x7684;&#x7528;&#x6237;&#x611F;&#x89C9;&#x64CD;&#x4F5C; Docker &#x5C31;&#x50CF;&#x5728; Linux &#x4E0B;&#x4E00;&#x6837;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x5728; Mac/Windows &#x4E0A;&#x5E76;&#x975E;&#x662F;&#x76F4;&#x63A5;&#x8FD0;&#x884C; Docker &#x7684;&#x3002;&#x4E2D;&#x95F4;&#x7ECF;&#x8FC7;&#x4E86;&#x4E00;&#x4E2A; Linux &#x865A;&#x62DF;&#x673A;&#xFF0C;&#x800C; Docker &#x8FD0;&#x884C;&#x5728;&#x90A3;&#x4E2A;&#x865A;&#x62DF;&#x673A;&#x91CC;&#x3002;</p>
<p>&#x56E0;&#x6B64; Mac &#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x76EE;&#x5F55;&#x5B9E;&#x9645;&#x4E0A;&#x5E76;&#x4E0D;&#x662F; Docker &#x773C;&#x4E2D;&#x7684;&#x5BBF;&#x4E3B;&#x76EE;&#x5F55;&#xFF0C;&#x4E3A;&#x4E86;&#x8BA9;&#x7528;&#x6237;&#x5C3D;&#x91CF;&#x611F;&#x89C9;&#x4E0D;&#x5230;&#x8FD9;&#x4E2A;&#x5DEE;&#x5F02;&#xFF0C;<code>Boot2Docker</code> &#x6216;&#x8005; <code>Docker for Mac / Windows</code> &#x4E2D;&#xFF0C;&#x5C06;&#x4E00;&#x90E8;&#x5206;&#x7269;&#x7406;&#x4E3B;&#x673A;&#x7684;&#x76EE;&#x5F55;&#x6620;&#x5C04;&#x5230;&#x4E86; Linux &#x865A;&#x62DF;&#x673A;&#x4E2D;&#xFF0C;&#x8FD9;&#x6837;&#x5176;&#x4E0A; Docker &#x5C31;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x5230;&#x8FD9;&#x4E9B;&#x7269;&#x7406;&#x673A;&#x7684;&#x76EE;&#x5F55;&#x4E86;&#x3002;</p>
<p>&#x51FA;&#x4E8E;&#x5B89;&#x5168;&#x8003;&#x8651;&#xFF0C;&#x5E76;&#x4E0D;&#x4F1A;&#x628A;&#x7269;&#x7406;&#x673A;&#x7684;&#x6240;&#x6709;&#x76EE;&#x5F55;&#x90FD;&#x6620;&#x5C04;&#x5230; Linux &#x865A;&#x62DF;&#x673A;&#x5185;&#x3002;&#x4E00;&#x822C;&#x6765;&#x8BF4;&#x53EA;&#x6709;&#x5F53;&#x524D;&#x7528;&#x6237;&#x76EE;&#x5F55;&#x5728;&#x5185;&#x7684;&#x4E00;&#x4E9B;&#x76EE;&#x5F55;&#x4F1A;&#x88AB;&#x6620;&#x5C04;&#x5230; Linux &#x865A;&#x62DF;&#x673A;&#x5185;&#xFF0C;&#x6BD4;&#x5982; <code>/Users</code>, <code>/Volumes</code> &#x7B49;&#x3002;</p>
<p>&#x5BF9;&#x4E8E; <code>Docker for Mac</code> &#x7684;&#x7528;&#x6237;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5728;&#x914D;&#x7F6E;&#x754C;&#x9762; <code>File Sharing</code> &#x4E2D;&#x6DFB;&#x52A0;&#x989D;&#x5916;&#x7684;&#x6620;&#x5C04;&#x76EE;&#x5F55;&#xFF0C;&#x4F46;&#x662F;&#xFF0C;&#x51FA;&#x4E8E;&#x5B89;&#x5168;&#x8003;&#x8651;&#xFF0C;&#x4E0D;&#x6DFB;&#x52A0;&#x989D;&#x5916;&#x6620;&#x5C04;&#xFF0C;&#x800C;&#x4F7F;&#x7528;&#x5F53;&#x524D;&#x7528;&#x6237;&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x76EE;&#x5F55;&#xFF0C;&#x662F;&#x66F4;&#x597D;&#x5730;&#x505A;&#x6CD5;&#x3002;</p>
<h1 id="wei-da-de-qiang-xiang-guan-wen-ti"><a href="#&#x4F1F;&#x5927;&#x7684;&#x5899;&#x76F8;&#x5173;&#x95EE;&#x9898;" class="headerlink" title="&#x4F1F;&#x5927;&#x7684;&#x5899;&#x76F8;&#x5173;&#x95EE;&#x9898;"></a>&#x4F1F;&#x5927;&#x7684;&#x5899;&#x76F8;&#x5173;&#x95EE;&#x9898; <a href="#wei-da-de-qiang-xiang-guan-wen-ti" class="header-anchor">#</a></h1><h2 id="docker-toolbox-compose-machine-zong-shi-xia-zai-bu-lai-zen-me-ban"><a href="#Docker-Toolbox-Compose-Machine-&#x603B;&#x662F;&#x4E0B;&#x8F7D;&#x4E0D;&#x6765;&#x600E;&#x4E48;&#x529E;&#xFF1F;" class="headerlink" title="Docker Toolbox/Compose/Machine &#x603B;&#x662F;&#x4E0B;&#x8F7D;&#x4E0D;&#x6765;&#x600E;&#x4E48;&#x529E;&#xFF1F;"></a>Docker Toolbox/Compose/Machine &#x603B;&#x662F;&#x4E0B;&#x8F7D;&#x4E0D;&#x6765;&#x600E;&#x4E48;&#x529E;&#xFF1F; <a href="#docker-toolbox-compose-machine-zong-shi-xia-zai-bu-lai-zen-me-ban" class="header-anchor">#</a></h2><p>&#x9996;&#x5148;&#x611F;&#x8C22;&#x4F1F;&#x5927;&#x7684;&#x5899;&#xFF0C;&#x7136;&#x540E;&#x7FFB;&#x5899;&#x4E0B;&#x8F7D;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x90E8;&#x5206;&#x5E38;&#x7528;&#x7684;&#x8F6F;&#x4EF6;&#xFF0C;&#x6211;&#x4E0A;&#x4F20;&#x4E86;&#x4E00;&#x4EFD;&#x5230;&#x767E;&#x5EA6;&#x4E91;&#x4E0A;&#xFF0C;&#x9274;&#x4E8E;&#x767E;&#x5EA6;&#x4E91;&#x8FD9;&#x5C71;&#x5BE8;&#x8D27;&#x6587;&#x4EF6;&#x5B8C;&#x6574;&#x6027;&#x65E0;&#x6CD5;&#x4FDD;&#x8BC1;&#xFF0C;&#x6211;zip&#x538B;&#x7F29;&#x4E86;&#x4E0D;&#x540C;&#x7CFB;&#x7EDF;&#x7684;&#x5DE5;&#x5177;&#x3002;&#x6240;&#x4EE5;&#x8F83;&#x5927;&#xFF0C;&#x6162;&#x6162;&#x4E0B;&#x8F7D;&#x3002;</p>
<p>&#x94FE;&#x63A5;:<a href="https://pan.baidu.com/s/1o7V5scM" target="_blank" rel="external">https://pan.baidu.com/s/1o7V5scM</a> &#x5BC6;&#x7801;:tzxc</p>
<ul>
<li>Linux: <code>linux-1.12.0.zip</code></li>
<li>Mac: <code>mac-1.12.0.zip</code></li>
<li>Windows: <code>windows-1.12.0.zip</code></li>
</ul>
<p>ZIP &#x6587;&#x4EF6;&#x5185;&#x5305;&#x542B;&#x4E86; <code>md5sum.txt</code> &#x4EE5;&#x53CA; <code>sha256sum.txt</code>&#xFF0C;&#x4E0B;&#x8F7D;&#x540E;&#x53EF;&#x4EE5;&#x7528;&#x5176;&#x786E;&#x8BA4;&#x6587;&#x4EF6;&#x5B8C;&#x6574;&#x6027;&#x3002;</p>
<h2 id="shi-zhi-jie-yong-yum-apt-get-an-zhuang-docker-ma"><a href="#&#x662F;&#x76F4;&#x63A5;&#x7528;-yum-apt-get-&#x5B89;&#x88C5;-Docker-&#x5417;&#xFF1F;" class="headerlink" title="&#x662F;&#x76F4;&#x63A5;&#x7528; yum / apt-get &#x5B89;&#x88C5; Docker &#x5417;&#xFF1F;"></a>&#x662F;&#x76F4;&#x63A5;&#x7528; yum / apt-get &#x5B89;&#x88C5; Docker &#x5417;&#xFF1F; <a href="#shi-zhi-jie-yong-yum-apt-get-an-zhuang-docker-ma" class="header-anchor">#</a></h2><p>&#x65E0;&#x8BBA;&#x662F;CentOS&#x8FD8;&#x662F;Ubuntu&#xFF0C;&#x90FD;&#x4E0D;&#x8981;&#x4F7F;&#x7528;&#x7CFB;&#x7EDF;&#x6E90;&#x91CC;&#x9762;&#x7684;Docker&#xFF0C;&#x7248;&#x672C;&#x592A;&#x53E4;&#x8001;&#xFF0C;&#x6CA1;&#x6CD5;&#x7528;&#x3002;</p>
<p>&#x5B98;&#x65B9;&#x6B63;&#x5F0F;&#x7684;&#x5B89;&#x88C5;Docker&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -fsSL https://get.docker.com/ | sh</div></pre></td></tr></table></figure>
<p>&#x5982;&#x679C;&#x8BBF;&#x95EE;&#x5B98;&#x65B9;&#x6E90;&#x592A;&#x6162;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x56FD;&#x5185;&#x7684;&#x6E90;&#x5B89;&#x88C5;&#xFF1A;</p>
<p>&#x4F7F;&#x7528;<code>&#x963F;&#x91CC;&#x4E91;</code>&#x7684;&#x5B89;&#x88C5;&#x811A;&#x672C;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl <span class="_">-s</span>SL http://acs-public-mirror.oss-cn-hangzhou.aliyuncs.com/docker-engine/internet | sh -</div></pre></td></tr></table></figure>
<p>&#x4F7F;&#x7528;<code>DaoCloud</code>&#x7684;Docker&#x5B89;&#x88C5;&#x811A;&#x672C;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl <span class="_">-s</span>SL https://get.daocloud.io/docker | sh</div></pre></td></tr></table></figure>
<h2 id="docker-pull-hao-man-a-zen-me-ban"><a href="#docker-pull-&#x597D;&#x6162;&#x554A;&#x600E;&#x4E48;&#x529E;&#xFF1F;" class="headerlink" title="docker pull &#x597D;&#x6162;&#x554A;&#x600E;&#x4E48;&#x529E;&#xFF1F;"></a>docker pull &#x597D;&#x6162;&#x554A;&#x600E;&#x4E48;&#x529E;&#xFF1F; <a href="#docker-pull-hao-man-a-zen-me-ban" class="header-anchor">#</a></h2><p>&#x8981;&#x611F;&#x6069;&#x4F1F;&#x5927;&#x7684;&#x5899;&#x3002;&#x4F7F;&#x7528;<code>&#x963F;&#x91CC;&#x4E91;&#x52A0;&#x901F;&#x5668;</code>&#x6216;&#x8005;<code>DaoCloud&#x7684;&#x52A0;&#x901F;&#x5668;</code>&#xFF08;&#x4E5F;&#x5C31;&#x662F;&#x4EE3;&#x7406;&#x3001;&#x955C;&#x50CF;&#xFF09;&#x5427;&#xFF1A;</p>
<p>&#x8981;&#x7533;&#x8BF7;&#x963F;&#x91CC;&#x4E91;&#x52A0;&#x901F;&#x5668;&#x5730;&#x5740;&#xFF0C;&#x6CE8;&#x518C;&#x963F;&#x91CC;&#x4E91;&#x5F00;&#x53D1;&#x8D26;&#x6237;(<em>&#x514D;&#x8D39;&#x7684;</em>)&#x540E;&#xFF0C;&#x8BBF;&#x95EE;&#x8FD9;&#x4E2A;&#x94FE;&#x63A5;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x52A0;&#x901F;&#x5668;&#x5730;&#x5740;&#xFF1A; <a href="https://cr.console.aliyun.com/#/accelerator" target="_blank" rel="external">https://cr.console.aliyun.com/#/accelerator</a></p>
<p>&#x8981;&#x7533;&#x8BF7; DaoCloud&#x52A0;&#x901F;&#x5668;&#x5730;&#x5740;&#xFF0C;&#x6CE8;&#x518C; DaoCloud &#x8D26;&#x6237;(<em>&#x652F;&#x6301;&#x5FAE;&#x4FE1;&#x767B;&#x5F55;</em>)&#xFF0C;&#x7136;&#x540E;&#x8BBF;&#x95EE;&#xFF1A; <a href="https://www.daocloud.io/mirror#accelerator-doc" target="_blank" rel="external">https://www.daocloud.io/mirror#accelerator-doc</a><br>DaoCloud &#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x811A;&#x672C;&#x5B89;&#x88C5;&#x52A0;&#x901F;&#x5668;&#xFF1A;&#x6BD4;&#x5982;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl <span class="_">-s</span>SL https://get.daocloud.io/daotools/set_mirror.sh | sh <span class="_">-s</span> http://ef2bef07.m.daocloud.io</div></pre></td></tr></table></figure>
<p>&#x53C2;&#x8003;&#x535A;&#x6587;&#xFF1A;</p>
<p><a href="http://www.imike.me/2016/04/20/Docker%E4%B8%8B%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F/" target="_blank" rel="external">http://www.imike.me/2016/04/20/Docker%E4%B8%8B%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F/</a></p>
<h3 id="ubuntu-14-04-pei-zhi"><a href="#Ubuntu-14-04-&#x914D;&#x7F6E;" class="headerlink" title="Ubuntu 14.04 &#x914D;&#x7F6E;"></a>Ubuntu 14.04 &#x914D;&#x7F6E; <a href="#ubuntu-14-04-pei-zhi" class="header-anchor">#</a></h3><p>&#x5BF9;&#x4E8E;&#x4F7F;&#x7528; <code>Upstart</code> &#x7684;&#x7CFB;&#x7EDF;(&#x5982; Ubuntu 14.04)&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x4E0B;&#x7C7B;&#x65B9;&#x6CD5;&#x914D;&#x7F6E;&#x52A0;&#x901F;&#x5668;&#x3002;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">echo</span> <span class="string">&quot;DOCKER_OPTS=\&quot;\$DOCKER_OPTS &#x2013;registry-mirror=http://your-id.m.daocloud.io -d\&quot;&quot;</span> &gt;&gt; /etc/default/docker</div></pre></td></tr></table></figure>
<h3 id="ubuntu-16-04-pei-zhi"><a href="#Ubuntu-16-04-&#x914D;&#x7F6E;" class="headerlink" title="Ubuntu 16.04 &#x914D;&#x7F6E;"></a>Ubuntu 16.04 &#x914D;&#x7F6E; <a href="#ubuntu-16-04-pei-zhi" class="header-anchor">#</a></h3><p>&#x7F16;&#x8F91; <code>systemd</code> &#x7684;&#x670D;&#x52A1;&#x914D;&#x7F6E;&#x6587;&#x4EF6; <code>docker.service</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vi /etc/systemd/system/multi-user.target.wants/docker.service</div></pre></td></tr></table></figure>
<p>&#x5728; <code>ExecStart</code> &#x4E2D;&#x7684;&#x884C;&#x5C3E;&#x6DFB;&#x52A0;&#x4E0A;&#x6240;&#x9700;&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x5982;&#xFF1A;</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attr">ExecStart</span>=/usr/bin/docker daemon -H fd:// --registry-mirror=https://jxus37ac.mirror.aliyuncs.com</div></pre></td></tr></table></figure>
<blockquote>
<p>&#x6CE8;: Docker 1.12 &#x4E4B;&#x540E;&#x7684;&#x7248;&#x672C;&#xFF0C;<code>docker daemon</code> &#x6539;&#x4E3A; <code>dockerd</code>&#x3002;</p>
</blockquote>
<p>&#x4FDD;&#x5B58;&#x9000;&#x51FA;&#x540E;&#xFF0C;&#x91CD;&#x65B0;&#x52A0;&#x8F7D;&#x914D;&#x7F6E;&#x5E76;&#x542F;&#x52A8;&#x670D;&#x52A1;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo systemctl daemon-reload</div><div class="line">sudo systemctl restart docker</div></pre></td></tr></table></figure>
<p>&#x786E;&#x8BA4;&#x4E00;&#x4E0B;&#x914D;&#x7F6E;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x751F;&#x6548;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo ps -ef | grep docker</div></pre></td></tr></table></figure>
<p>&#x751F;&#x6548;&#x540E;&#x8FD9;&#x91CC;&#x4F1A;&#x770B;&#x5230;&#x81EA;&#x5DF1;&#x7684;&#x914D;&#x7F6E;&#x3002;</p>
<h2 id="zhuang-wan-docker-toolbox-hou-fa-xian-xia-zai-jing-xiang-su-du-tai-man-shi-bu-shi-xu-yao-xiu-gai-shi-me-pei-zhi-wen-jian"><a href="#&#x88C5;&#x5B8C;-Docker-Toolbox-&#x540E;&#x53D1;&#x73B0;&#x4E0B;&#x8F7D;&#x955C;&#x50CF;&#x901F;&#x5EA6;&#x592A;&#x6162;&#xFF0C;&#x662F;&#x4E0D;&#x662F;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x4EC0;&#x4E48;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF1F;" class="headerlink" title="&#x88C5;&#x5B8C; Docker Toolbox &#x540E;&#x53D1;&#x73B0;&#x4E0B;&#x8F7D;&#x955C;&#x50CF;&#x901F;&#x5EA6;&#x592A;&#x6162;&#xFF0C;&#x662F;&#x4E0D;&#x662F;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x4EC0;&#x4E48;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF1F;"></a>&#x88C5;&#x5B8C; Docker Toolbox &#x540E;&#x53D1;&#x73B0;&#x4E0B;&#x8F7D;&#x955C;&#x50CF;&#x901F;&#x5EA6;&#x592A;&#x6162;&#xFF0C;&#x662F;&#x4E0D;&#x662F;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x4EC0;&#x4E48;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF1F; <a href="#zhuang-wan-docker-toolbox-hou-fa-xian-xia-zai-jing-xiang-su-du-tai-man-shi-bu-shi-xu-yao-xiu-gai-shi-me-pei-zhi-wen-jian" class="header-anchor">#</a></h2><p>&#x5B89;&#x88C5; Docker Toolbox &#x65F6;&#xFF0C;&#x5B89;&#x88C5;&#x7A0B;&#x5E8F;&#x4F1A;&#x4F7F;&#x7528; <code>docker-machine</code> &#x4E3A;&#x4F60;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x9ED8;&#x8BA4;&#x7684;&#x865A;&#x62DF;&#x673A;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker-machine create <span class="_">-d</span> virtualbox default</div></pre></td></tr></table></figure>
<p>&#x8FD9;&#x4E2A;&#x865A;&#x62DF;&#x673A;&#x6CA1;&#x6709;&#x52A0;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#xFF0C;&#x56E0;&#x6B64;&#x5BF9;&#x4E8E;&#x62E5;&#x6709;&#x4F1F;&#x5927;&#x7684;&#x5899;&#x7684;&#x56FD;&#x5185;&#x7F51;&#x7EDC;&#x6765;&#x8BF4;&#xFF0C;&#x6709;&#x4E9B;&#x4E0D;&#x65B9;&#x4FBF;&#x4F7F;&#x7528;&#x3002;&#x6240;&#x4EE5;&#x6700;&#x7B80;&#x5355;&#x7684;&#x505A;&#x6CD5;&#x662F;&#x5728;&#x5B89;&#x88C5;&#x5B8C; Docker Toolbox &#x540E;&#xFF0C;&#x5220;&#x6389;&#x9ED8;&#x8BA4;&#x7684;&#x865A;&#x62DF;&#x673A;&#xFF0C;&#x7136;&#x540E;&#x91CD;&#x65B0;&#x521B;&#x5EFA;&#x8BE5;&#x865A;&#x62DF;&#x673A;&#xFF0C;&#x521B;&#x5EFA;&#x65F6;&#x52A0;&#x5165;&#x6709;&#x4E2D;&#x56FD;&#x7279;&#x8272;&#x7684;&#x914D;&#x7F6E;&#x3002;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">docker-machine rm default</div><div class="line"></div><div class="line">docker-machine create <span class="_">-d</span> virtualbox \</div><div class="line">     --engine-registry-mirror https://jxus37ac.mirror.aliyuncs.com \</div><div class="line">     --engine-insecure-registry 192.168.99.0/24 \</div><div class="line">     --engine-storage-driver overlay2 \</div><div class="line">     default</div></pre></td></tr></table></figure>
<blockquote>
<p>&#x5220;&#x9664; <code>default</code> &#x865A;&#x62DF;&#x673A;&#x7684;&#x65F6;&#x5019;&#x8981;&#x6CE8;&#x610F;&#xFF0C;&#x5176;&#x4E2D;&#x955C;&#x50CF;&#x3001;&#x5BB9;&#x5668;&#x7B49;&#x5185;&#x5BB9;&#x90FD;&#x4F1A;&#x88AB;&#x5220;&#x9664;&#x3002;</p>
</blockquote>
<h1 id="qi-ta-wen-ti"><a href="#&#x5176;&#x5B83;&#x95EE;&#x9898;" class="headerlink" title="&#x5176;&#x5B83;&#x95EE;&#x9898;"></a>&#x5176;&#x5B83;&#x95EE;&#x9898; <a href="#qi-ta-wen-ti" class="header-anchor">#</a></h1><h2 id="docker-zi-liao-hao-shao-a-wang-shang-de-ming-ling-zen-me-bu-neng-yong"><a href="#Docker-&#x8D44;&#x6599;&#x597D;&#x5C11;&#x554A;&#xFF1F;&#x7F51;&#x4E0A;&#x7684;&#x547D;&#x4EE4;&#x600E;&#x4E48;&#x4E0D;&#x80FD;&#x7528;&#xFF1F;" class="headerlink" title="Docker &#x8D44;&#x6599;&#x597D;&#x5C11;&#x554A;&#xFF1F;&#x7F51;&#x4E0A;&#x7684;&#x547D;&#x4EE4;&#x600E;&#x4E48;&#x4E0D;&#x80FD;&#x7528;&#xFF1F;"></a>Docker &#x8D44;&#x6599;&#x597D;&#x5C11;&#x554A;&#xFF1F;&#x7F51;&#x4E0A;&#x7684;&#x547D;&#x4EE4;&#x600E;&#x4E48;&#x4E0D;&#x80FD;&#x7528;&#xFF1F; <a href="#docker-zi-liao-hao-shao-a-wang-shang-de-ming-ling-zen-me-bu-neng-yong" class="header-anchor">#</a></h2><p>&#x9996;&#x5148;&#xFF0C;&#x505A;&#x6280;&#x672F;&#x5DE5;&#x4F5C;&#xFF0C;&#x8BF7;&#x73CD;&#x60DC;&#x751F;&#x547D;&#xFF0C;&#x8FDC;&#x79BB;&#x767E;&#x5EA6;&#xFF1B;<br>&#x5176;&#x6B21;&#xFF0C;&#x4E0D;&#x7FFB;&#x5899;&#x3001;&#x4E0D;&#x7528;Google&#x3001;&#x4E0D;&#x770B;&#x82F1;&#x6587;&#x8D44;&#x6599;&#xFF0C;&#x90A3;&#x8BF7;&#x8F6C;&#x884C;&#xFF0C;&#x6CA1;&#x6CD5;&#x6DF7;&#x3002;</p>
<p>&#x7136;&#x540E;&#x662F;&#x56DE;&#x7B54;&#x95EE;&#x9898;&#xFF0C;Docker&#x7684;&#x8D44;&#x6599;&#x5176;&#x5B9E;&#x5F88;&#x4E30;&#x5BCC;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x5B98;&#x65B9;&#x6587;&#x6863;&#x8BB2;&#x89E3;&#x975E;&#x5E38;&#x8BE6;&#x7EC6;&#x3002;</p>
<p><a href="https://docs.docker.com/" target="_blank" rel="external">https://docs.docker.com/</a></p>
<p>&#x53E6;&#x5916;&#xFF0C;Docker&#x6709;&#x4E30;&#x5BCC;&#x7684;&#x955C;&#x50CF;&#x5E93;&#xFF0C;Docker Hub&#xFF0C;&#x7279;&#x522B;&#x662F;&#x5B98;&#x65B9;(Official)&#x7684;&#x955C;&#x50CF;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5728;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x4E2D;&#x4F7F;&#x7528;&#xFF0C;&#x5236;&#x4F5C;&#x6BD4;&#x8F83;&#x7CBE;&#x826F;&#x3002;</p>
<p><a href="https://hub.docker.com/explore/" target="_blank" rel="external">https://hub.docker.com/explore/</a></p>
<p>&#x6240;&#x6709;&#x7684;&#x5B98;&#x65B9;&#x955C;&#x50CF;&#x90FD;&#x6709; <code>Dockerfile</code>&#xFF0C;&#x4EE5;&#x53CA;&#x5728;github&#x4E0A;&#x6709;&#x5168;&#x90E8;&#x751F;&#x6210;&#x955C;&#x50CF;&#x7684;&#x914D;&#x5957;&#x6587;&#x4EF6;&#xFF0C;&#x9075;&#x5FAA;&#x4E86;<code>Dockerfile</code>&#x7684;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#xFF0C;&#x8FD9;&#x4E9B;&#x4E5F;&#x662F;&#x5F88;&#x597D;&#x5730;&#x5B66;&#x4E60;&#x8D44;&#x6599;&#x3002;</p>
<p>&#x53E6;&#x5916;&#xFF0C;&#x5728; YouTube &#x7684; Docker &#x5B98;&#x65B9;&#x9891;&#x9053;&#x4E0B;&#x6709;&#x51E0;&#x767E;&#x4E2A;&#x89C6;&#x9891;&#x8BB2;&#x5EA7;&#xFF0C;&#x4ECE;&#x521D;&#x7EA7;&#x5230;&#x9AD8;&#x7EA7;&#x7528;&#x6237;&#x90FD;&#x80FD;&#x4ECE;&#x91CC;&#x9762;&#x5B66;&#x5230;&#x5F88;&#x591A;&#x4E1C;&#x897F;&#x3002;</p>
<p><a href="https://www.youtube.com/user/dockerrun" target="_blank" rel="external">https://www.youtube.com/user/dockerrun</a></p>
<h2 id="docker-1-8-yi-hou-ban-ben-du-you-shi-me-gai-jin-me"><a href="#Docker-1-8&#x4EE5;&#x540E;&#x7248;&#x672C;&#x90FD;&#x6709;&#x4EC0;&#x4E48;&#x6539;&#x8FDB;&#x4E48;&#xFF1F;" class="headerlink" title="Docker 1.8&#x4EE5;&#x540E;&#x7248;&#x672C;&#x90FD;&#x6709;&#x4EC0;&#x4E48;&#x6539;&#x8FDB;&#x4E48;&#xFF1F;"></a>Docker 1.8&#x4EE5;&#x540E;&#x7248;&#x672C;&#x90FD;&#x6709;&#x4EC0;&#x4E48;&#x6539;&#x8FDB;&#x4E48;&#xFF1F; <a href="#docker-1-8-yi-hou-ban-ben-du-you-shi-me-gai-jin-me" class="header-anchor">#</a></h2><p>&#x6BCF;&#x4E2A;&#x7248;&#x672C;&#x53D1;&#x5E03;&#x65F6;&#xFF0C;&#x5B98;&#x65B9;&#x535A;&#x5BA2; <a href="https://blog.docker.com" target="_blank" rel="external">https://blog.docker.com</a> &#x90FD;&#x4F1A;&#x6709;&#x4E13;&#x95E8;&#x6587;&#x7AE0;&#x63CF;&#x8FF0;&#x8FD9;&#x4E2A;&#x7248;&#x672C;&#x6700;&#x4E3B;&#x8981;&#x7684;&#x6539;&#x8FDB;&#x3002;</p>
<ul>
<li><a href="https://blog.docker.com/2015/11/docker-1-9-production-ready-swarm-multi-host-networking/" target="_blank" rel="external">https://blog.docker.com/2015/11/docker-1-9-production-ready-swarm-multi-host-networking/</a></li>
<li><a href="https://blog.docker.com/2016/02/docker-1-10/" target="_blank" rel="external">https://blog.docker.com/2016/02/docker-1-10/</a></li>
<li><a href="https://blog.docker.com/2016/04/docker-engine-1-11-runc/" target="_blank" rel="external">https://blog.docker.com/2016/04/docker-engine-1-11-runc/</a></li>
<li><a href="https://blog.docker.com/2016/06/docker-1-12-built-in-orchestration/" target="_blank" rel="external">https://blog.docker.com/2016/06/docker-1-12-built-in-orchestration/</a></li>
</ul>
<h2 id="kubernetes-zhe-ci-zha-nian-a"><a href="#Kubernetes-&#x8FD9;&#x8BCD;&#x548B;&#x5FF5;&#x554A;&#xFF1F;" class="headerlink" title="Kubernetes &#x8FD9;&#x8BCD;&#x548B;&#x5FF5;&#x554A;&#xFF1F;"></a>Kubernetes &#x8FD9;&#x8BCD;&#x548B;&#x5FF5;&#x554A;&#xFF1F; <a href="#kubernetes-zhe-ci-zha-nian-a" class="header-anchor">#</a></h2><p>Kubernetes &#x7684;&#x53D1;&#x97F3;&#xFF1A;<code>koo-ber-nay&apos;-tace</code> &#xFF0C;&#x8FD9;&#x8BCD;&#x6765;&#x81EA;&#x5E0C;&#x814A;<code>&#x8235;&#x624B;</code>&#x8FD9;&#x4E2A;&#x8BCD;&#x3002;<br>&#x4F46;&#x662F;&#x7ECF;&#x5E38;&#x6709;&#x4EBA;&#x5FF5;&#x6210;&#xFF1A;<code>koo-ber-net-ees</code>&#xFF0C;&#x6216;&#x8005;<code>k8s</code>&#xFF0C;<code>k-eights</code>&#x3002;</p>
<p><a href="http://www.biblestudytools.com/lexicons/greek/nas/kubernetes.html" target="_blank" rel="external">http://www.biblestudytools.com/lexicons/greek/nas/kubernetes.html</a></p>
<h2 id="wen-yi-ju-kubernetes-wei-sha-jiao-k8s"><a href="#&#x95EE;&#x4E00;&#x53E5;-Kubernetes-&#x4E3A;&#x5565;&#x53EB;-&#x201C;k8s&#x201D;&#xFF1F;" class="headerlink" title="&#x95EE;&#x4E00;&#x53E5; Kubernetes &#x4E3A;&#x5565;&#x53EB; &#x201C;k8s&#x201D;&#xFF1F;"></a>&#x95EE;&#x4E00;&#x53E5; Kubernetes &#x4E3A;&#x5565;&#x53EB; &#x201C;k8s&#x201D;&#xFF1F; <a href="#wen-yi-ju-kubernetes-wei-sha-jiao-k8s" class="header-anchor">#</a></h2><p>&#x662F;&#x56E0;&#x4E3A;&#x53D1;&#x97F3;&#x63A5;&#x8FD1;&#x4E48;&#x2026;&#x2026;&#x597D;&#x5427;&#xFF0C;&#x5B9E;&#x8BDD;&#x8BF4;&#x4E86;&#x5427;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x72AF;&#x61D2;&#xFF0C;&#x6570;&#x6570; k &#x548C; s &#x4E2D;&#x95F4;&#x591A;&#x5C11;&#x4E2A;&#x5B57;&#x6BCD;&#xFF1F;8&#x4E2A;&#x5427;&#xFF0C;&#x8FD9;&#x4E2A;8 &#x7684;&#x610F;&#x601D;&#x5C31;&#x662F;&#x7701;&#x7565;8&#x4E2A;&#x5B57;&#x6BCD;&#xFF0C;&#x61D2;&#x5F97;&#x6572;&#x4E86;&#x2026;&#x2026; &#x5176;&#x5B9E;&#x8FD9;&#x7C7B;&#x7528;&#x6CD5;&#x5F88;&#x591A;&#xFF0C;&#x6BD4;&#x5982; i18n (internationalization), l11n (localization) &#x7B49;&#x7B49;&#xFF0C;&#x8001;&#x5916;&#x4E5F;&#x61D2;&#x5F97;&#x6253;&#x5B57;&#x554A;&#x3002;</p>
<h2 id="wo-de-pei-zhi-wen-jian-chuan-qun-wen-jian-liao-bang-mang-kan-kan-zhe-shi-wo-de-pei-zhi-sheng-lue-ji-qian-zi"><a href="#&#x6211;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4F20;&#x7FA4;&#x6587;&#x4EF6;&#x4E86;&#xFF0C;&#x5E2E;&#x5FD9;&#x770B;&#x770B;&#xFF1F;&#x8FD9;&#x662F;&#x6211;&#x7684;&#x914D;&#x7F6E;&#x2026;-&#x7701;&#x7565;&#x51E0;&#x5343;&#x5B57;" class="headerlink" title="&#x6211;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4F20;&#x7FA4;&#x6587;&#x4EF6;&#x4E86;&#xFF0C;&#x5E2E;&#x5FD9;&#x770B;&#x770B;&#xFF1F;&#x8FD9;&#x662F;&#x6211;&#x7684;&#x914D;&#x7F6E;&#x2026;(&#x7701;&#x7565;&#x51E0;&#x5343;&#x5B57;)"></a>&#x6211;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4F20;&#x7FA4;&#x6587;&#x4EF6;&#x4E86;&#xFF0C;&#x5E2E;&#x5FD9;&#x770B;&#x770B;&#xFF1F;&#x8FD9;&#x662F;&#x6211;&#x7684;&#x914D;&#x7F6E;&#x2026;(&#x7701;&#x7565;&#x51E0;&#x5343;&#x5B57;) <a href="#wo-de-pei-zhi-wen-jian-chuan-qun-wen-jian-liao-bang-mang-kan-kan-zhe-shi-wo-de-pei-zhi-sheng-lue-ji-qian-zi" class="header-anchor">#</a></h2><p>&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x8FD9;&#x7C7B;&#x6587;&#x672C;&#x4E1C;&#x897F;&#xFF0C;&#x5E94;&#x8BE5;&#x7528;&#x8FD9;&#x7C7B;&#x526A;&#x8D34;&#x677F;&#x7F51;&#x7AD9;&#xFF0C;&#x4E0D;&#x8981;&#x4F7F;&#x7528;&#x7FA4;&#x6587;&#x4EF6;&#x6216;&#x8005;&#x76F4;&#x63A5;&#x5927;&#x6BB5;&#x5237;&#x5C4F;&#xFF0C;&#x683C;&#x5F0F;&#x6DF7;&#x4E71;&#x800C;&#x4E14;&#x6CA1;&#x6709;&#x8BED;&#x6CD5;&#x9AD8;&#x4EAE;&#xFF1A;</p>
<ul>
<li><a href="http://pastebin.com/" target="_blank" rel="external">http://pastebin.com/</a></li>
<li><a href="http://paste.ubuntu.com/" target="_blank" rel="external">http://paste.ubuntu.com/</a></li>
</ul>
</div></article><div class="pagination"><a href="/post/docker-2016-07-21-video-green-font-black-background-docker-security-by-example.html" class="pagination-prev">PREV</a><a href="/post/docker-2016-07-12-video-moby-cool-hack-session-dockercon.html" class="pagination-next">NEXT</a></div><div class="comments"><div data-thread-key="post/docker-2016-07-14-faq.html" data-title="Docker 问答录" data-url="http://blog.lab99.org/post/docker-2016-07-14-faq.html" class="ds-thread"></div></div></div><aside class="sidebar"><h3>分类标签</h3><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sonatype/">Sonatype</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/coreos/">coreos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker-summit/">docker summit</a></li></ul><h3>最新文章</h3><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/post/docker-2016-12-07-video-persistent-storage-tailored-for-containers.html">视频笔记：为容器定制的持久化存储方案 - Infinit - Quentin Hocquet</a></li><li class="post-list-item"><a class="post-list-link" href="/post/docker-2016-11-14-what-is-new-in-docker-1-13.html">Docker 1.13 新增功能</a></li><li class="post-list-item"><a class="post-list-link" href="/post/docker-2016-08-12-video-windows-server-and-docker.html">视频笔记： Windows Server 和 Docker - John Starks</a></li><li class="post-list-item"><a class="post-list-link" href="/post/docker-2016-08-08-video-docker-ops-docker-networking-deep-dive-considerations-and-troubleshooting.html">视频笔记：Docker 运维 - Docker Networking 进阶指南 - Madhu Venugopal</a></li><li class="post-list-item"><a class="post-list-link" href="/post/docker-2016-07-26-video-docker-for-ops-docker-storage-and-volumes-deep-dive-and-considerations.html">视频笔记：Docker 运维 - Docker Storage 和 Volumes 进阶指南 - Brian Goff</a></li><li class="post-list-item"><a class="post-list-link" href="/post/docker-2016-07-21-video-green-font-black-background-docker-security-by-example.html">视频笔记：绿字黑屏 - Docker 安全示例 - Diogo Mónica</a></li><li class="post-list-item"><a class="post-list-link" href="/post/docker-2016-07-14-faq.html">Docker 问答录</a></li><li class="post-list-item"><a class="post-list-link" href="/post/docker-2016-07-12-video-moby-cool-hack-session-dockercon.html">视频笔记：Moby 的 Cool Hack session</a></li></ul></aside></section></div><div class="extra"></div><footer class="footer"><div class="row-flex-row limit-width vh-center"><div class="copyright"><P>© 2016 <a href="/">王涛</P></div><div class="power"><p><a href="http://pinggod.com/">Sean Sun</a>, 
<a href="https://hexo.io">Hexo</a>, 
<a href="https://github.com/">GitHub</a>, 
<a href="https://jekyllrb.com/">Jekyll</a></p></div></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-80785538-1",'auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "//hm.baidu.com/hm.js?ee75cf08ad330aa99f8540efa2570970";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>var duoshuoQuery = {short_name:"twang2218-coding"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script></body></html>